(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Qu(t,e){const n=Object.create(null),r=t.split(",");for(let i=0;i<r.length;i++)n[r[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}const De={},Si=[],Xt=()=>{},QI=()=>!1,YI=/^on[^a-z]/,lc=t=>YI.test(t),Yu=t=>t.startsWith("onUpdate:"),He=Object.assign,Xu=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},XI=Object.prototype.hasOwnProperty,ue=(t,e)=>XI.call(t,e),X=Array.isArray,Ri=t=>wo(t)==="[object Map]",uc=t=>wo(t)==="[object Set]",rf=t=>wo(t)==="[object Date]",ie=t=>typeof t=="function",We=t=>typeof t=="string",js=t=>typeof t=="symbol",Se=t=>t!==null&&typeof t=="object",qm=t=>Se(t)&&ie(t.then)&&ie(t.catch),Gm=Object.prototype.toString,wo=t=>Gm.call(t),JI=t=>wo(t).slice(8,-1),jm=t=>wo(t)==="[object Object]",Ju=t=>We(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,_a=Qu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),hc=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},ZI=/-(\w)/g,mn=hc(t=>t.replace(ZI,(e,n)=>n?n.toUpperCase():"")),eE=/\B([A-Z])/g,es=hc(t=>t.replace(eE,"-$1").toLowerCase()),dc=hc(t=>t.charAt(0).toUpperCase()+t.slice(1)),hl=hc(t=>t?`on${dc(t)}`:""),Ks=(t,e)=>!Object.is(t,e),ya=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Ca=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},Da=t=>{const e=parseFloat(t);return isNaN(e)?t:e},tE=t=>{const e=We(t)?Number(t):NaN;return isNaN(e)?t:e};let sf;const $l=()=>sf||(sf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Zu(t){if(X(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],i=We(r)?sE(r):Zu(r);if(i)for(const s in i)e[s]=i[s]}return e}else{if(We(t))return t;if(Se(t))return t}}const nE=/;(?![^(]*\))/g,rE=/:([^]+)/,iE=/\/\*[^]*?\*\//g;function sE(t){const e={};return t.replace(iE,"").split(nE).forEach(n=>{if(n){const r=n.split(rE);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Ao(t){let e="";if(We(t))e=t;else if(X(t))for(let n=0;n<t.length;n++){const r=Ao(t[n]);r&&(e+=r+" ")}else if(Se(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const oE="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",aE=Qu(oE);function Km(t){return!!t||t===""}function cE(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=fc(t[r],e[r]);return n}function fc(t,e){if(t===e)return!0;let n=rf(t),r=rf(e);if(n||r)return n&&r?t.getTime()===e.getTime():!1;if(n=js(t),r=js(e),n||r)return t===e;if(n=X(t),r=X(e),n||r)return n&&r?cE(t,e):!1;if(n=Se(t),r=Se(e),n||r){if(!n||!r)return!1;const i=Object.keys(t).length,s=Object.keys(e).length;if(i!==s)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!fc(t[o],e[o]))return!1}}return String(t)===String(e)}function lE(t,e){return t.findIndex(n=>fc(n,e))}const Pe=t=>We(t)?t:t==null?"":X(t)||Se(t)&&(t.toString===Gm||!ie(t.toString))?JSON.stringify(t,zm,2):String(t),zm=(t,e)=>e&&e.__v_isRef?zm(t,e.value):Ri(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,i])=>(n[`${r} =>`]=i,n),{})}:uc(e)?{[`Set(${e.size})`]:[...e.values()]}:Se(e)&&!X(e)&&!jm(e)?String(e):e;let Ht;class Hm{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ht,!e&&Ht&&(this.index=(Ht.scopes||(Ht.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=Ht;try{return Ht=this,e()}finally{Ht=n}}}on(){Ht=this}off(){Ht=this.parent}stop(e){if(this._active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function uE(t){return new Hm(t)}function hE(t,e=Ht){e&&e.active&&e.effects.push(t)}function dE(){return Ht}const eh=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Wm=t=>(t.w&Zn)>0,Qm=t=>(t.n&Zn)>0,fE=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Zn},pE=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const i=e[r];Wm(i)&&!Qm(i)?i.delete(t):e[n++]=i,i.w&=~Zn,i.n&=~Zn}e.length=n}},ql=new WeakMap;let Ss=0,Zn=1;const Gl=30;let Wt;const $r=Symbol(""),jl=Symbol("");class th{constructor(e,n=null,r){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,hE(this,r)}run(){if(!this.active)return this.fn();let e=Wt,n=Wn;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Wt,Wt=this,Wn=!0,Zn=1<<++Ss,Ss<=Gl?fE(this):of(this),this.fn()}finally{Ss<=Gl&&pE(this),Zn=1<<--Ss,Wt=this.parent,Wn=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Wt===this?this.deferStop=!0:this.active&&(of(this),this.onStop&&this.onStop(),this.active=!1)}}function of(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Wn=!0;const Ym=[];function ts(){Ym.push(Wn),Wn=!1}function ns(){const t=Ym.pop();Wn=t===void 0?!0:t}function Nt(t,e,n){if(Wn&&Wt){let r=ql.get(t);r||ql.set(t,r=new Map);let i=r.get(n);i||r.set(n,i=eh()),Xm(i)}}function Xm(t,e){let n=!1;Ss<=Gl?Qm(t)||(t.n|=Zn,n=!Wm(t)):n=!t.has(Wt),n&&(t.add(Wt),Wt.deps.push(t))}function Sn(t,e,n,r,i,s){const o=ql.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&X(t)){const c=Number(r);o.forEach((l,u)=>{(u==="length"||u>=c)&&a.push(l)})}else switch(n!==void 0&&a.push(o.get(n)),e){case"add":X(t)?Ju(n)&&a.push(o.get("length")):(a.push(o.get($r)),Ri(t)&&a.push(o.get(jl)));break;case"delete":X(t)||(a.push(o.get($r)),Ri(t)&&a.push(o.get(jl)));break;case"set":Ri(t)&&a.push(o.get($r));break}if(a.length===1)a[0]&&Kl(a[0]);else{const c=[];for(const l of a)l&&c.push(...l);Kl(eh(c))}}function Kl(t,e){const n=X(t)?t:[...t];for(const r of n)r.computed&&af(r);for(const r of n)r.computed||af(r)}function af(t,e){(t!==Wt||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const mE=Qu("__proto__,__v_isRef,__isVue"),Jm=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(js)),gE=nh(),_E=nh(!1,!0),yE=nh(!0),cf=vE();function vE(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=fe(this);for(let s=0,o=this.length;s<o;s++)Nt(r,"get",s+"");const i=r[e](...n);return i===-1||i===!1?r[e](...n.map(fe)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){ts();const r=fe(this)[e].apply(this,n);return ns(),r}}),t}function IE(t){const e=fe(this);return Nt(e,"has",t),e.hasOwnProperty(t)}function nh(t=!1,e=!1){return function(r,i,s){if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&s===(t?e?ME:rg:e?ng:tg).get(r))return r;const o=X(r);if(!t){if(o&&ue(cf,i))return Reflect.get(cf,i,s);if(i==="hasOwnProperty")return IE}const a=Reflect.get(r,i,s);return(js(i)?Jm.has(i):mE(i))||(t||Nt(r,"get",i),e)?a:_t(a)?o&&Ju(i)?a:a.value:Se(a)?t?sg(a):bo(a):a}}const EE=Zm(),TE=Zm(!0);function Zm(t=!1){return function(n,r,i,s){let o=n[r];if(Mi(o)&&_t(o)&&!_t(i))return!1;if(!t&&(!xa(i)&&!Mi(i)&&(o=fe(o),i=fe(i)),!X(n)&&_t(o)&&!_t(i)))return o.value=i,!0;const a=X(n)&&Ju(r)?Number(r)<n.length:ue(n,r),c=Reflect.set(n,r,i,s);return n===fe(s)&&(a?Ks(i,o)&&Sn(n,"set",r,i):Sn(n,"add",r,i)),c}}function wE(t,e){const n=ue(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&Sn(t,"delete",e,void 0),r}function AE(t,e){const n=Reflect.has(t,e);return(!js(e)||!Jm.has(e))&&Nt(t,"has",e),n}function bE(t){return Nt(t,"iterate",X(t)?"length":$r),Reflect.ownKeys(t)}const eg={get:gE,set:EE,deleteProperty:wE,has:AE,ownKeys:bE},SE={get:yE,set(t,e){return!0},deleteProperty(t,e){return!0}},RE=He({},eg,{get:_E,set:TE}),rh=t=>t,pc=t=>Reflect.getPrototypeOf(t);function Jo(t,e,n=!1,r=!1){t=t.__v_raw;const i=fe(t),s=fe(e);n||(e!==s&&Nt(i,"get",e),Nt(i,"get",s));const{has:o}=pc(i),a=r?rh:n?oh:zs;if(o.call(i,e))return a(t.get(e));if(o.call(i,s))return a(t.get(s));t!==i&&t.get(e)}function Zo(t,e=!1){const n=this.__v_raw,r=fe(n),i=fe(t);return e||(t!==i&&Nt(r,"has",t),Nt(r,"has",i)),t===i?n.has(t):n.has(t)||n.has(i)}function ea(t,e=!1){return t=t.__v_raw,!e&&Nt(fe(t),"iterate",$r),Reflect.get(t,"size",t)}function lf(t){t=fe(t);const e=fe(this);return pc(e).has.call(e,t)||(e.add(t),Sn(e,"add",t,t)),this}function uf(t,e){e=fe(e);const n=fe(this),{has:r,get:i}=pc(n);let s=r.call(n,t);s||(t=fe(t),s=r.call(n,t));const o=i.call(n,t);return n.set(t,e),s?Ks(e,o)&&Sn(n,"set",t,e):Sn(n,"add",t,e),this}function hf(t){const e=fe(this),{has:n,get:r}=pc(e);let i=n.call(e,t);i||(t=fe(t),i=n.call(e,t)),r&&r.call(e,t);const s=e.delete(t);return i&&Sn(e,"delete",t,void 0),s}function df(){const t=fe(this),e=t.size!==0,n=t.clear();return e&&Sn(t,"clear",void 0,void 0),n}function ta(t,e){return function(r,i){const s=this,o=s.__v_raw,a=fe(o),c=e?rh:t?oh:zs;return!t&&Nt(a,"iterate",$r),o.forEach((l,u)=>r.call(i,c(l),c(u),s))}}function na(t,e,n){return function(...r){const i=this.__v_raw,s=fe(i),o=Ri(s),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=i[t](...r),u=n?rh:e?oh:zs;return!e&&Nt(s,"iterate",c?jl:$r),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function kn(t){return function(...e){return t==="delete"?!1:this}}function PE(){const t={get(s){return Jo(this,s)},get size(){return ea(this)},has:Zo,add:lf,set:uf,delete:hf,clear:df,forEach:ta(!1,!1)},e={get(s){return Jo(this,s,!1,!0)},get size(){return ea(this)},has:Zo,add:lf,set:uf,delete:hf,clear:df,forEach:ta(!1,!0)},n={get(s){return Jo(this,s,!0)},get size(){return ea(this,!0)},has(s){return Zo.call(this,s,!0)},add:kn("add"),set:kn("set"),delete:kn("delete"),clear:kn("clear"),forEach:ta(!0,!1)},r={get(s){return Jo(this,s,!0,!0)},get size(){return ea(this,!0)},has(s){return Zo.call(this,s,!0)},add:kn("add"),set:kn("set"),delete:kn("delete"),clear:kn("clear"),forEach:ta(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=na(s,!1,!1),n[s]=na(s,!0,!1),e[s]=na(s,!1,!0),r[s]=na(s,!0,!0)}),[t,n,e,r]}const[CE,DE,xE,VE]=PE();function ih(t,e){const n=e?t?VE:xE:t?DE:CE;return(r,i,s)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?r:Reflect.get(ue(n,i)&&i in r?n:r,i,s)}const NE={get:ih(!1,!1)},OE={get:ih(!1,!0)},kE={get:ih(!0,!1)},tg=new WeakMap,ng=new WeakMap,rg=new WeakMap,ME=new WeakMap;function FE(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function LE(t){return t.__v_skip||!Object.isExtensible(t)?0:FE(JI(t))}function bo(t){return Mi(t)?t:sh(t,!1,eg,NE,tg)}function ig(t){return sh(t,!1,RE,OE,ng)}function sg(t){return sh(t,!0,SE,kE,rg)}function sh(t,e,n,r,i){if(!Se(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=i.get(t);if(s)return s;const o=LE(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return i.set(t,a),a}function Pi(t){return Mi(t)?Pi(t.__v_raw):!!(t&&t.__v_isReactive)}function Mi(t){return!!(t&&t.__v_isReadonly)}function xa(t){return!!(t&&t.__v_isShallow)}function og(t){return Pi(t)||Mi(t)}function fe(t){const e=t&&t.__v_raw;return e?fe(e):t}function ag(t){return Ca(t,"__v_skip",!0),t}const zs=t=>Se(t)?bo(t):t,oh=t=>Se(t)?sg(t):t;function cg(t){Wn&&Wt&&(t=fe(t),Xm(t.dep||(t.dep=eh())))}function lg(t,e){t=fe(t);const n=t.dep;n&&Kl(n)}function _t(t){return!!(t&&t.__v_isRef===!0)}function BE(t){return ug(t,!1)}function UE(t){return ug(t,!0)}function ug(t,e){return _t(t)?t:new $E(t,e)}class $E{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:fe(e),this._value=n?e:zs(e)}get value(){return cg(this),this._value}set value(e){const n=this.__v_isShallow||xa(e)||Mi(e);e=n?e:fe(e),Ks(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:zs(e),lg(this))}}function Ci(t){return _t(t)?t.value:t}const qE={get:(t,e,n)=>Ci(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const i=t[e];return _t(i)&&!_t(n)?(i.value=n,!0):Reflect.set(t,e,n,r)}};function hg(t){return Pi(t)?t:new Proxy(t,qE)}class GE{constructor(e,n,r,i){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new th(e,()=>{this._dirty||(this._dirty=!0,lg(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const e=fe(this);return cg(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function jE(t,e,n=!1){let r,i;const s=ie(t);return s?(r=t,i=Xt):(r=t.get,i=t.set),new GE(r,i,s||!i,n)}function Qn(t,e,n,r){let i;try{i=r?t(...r):t()}catch(s){mc(s,e,n)}return i}function Kt(t,e,n,r){if(ie(t)){const s=Qn(t,e,n,r);return s&&qm(s)&&s.catch(o=>{mc(o,e,n)}),s}const i=[];for(let s=0;s<t.length;s++)i.push(Kt(t[s],e,n,r));return i}function mc(t,e,n,r=!0){const i=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=n;for(;s;){const l=s.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,o,a)===!1)return}s=s.parent}const c=e.appContext.config.errorHandler;if(c){Qn(c,null,10,[t,o,a]);return}}KE(t,n,i,r)}function KE(t,e,n,r=!0){console.error(t)}let Hs=!1,zl=!1;const gt=[];let cn=0;const Di=[];let En=null,Sr=0;const dg=Promise.resolve();let ah=null;function fg(t){const e=ah||dg;return t?e.then(this?t.bind(this):t):e}function zE(t){let e=cn+1,n=gt.length;for(;e<n;){const r=e+n>>>1;Ws(gt[r])<t?e=r+1:n=r}return e}function ch(t){(!gt.length||!gt.includes(t,Hs&&t.allowRecurse?cn+1:cn))&&(t.id==null?gt.push(t):gt.splice(zE(t.id),0,t),pg())}function pg(){!Hs&&!zl&&(zl=!0,ah=dg.then(gg))}function HE(t){const e=gt.indexOf(t);e>cn&&gt.splice(e,1)}function WE(t){X(t)?Di.push(...t):(!En||!En.includes(t,t.allowRecurse?Sr+1:Sr))&&Di.push(t),pg()}function ff(t,e=Hs?cn+1:0){for(;e<gt.length;e++){const n=gt[e];n&&n.pre&&(gt.splice(e,1),e--,n())}}function mg(t){if(Di.length){const e=[...new Set(Di)];if(Di.length=0,En){En.push(...e);return}for(En=e,En.sort((n,r)=>Ws(n)-Ws(r)),Sr=0;Sr<En.length;Sr++)En[Sr]();En=null,Sr=0}}const Ws=t=>t.id==null?1/0:t.id,QE=(t,e)=>{const n=Ws(t)-Ws(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function gg(t){zl=!1,Hs=!0,gt.sort(QE);const e=Xt;try{for(cn=0;cn<gt.length;cn++){const n=gt[cn];n&&n.active!==!1&&Qn(n,null,14)}}finally{cn=0,gt.length=0,mg(),Hs=!1,ah=null,(gt.length||Di.length)&&gg()}}function YE(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||De;let i=n;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=r[u]||De;d&&(i=n.map(f=>We(f)?f.trim():f)),h&&(i=n.map(Da))}let a,c=r[a=hl(e)]||r[a=hl(mn(e))];!c&&s&&(c=r[a=hl(es(e))]),c&&Kt(c,t,6,i);const l=r[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Kt(l,t,6,i)}}function _g(t,e,n=!1){const r=e.emitsCache,i=r.get(t);if(i!==void 0)return i;const s=t.emits;let o={},a=!1;if(!ie(t)){const c=l=>{const u=_g(l,e,!0);u&&(a=!0,He(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!s&&!a?(Se(t)&&r.set(t,null),null):(X(s)?s.forEach(c=>o[c]=null):He(o,s),Se(t)&&r.set(t,o),o)}function gc(t,e){return!t||!lc(e)?!1:(e=e.slice(2).replace(/Once$/,""),ue(t,e[0].toLowerCase()+e.slice(1))||ue(t,es(e))||ue(t,e))}let Lt=null,_c=null;function Va(t){const e=Lt;return Lt=t,_c=t&&t.type.__scopeId||null,e}function So(t){_c=t}function Ro(){_c=null}function yc(t,e=Lt,n){if(!e||t._n)return t;const r=(...i)=>{r._d&&bf(-1);const s=Va(e);let o;try{o=t(...i)}finally{Va(s),r._d&&bf(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function dl(t){const{type:e,vnode:n,proxy:r,withProxy:i,props:s,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:d,setupState:f,ctx:v,inheritAttrs:I}=t;let T,R;const x=Va(t);try{if(n.shapeFlag&4){const V=i||r;T=an(u.call(V,V,h,s,f,d,v)),R=c}else{const V=e;T=an(V.length>1?V(s,{attrs:c,slots:a,emit:l}):V(s,null)),R=e.props?c:XE(c)}}catch(V){Os.length=0,mc(V,t,1),T=Je(Jt)}let O=T;if(R&&I!==!1){const V=Object.keys(R),{shapeFlag:W}=O;V.length&&W&7&&(o&&V.some(Yu)&&(R=JE(R,o)),O=er(O,R))}return n.dirs&&(O=er(O),O.dirs=O.dirs?O.dirs.concat(n.dirs):n.dirs),n.transition&&(O.transition=n.transition),T=O,Va(x),T}const XE=t=>{let e;for(const n in t)(n==="class"||n==="style"||lc(n))&&((e||(e={}))[n]=t[n]);return e},JE=(t,e)=>{const n={};for(const r in t)(!Yu(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function ZE(t,e,n){const{props:r,children:i,component:s}=t,{props:o,children:a,patchFlag:c}=e,l=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?pf(r,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==r[d]&&!gc(l,d))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?pf(r,o,l):!0:!!o;return!1}function pf(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==t[s]&&!gc(n,s))return!0}return!1}function eT({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const tT=t=>t.__isSuspense;function nT(t,e){e&&e.pendingBranch?X(t)?e.effects.push(...t):e.effects.push(t):WE(t)}const ra={};function xi(t,e,n){return yg(t,e,n)}function yg(t,e,{immediate:n,deep:r,flush:i,onTrack:s,onTrigger:o}=De){var a;const c=dE()===((a=nt)==null?void 0:a.scope)?nt:null;let l,u=!1,h=!1;if(_t(t)?(l=()=>t.value,u=xa(t)):Pi(t)?(l=()=>t,r=!0):X(t)?(h=!0,u=t.some(V=>Pi(V)||xa(V)),l=()=>t.map(V=>{if(_t(V))return V.value;if(Pi(V))return kr(V);if(ie(V))return Qn(V,c,2)})):ie(t)?e?l=()=>Qn(t,c,2):l=()=>{if(!(c&&c.isUnmounted))return d&&d(),Kt(t,c,3,[f])}:l=Xt,e&&r){const V=l;l=()=>kr(V())}let d,f=V=>{d=x.onStop=()=>{Qn(V,c,4)}},v;if(Xs)if(f=Xt,e?n&&Kt(e,c,3,[l(),h?[]:void 0,f]):l(),i==="sync"){const V=XT();v=V.__watcherHandles||(V.__watcherHandles=[])}else return Xt;let I=h?new Array(t.length).fill(ra):ra;const T=()=>{if(x.active)if(e){const V=x.run();(r||u||(h?V.some((W,J)=>Ks(W,I[J])):Ks(V,I)))&&(d&&d(),Kt(e,c,3,[V,I===ra?void 0:h&&I[0]===ra?[]:I,f]),I=V)}else x.run()};T.allowRecurse=!!e;let R;i==="sync"?R=T:i==="post"?R=()=>Pt(T,c&&c.suspense):(T.pre=!0,c&&(T.id=c.uid),R=()=>ch(T));const x=new th(l,R);e?n?T():I=x.run():i==="post"?Pt(x.run.bind(x),c&&c.suspense):x.run();const O=()=>{x.stop(),c&&c.scope&&Xu(c.scope.effects,x)};return v&&v.push(O),O}function rT(t,e,n){const r=this.proxy,i=We(t)?t.includes(".")?vg(r,t):()=>r[t]:t.bind(r,r);let s;ie(e)?s=e:(s=e.handler,n=e);const o=nt;Fi(this);const a=yg(i,s.bind(r),n);return o?Fi(o):qr(),a}function vg(t,e){const n=e.split(".");return()=>{let r=t;for(let i=0;i<n.length&&r;i++)r=r[n[i]];return r}}function kr(t,e){if(!Se(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),_t(t))kr(t.value,e);else if(X(t))for(let n=0;n<t.length;n++)kr(t[n],e);else if(uc(t)||Ri(t))t.forEach(n=>{kr(n,e)});else if(jm(t))for(const n in t)kr(t[n],e);return t}function Xe(t,e){const n=Lt;if(n===null)return t;const r=wc(n)||n.proxy,i=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[o,a,c,l=De]=e[s];o&&(ie(o)&&(o={mounted:o,updated:o}),o.deep&&kr(a),i.push({dir:o,instance:r,value:a,oldValue:void 0,arg:c,modifiers:l}))}return t}function vr(t,e,n,r){const i=t.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let c=a.dir[r];c&&(ts(),Kt(c,n,8,[t.el,a,t,e]),ns())}}function iT(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return bg(()=>{t.isMounted=!0}),Sg(()=>{t.isUnmounting=!0}),t}const $t=[Function,Array],Ig={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$t,onEnter:$t,onAfterEnter:$t,onEnterCancelled:$t,onBeforeLeave:$t,onLeave:$t,onAfterLeave:$t,onLeaveCancelled:$t,onBeforeAppear:$t,onAppear:$t,onAfterAppear:$t,onAppearCancelled:$t},sT={name:"BaseTransition",props:Ig,setup(t,{slots:e}){const n=GT(),r=iT();let i;return()=>{const s=e.default&&Tg(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const I of s)if(I.type!==Jt){o=I;break}}const a=fe(t),{mode:c}=a;if(r.isLeaving)return fl(o);const l=mf(o);if(!l)return fl(o);const u=Hl(l,a,r,n);Wl(l,u);const h=n.subTree,d=h&&mf(h);let f=!1;const{getTransitionKey:v}=l.type;if(v){const I=v();i===void 0?i=I:I!==i&&(i=I,f=!0)}if(d&&d.type!==Jt&&(!Rr(l,d)||f)){const I=Hl(d,a,r,n);if(Wl(d,I),c==="out-in")return r.isLeaving=!0,I.afterLeave=()=>{r.isLeaving=!1,n.update.active!==!1&&n.update()},fl(o);c==="in-out"&&l.type!==Jt&&(I.delayLeave=(T,R,x)=>{const O=Eg(r,d);O[String(d.key)]=d,T._leaveCb=()=>{R(),T._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=x})}return o}}},oT=sT;function Eg(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function Hl(t,e,n,r){const{appear:i,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:l,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:v,onBeforeAppear:I,onAppear:T,onAfterAppear:R,onAppearCancelled:x}=e,O=String(t.key),V=Eg(n,t),W=(Z,Ae)=>{Z&&Kt(Z,r,9,Ae)},J=(Z,Ae)=>{const me=Ae[1];W(Z,Ae),X(Z)?Z.every(Ye=>Ye.length<=1)&&me():Z.length<=1&&me()},pe={mode:s,persisted:o,beforeEnter(Z){let Ae=a;if(!n.isMounted)if(i)Ae=I||a;else return;Z._leaveCb&&Z._leaveCb(!0);const me=V[O];me&&Rr(t,me)&&me.el._leaveCb&&me.el._leaveCb(),W(Ae,[Z])},enter(Z){let Ae=c,me=l,Ye=u;if(!n.isMounted)if(i)Ae=T||c,me=R||l,Ye=x||u;else return;let z=!1;const ve=Z._enterCb=It=>{z||(z=!0,It?W(Ye,[Z]):W(me,[Z]),pe.delayedLeave&&pe.delayedLeave(),Z._enterCb=void 0)};Ae?J(Ae,[Z,ve]):ve()},leave(Z,Ae){const me=String(t.key);if(Z._enterCb&&Z._enterCb(!0),n.isUnmounting)return Ae();W(h,[Z]);let Ye=!1;const z=Z._leaveCb=ve=>{Ye||(Ye=!0,Ae(),ve?W(v,[Z]):W(f,[Z]),Z._leaveCb=void 0,V[me]===t&&delete V[me])};V[me]=t,d?J(d,[Z,z]):z()},clone(Z){return Hl(Z,e,n,r)}};return pe}function fl(t){if(vc(t))return t=er(t),t.children=null,t}function mf(t){return vc(t)?t.children?t.children[0]:void 0:t}function Wl(t,e){t.shapeFlag&6&&t.component?Wl(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Tg(t,e=!1,n){let r=[],i=0;for(let s=0;s<t.length;s++){let o=t[s];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:s);o.type===Ft?(o.patchFlag&128&&i++,r=r.concat(Tg(o.children,e,a))):(e||o.type!==Jt)&&r.push(a!=null?er(o,{key:a}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}function wg(t,e){return ie(t)?(()=>He({name:t.name},e,{setup:t}))():t}const va=t=>!!t.type.__asyncLoader,vc=t=>t.type.__isKeepAlive;function aT(t,e){Ag(t,"a",e)}function cT(t,e){Ag(t,"da",e)}function Ag(t,e,n=nt){const r=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(Ic(e,r,n),n){let i=n.parent;for(;i&&i.parent;)vc(i.parent.vnode)&&lT(r,e,n,i),i=i.parent}}function lT(t,e,n,r){const i=Ic(e,t,r,!0);Rg(()=>{Xu(r[e],i)},n)}function Ic(t,e,n=nt,r=!1){if(n){const i=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;ts(),Fi(n);const a=Kt(e,n,t,o);return qr(),ns(),a});return r?i.unshift(s):i.push(s),s}}const Cn=t=>(e,n=nt)=>(!Xs||t==="sp")&&Ic(t,(...r)=>e(...r),n),uT=Cn("bm"),bg=Cn("m"),hT=Cn("bu"),dT=Cn("u"),Sg=Cn("bum"),Rg=Cn("um"),fT=Cn("sp"),pT=Cn("rtg"),mT=Cn("rtc");function gT(t,e=nt){Ic("ec",t,e)}const Pg="components";function zn(t,e){return yT(Pg,t,!0,e)||t}const _T=Symbol.for("v-ndc");function yT(t,e,n=!0,r=!1){const i=Lt||nt;if(i){const s=i.type;if(t===Pg){const a=WT(s,!1);if(a&&(a===e||a===mn(e)||a===dc(mn(e))))return s}const o=gf(i[t]||s[t],e)||gf(i.appContext[t],e);return!o&&r?s:o}}function gf(t,e){return t&&(t[e]||t[mn(e)]||t[dc(mn(e))])}function lh(t,e,n,r){let i;const s=n&&n[r];if(X(t)||We(t)){i=new Array(t.length);for(let o=0,a=t.length;o<a;o++)i[o]=e(t[o],o,void 0,s&&s[o])}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,s&&s[o])}else if(Se(t))if(t[Symbol.iterator])i=Array.from(t,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(t);i=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];i[a]=e(t[l],l,a,s&&s[a])}}else i=[];return n&&(n[r]=i),i}const Ql=t=>t?Bg(t)?wc(t)||t.proxy:Ql(t.parent):null,Ns=He(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ql(t.parent),$root:t=>Ql(t.root),$emit:t=>t.emit,$options:t=>uh(t),$forceUpdate:t=>t.f||(t.f=()=>ch(t.update)),$nextTick:t=>t.n||(t.n=fg.bind(t.proxy)),$watch:t=>rT.bind(t)}),pl=(t,e)=>t!==De&&!t.__isScriptSetup&&ue(t,e),vT={get({_:t},e){const{ctx:n,setupState:r,data:i,props:s,accessCache:o,type:a,appContext:c}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return i[e];case 4:return n[e];case 3:return s[e]}else{if(pl(r,e))return o[e]=1,r[e];if(i!==De&&ue(i,e))return o[e]=2,i[e];if((l=t.propsOptions[0])&&ue(l,e))return o[e]=3,s[e];if(n!==De&&ue(n,e))return o[e]=4,n[e];Yl&&(o[e]=0)}}const u=Ns[e];let h,d;if(u)return e==="$attrs"&&Nt(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==De&&ue(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,ue(d,e))return d[e]},set({_:t},e,n){const{data:r,setupState:i,ctx:s}=t;return pl(i,e)?(i[e]=n,!0):r!==De&&ue(r,e)?(r[e]=n,!0):ue(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:i,propsOptions:s}},o){let a;return!!n[o]||t!==De&&ue(t,o)||pl(e,o)||(a=s[0])&&ue(a,o)||ue(r,o)||ue(Ns,o)||ue(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ue(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function _f(t){return X(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Yl=!0;function IT(t){const e=uh(t),n=t.proxy,r=t.ctx;Yl=!1,e.beforeCreate&&yf(e.beforeCreate,t,"bc");const{data:i,computed:s,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:v,activated:I,deactivated:T,beforeDestroy:R,beforeUnmount:x,destroyed:O,unmounted:V,render:W,renderTracked:J,renderTriggered:pe,errorCaptured:Z,serverPrefetch:Ae,expose:me,inheritAttrs:Ye,components:z,directives:ve,filters:It}=e;if(l&&ET(l,r,null),o)for(const be in o){const _e=o[be];ie(_e)&&(r[be]=_e.bind(n))}if(i){const be=i.call(n,n);Se(be)&&(t.data=bo(be))}if(Yl=!0,s)for(const be in s){const _e=s[be],vn=ie(_e)?_e.bind(n,n):ie(_e.get)?_e.get.bind(n,n):Xt,On=!ie(_e)&&ie(_e.set)?_e.set.bind(n):Xt,rn=qt({get:vn,set:On});Object.defineProperty(r,be,{enumerable:!0,configurable:!0,get:()=>rn.value,set:Rt=>rn.value=Rt})}if(a)for(const be in a)Cg(a[be],r,n,be);if(c){const be=ie(c)?c.call(n):c;Reflect.ownKeys(be).forEach(_e=>{Ia(_e,be[_e])})}u&&yf(u,t,"c");function Ue(be,_e){X(_e)?_e.forEach(vn=>be(vn.bind(n))):_e&&be(_e.bind(n))}if(Ue(uT,h),Ue(bg,d),Ue(hT,f),Ue(dT,v),Ue(aT,I),Ue(cT,T),Ue(gT,Z),Ue(mT,J),Ue(pT,pe),Ue(Sg,x),Ue(Rg,V),Ue(fT,Ae),X(me))if(me.length){const be=t.exposed||(t.exposed={});me.forEach(_e=>{Object.defineProperty(be,_e,{get:()=>n[_e],set:vn=>n[_e]=vn})})}else t.exposed||(t.exposed={});W&&t.render===Xt&&(t.render=W),Ye!=null&&(t.inheritAttrs=Ye),z&&(t.components=z),ve&&(t.directives=ve)}function ET(t,e,n=Xt){X(t)&&(t=Xl(t));for(const r in t){const i=t[r];let s;Se(i)?"default"in i?s=An(i.from||r,i.default,!0):s=An(i.from||r):s=An(i),_t(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[r]=s}}function yf(t,e,n){Kt(X(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function Cg(t,e,n,r){const i=r.includes(".")?vg(n,r):()=>n[r];if(We(t)){const s=e[t];ie(s)&&xi(i,s)}else if(ie(t))xi(i,t.bind(n));else if(Se(t))if(X(t))t.forEach(s=>Cg(s,e,n,r));else{const s=ie(t.handler)?t.handler.bind(n):e[t.handler];ie(s)&&xi(i,s,t)}}function uh(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let c;return a?c=a:!i.length&&!n&&!r?c=e:(c={},i.length&&i.forEach(l=>Na(c,l,o,!0)),Na(c,e,o)),Se(e)&&s.set(e,c),c}function Na(t,e,n,r=!1){const{mixins:i,extends:s}=e;s&&Na(t,s,n,!0),i&&i.forEach(o=>Na(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=TT[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const TT={data:vf,props:If,emits:If,methods:Rs,computed:Rs,beforeCreate:Et,created:Et,beforeMount:Et,mounted:Et,beforeUpdate:Et,updated:Et,beforeDestroy:Et,beforeUnmount:Et,destroyed:Et,unmounted:Et,activated:Et,deactivated:Et,errorCaptured:Et,serverPrefetch:Et,components:Rs,directives:Rs,watch:AT,provide:vf,inject:wT};function vf(t,e){return e?t?function(){return He(ie(t)?t.call(this,this):t,ie(e)?e.call(this,this):e)}:e:t}function wT(t,e){return Rs(Xl(t),Xl(e))}function Xl(t){if(X(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Et(t,e){return t?[...new Set([].concat(t,e))]:e}function Rs(t,e){return t?He(Object.create(null),t,e):e}function If(t,e){return t?X(t)&&X(e)?[...new Set([...t,...e])]:He(Object.create(null),_f(t),_f(e??{})):e}function AT(t,e){if(!t)return e;if(!e)return t;const n=He(Object.create(null),t);for(const r in e)n[r]=Et(t[r],e[r]);return n}function Dg(){return{app:null,config:{isNativeTag:QI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let bT=0;function ST(t,e){return function(r,i=null){ie(r)||(r=He({},r)),i!=null&&!Se(i)&&(i=null);const s=Dg(),o=new Set;let a=!1;const c=s.app={_uid:bT++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:JT,get config(){return s.config},set config(l){},use(l,...u){return o.has(l)||(l&&ie(l.install)?(o.add(l),l.install(c,...u)):ie(l)&&(o.add(l),l(c,...u))),c},mixin(l){return s.mixins.includes(l)||s.mixins.push(l),c},component(l,u){return u?(s.components[l]=u,c):s.components[l]},directive(l,u){return u?(s.directives[l]=u,c):s.directives[l]},mount(l,u,h){if(!a){const d=Je(r,i);return d.appContext=s,u&&e?e(d,l):t(d,l,h),a=!0,c._container=l,l.__vue_app__=c,wc(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(l,u){return s.provides[l]=u,c},runWithContext(l){Oa=c;try{return l()}finally{Oa=null}}};return c}}let Oa=null;function Ia(t,e){if(nt){let n=nt.provides;const r=nt.parent&&nt.parent.provides;r===n&&(n=nt.provides=Object.create(r)),n[t]=e}}function An(t,e,n=!1){const r=nt||Lt;if(r||Oa){const i=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Oa._context.provides;if(i&&t in i)return i[t];if(arguments.length>1)return n&&ie(e)?e.call(r&&r.proxy):e}}function RT(t,e,n,r=!1){const i={},s={};Ca(s,Tc,1),t.propsDefaults=Object.create(null),xg(t,e,i,s);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=r?i:ig(i):t.type.props?t.props=i:t.props=s,t.attrs=s}function PT(t,e,n,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=t,a=fe(i),[c]=t.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(gc(t.emitsOptions,d))continue;const f=e[d];if(c)if(ue(s,d))f!==s[d]&&(s[d]=f,l=!0);else{const v=mn(d);i[v]=Jl(c,a,v,f,t,!1)}else f!==s[d]&&(s[d]=f,l=!0)}}}else{xg(t,e,i,s)&&(l=!0);let u;for(const h in a)(!e||!ue(e,h)&&((u=es(h))===h||!ue(e,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(i[h]=Jl(c,a,h,void 0,t,!0)):delete i[h]);if(s!==a)for(const h in s)(!e||!ue(e,h))&&(delete s[h],l=!0)}l&&Sn(t,"set","$attrs")}function xg(t,e,n,r){const[i,s]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(_a(c))continue;const l=e[c];let u;i&&ue(i,u=mn(c))?!s||!s.includes(u)?n[u]=l:(a||(a={}))[u]=l:gc(t.emitsOptions,c)||(!(c in r)||l!==r[c])&&(r[c]=l,o=!0)}if(s){const c=fe(n),l=a||De;for(let u=0;u<s.length;u++){const h=s[u];n[h]=Jl(i,c,h,l[h],t,!ue(l,h))}}return o}function Jl(t,e,n,r,i,s){const o=t[n];if(o!=null){const a=ue(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&ie(c)){const{propsDefaults:l}=i;n in l?r=l[n]:(Fi(i),r=l[n]=c.call(null,e),qr())}else r=c}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===es(n))&&(r=!0))}return r}function Vg(t,e,n=!1){const r=e.propsCache,i=r.get(t);if(i)return i;const s=t.props,o={},a=[];let c=!1;if(!ie(t)){const u=h=>{c=!0;const[d,f]=Vg(h,e,!0);He(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!s&&!c)return Se(t)&&r.set(t,Si),Si;if(X(s))for(let u=0;u<s.length;u++){const h=mn(s[u]);Ef(h)&&(o[h]=De)}else if(s)for(const u in s){const h=mn(u);if(Ef(h)){const d=s[u],f=o[h]=X(d)||ie(d)?{type:d}:He({},d);if(f){const v=Af(Boolean,f.type),I=Af(String,f.type);f[0]=v>-1,f[1]=I<0||v<I,(v>-1||ue(f,"default"))&&a.push(h)}}}const l=[o,a];return Se(t)&&r.set(t,l),l}function Ef(t){return t[0]!=="$"}function Tf(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function wf(t,e){return Tf(t)===Tf(e)}function Af(t,e){return X(e)?e.findIndex(n=>wf(n,t)):ie(e)&&wf(e,t)?0:-1}const Ng=t=>t[0]==="_"||t==="$stable",hh=t=>X(t)?t.map(an):[an(t)],CT=(t,e,n)=>{if(e._n)return e;const r=yc((...i)=>hh(e(...i)),n);return r._c=!1,r},Og=(t,e,n)=>{const r=t._ctx;for(const i in t){if(Ng(i))continue;const s=t[i];if(ie(s))e[i]=CT(i,s,r);else if(s!=null){const o=hh(s);e[i]=()=>o}}},kg=(t,e)=>{const n=hh(e);t.slots.default=()=>n},DT=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=fe(e),Ca(e,"_",n)):Og(e,t.slots={})}else t.slots={},e&&kg(t,e);Ca(t.slots,Tc,1)},xT=(t,e,n)=>{const{vnode:r,slots:i}=t;let s=!0,o=De;if(r.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:(He(i,e),!n&&a===1&&delete i._):(s=!e.$stable,Og(e,i)),o=e}else e&&(kg(t,e),o={default:1});if(s)for(const a in i)!Ng(a)&&!(a in o)&&delete i[a]};function Zl(t,e,n,r,i=!1){if(X(t)){t.forEach((d,f)=>Zl(d,e&&(X(e)?e[f]:e),n,r,i));return}if(va(r)&&!i)return;const s=r.shapeFlag&4?wc(r.component)||r.component.proxy:r.el,o=i?null:s,{i:a,r:c}=t,l=e&&e.r,u=a.refs===De?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(We(l)?(u[l]=null,ue(h,l)&&(h[l]=null)):_t(l)&&(l.value=null)),ie(c))Qn(c,a,12,[o,u]);else{const d=We(c),f=_t(c);if(d||f){const v=()=>{if(t.f){const I=d?ue(h,c)?h[c]:u[c]:c.value;i?X(I)&&Xu(I,s):X(I)?I.includes(s)||I.push(s):d?(u[c]=[s],ue(h,c)&&(h[c]=u[c])):(c.value=[s],t.k&&(u[t.k]=c.value))}else d?(u[c]=o,ue(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(u[t.k]=o))};o?(v.id=-1,Pt(v,n)):v()}}}const Pt=nT;function VT(t){return NT(t)}function NT(t,e){const n=$l();n.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=Xt,insertStaticContent:v}=t,I=(p,m,_,w=null,b=null,C=null,U=!1,N=null,M=!!m.dynamicChildren)=>{if(p===m)return;p&&!Rr(p,m)&&(w=A(p),Rt(p,b,C,!0),p=null),m.patchFlag===-2&&(M=!1,m.dynamicChildren=null);const{type:D,ref:Q,shapeFlag:G}=m;switch(D){case Ec:T(p,m,_,w);break;case Jt:R(p,m,_,w);break;case ml:p==null&&x(m,_,w,U);break;case Ft:z(p,m,_,w,b,C,U,N,M);break;default:G&1?W(p,m,_,w,b,C,U,N,M):G&6?ve(p,m,_,w,b,C,U,N,M):(G&64||G&128)&&D.process(p,m,_,w,b,C,U,N,M,F)}Q!=null&&b&&Zl(Q,p&&p.ref,C,m||p,!m)},T=(p,m,_,w)=>{if(p==null)r(m.el=a(m.children),_,w);else{const b=m.el=p.el;m.children!==p.children&&l(b,m.children)}},R=(p,m,_,w)=>{p==null?r(m.el=c(m.children||""),_,w):m.el=p.el},x=(p,m,_,w)=>{[p.el,p.anchor]=v(p.children,m,_,w,p.el,p.anchor)},O=({el:p,anchor:m},_,w)=>{let b;for(;p&&p!==m;)b=d(p),r(p,_,w),p=b;r(m,_,w)},V=({el:p,anchor:m})=>{let _;for(;p&&p!==m;)_=d(p),i(p),p=_;i(m)},W=(p,m,_,w,b,C,U,N,M)=>{U=U||m.type==="svg",p==null?J(m,_,w,b,C,U,N,M):Ae(p,m,b,C,U,N,M)},J=(p,m,_,w,b,C,U,N)=>{let M,D;const{type:Q,props:G,shapeFlag:Y,transition:te,dirs:se}=p;if(M=p.el=o(p.type,C,G&&G.is,G),Y&8?u(M,p.children):Y&16&&Z(p.children,M,null,w,b,C&&Q!=="foreignObject",U,N),se&&vr(p,null,w,"created"),pe(M,p,p.scopeId,U,w),G){for(const we in G)we!=="value"&&!_a(we)&&s(M,we,null,G[we],C,p.children,w,b,dt);"value"in G&&s(M,"value",null,G.value),(D=G.onVnodeBeforeMount)&&on(D,w,p)}se&&vr(p,null,w,"beforeMount");const Re=(!b||b&&!b.pendingBranch)&&te&&!te.persisted;Re&&te.beforeEnter(M),r(M,m,_),((D=G&&G.onVnodeMounted)||Re||se)&&Pt(()=>{D&&on(D,w,p),Re&&te.enter(M),se&&vr(p,null,w,"mounted")},b)},pe=(p,m,_,w,b)=>{if(_&&f(p,_),w)for(let C=0;C<w.length;C++)f(p,w[C]);if(b){let C=b.subTree;if(m===C){const U=b.vnode;pe(p,U,U.scopeId,U.slotScopeIds,b.parent)}}},Z=(p,m,_,w,b,C,U,N,M=0)=>{for(let D=M;D<p.length;D++){const Q=p[D]=N?qn(p[D]):an(p[D]);I(null,Q,m,_,w,b,C,U,N)}},Ae=(p,m,_,w,b,C,U)=>{const N=m.el=p.el;let{patchFlag:M,dynamicChildren:D,dirs:Q}=m;M|=p.patchFlag&16;const G=p.props||De,Y=m.props||De;let te;_&&Ir(_,!1),(te=Y.onVnodeBeforeUpdate)&&on(te,_,m,p),Q&&vr(m,p,_,"beforeUpdate"),_&&Ir(_,!0);const se=b&&m.type!=="foreignObject";if(D?me(p.dynamicChildren,D,N,_,w,se,C):U||_e(p,m,N,null,_,w,se,C,!1),M>0){if(M&16)Ye(N,m,G,Y,_,w,b);else if(M&2&&G.class!==Y.class&&s(N,"class",null,Y.class,b),M&4&&s(N,"style",G.style,Y.style,b),M&8){const Re=m.dynamicProps;for(let we=0;we<Re.length;we++){const Ke=Re[we],zt=G[Ke],fi=Y[Ke];(fi!==zt||Ke==="value")&&s(N,Ke,zt,fi,b,p.children,_,w,dt)}}M&1&&p.children!==m.children&&u(N,m.children)}else!U&&D==null&&Ye(N,m,G,Y,_,w,b);((te=Y.onVnodeUpdated)||Q)&&Pt(()=>{te&&on(te,_,m,p),Q&&vr(m,p,_,"updated")},w)},me=(p,m,_,w,b,C,U)=>{for(let N=0;N<m.length;N++){const M=p[N],D=m[N],Q=M.el&&(M.type===Ft||!Rr(M,D)||M.shapeFlag&70)?h(M.el):_;I(M,D,Q,null,w,b,C,U,!0)}},Ye=(p,m,_,w,b,C,U)=>{if(_!==w){if(_!==De)for(const N in _)!_a(N)&&!(N in w)&&s(p,N,_[N],null,U,m.children,b,C,dt);for(const N in w){if(_a(N))continue;const M=w[N],D=_[N];M!==D&&N!=="value"&&s(p,N,D,M,U,m.children,b,C,dt)}"value"in w&&s(p,"value",_.value,w.value)}},z=(p,m,_,w,b,C,U,N,M)=>{const D=m.el=p?p.el:a(""),Q=m.anchor=p?p.anchor:a("");let{patchFlag:G,dynamicChildren:Y,slotScopeIds:te}=m;te&&(N=N?N.concat(te):te),p==null?(r(D,_,w),r(Q,_,w),Z(m.children,_,Q,b,C,U,N,M)):G>0&&G&64&&Y&&p.dynamicChildren?(me(p.dynamicChildren,Y,_,b,C,U,N),(m.key!=null||b&&m===b.subTree)&&Mg(p,m,!0)):_e(p,m,_,Q,b,C,U,N,M)},ve=(p,m,_,w,b,C,U,N,M)=>{m.slotScopeIds=N,p==null?m.shapeFlag&512?b.ctx.activate(m,_,w,U,M):It(m,_,w,b,C,U,M):yn(p,m,M)},It=(p,m,_,w,b,C,U)=>{const N=p.component=qT(p,w,b);if(vc(p)&&(N.ctx.renderer=F),jT(N),N.asyncDep){if(b&&b.registerDep(N,Ue),!p.el){const M=N.subTree=Je(Jt);R(null,M,m,_)}return}Ue(N,p,m,_,b,C,U)},yn=(p,m,_)=>{const w=m.component=p.component;if(ZE(p,m,_))if(w.asyncDep&&!w.asyncResolved){be(w,m,_);return}else w.next=m,HE(w.update),w.update();else m.el=p.el,w.vnode=m},Ue=(p,m,_,w,b,C,U)=>{const N=()=>{if(p.isMounted){let{next:Q,bu:G,u:Y,parent:te,vnode:se}=p,Re=Q,we;Ir(p,!1),Q?(Q.el=se.el,be(p,Q,U)):Q=se,G&&ya(G),(we=Q.props&&Q.props.onVnodeBeforeUpdate)&&on(we,te,Q,se),Ir(p,!0);const Ke=dl(p),zt=p.subTree;p.subTree=Ke,I(zt,Ke,h(zt.el),A(zt),p,b,C),Q.el=Ke.el,Re===null&&eT(p,Ke.el),Y&&Pt(Y,b),(we=Q.props&&Q.props.onVnodeUpdated)&&Pt(()=>on(we,te,Q,se),b)}else{let Q;const{el:G,props:Y}=m,{bm:te,m:se,parent:Re}=p,we=va(m);if(Ir(p,!1),te&&ya(te),!we&&(Q=Y&&Y.onVnodeBeforeMount)&&on(Q,Re,m),Ir(p,!0),G&&ye){const Ke=()=>{p.subTree=dl(p),ye(G,p.subTree,p,b,null)};we?m.type.__asyncLoader().then(()=>!p.isUnmounted&&Ke()):Ke()}else{const Ke=p.subTree=dl(p);I(null,Ke,_,w,p,b,C),m.el=Ke.el}if(se&&Pt(se,b),!we&&(Q=Y&&Y.onVnodeMounted)){const Ke=m;Pt(()=>on(Q,Re,Ke),b)}(m.shapeFlag&256||Re&&va(Re.vnode)&&Re.vnode.shapeFlag&256)&&p.a&&Pt(p.a,b),p.isMounted=!0,m=_=w=null}},M=p.effect=new th(N,()=>ch(D),p.scope),D=p.update=()=>M.run();D.id=p.uid,Ir(p,!0),D()},be=(p,m,_)=>{m.component=p;const w=p.vnode.props;p.vnode=m,p.next=null,PT(p,m.props,w,_),xT(p,m.children,_),ts(),ff(),ns()},_e=(p,m,_,w,b,C,U,N,M=!1)=>{const D=p&&p.children,Q=p?p.shapeFlag:0,G=m.children,{patchFlag:Y,shapeFlag:te}=m;if(Y>0){if(Y&128){On(D,G,_,w,b,C,U,N,M);return}else if(Y&256){vn(D,G,_,w,b,C,U,N,M);return}}te&8?(Q&16&&dt(D,b,C),G!==D&&u(_,G)):Q&16?te&16?On(D,G,_,w,b,C,U,N,M):dt(D,b,C,!0):(Q&8&&u(_,""),te&16&&Z(G,_,w,b,C,U,N,M))},vn=(p,m,_,w,b,C,U,N,M)=>{p=p||Si,m=m||Si;const D=p.length,Q=m.length,G=Math.min(D,Q);let Y;for(Y=0;Y<G;Y++){const te=m[Y]=M?qn(m[Y]):an(m[Y]);I(p[Y],te,_,null,b,C,U,N,M)}D>Q?dt(p,b,C,!0,!1,G):Z(m,_,w,b,C,U,N,M,G)},On=(p,m,_,w,b,C,U,N,M)=>{let D=0;const Q=m.length;let G=p.length-1,Y=Q-1;for(;D<=G&&D<=Y;){const te=p[D],se=m[D]=M?qn(m[D]):an(m[D]);if(Rr(te,se))I(te,se,_,null,b,C,U,N,M);else break;D++}for(;D<=G&&D<=Y;){const te=p[G],se=m[Y]=M?qn(m[Y]):an(m[Y]);if(Rr(te,se))I(te,se,_,null,b,C,U,N,M);else break;G--,Y--}if(D>G){if(D<=Y){const te=Y+1,se=te<Q?m[te].el:w;for(;D<=Y;)I(null,m[D]=M?qn(m[D]):an(m[D]),_,se,b,C,U,N,M),D++}}else if(D>Y)for(;D<=G;)Rt(p[D],b,C,!0),D++;else{const te=D,se=D,Re=new Map;for(D=se;D<=Y;D++){const Mt=m[D]=M?qn(m[D]):an(m[D]);Mt.key!=null&&Re.set(Mt.key,D)}let we,Ke=0;const zt=Y-se+1;let fi=!1,ef=0;const ps=new Array(zt);for(D=0;D<zt;D++)ps[D]=0;for(D=te;D<=G;D++){const Mt=p[D];if(Ke>=zt){Rt(Mt,b,C,!0);continue}let sn;if(Mt.key!=null)sn=Re.get(Mt.key);else for(we=se;we<=Y;we++)if(ps[we-se]===0&&Rr(Mt,m[we])){sn=we;break}sn===void 0?Rt(Mt,b,C,!0):(ps[sn-se]=D+1,sn>=ef?ef=sn:fi=!0,I(Mt,m[sn],_,null,b,C,U,N,M),Ke++)}const tf=fi?OT(ps):Si;for(we=tf.length-1,D=zt-1;D>=0;D--){const Mt=se+D,sn=m[Mt],nf=Mt+1<Q?m[Mt+1].el:w;ps[D]===0?I(null,sn,_,nf,b,C,U,N,M):fi&&(we<0||D!==tf[we]?rn(sn,_,nf,2):we--)}}},rn=(p,m,_,w,b=null)=>{const{el:C,type:U,transition:N,children:M,shapeFlag:D}=p;if(D&6){rn(p.component.subTree,m,_,w);return}if(D&128){p.suspense.move(m,_,w);return}if(D&64){U.move(p,m,_,F);return}if(U===Ft){r(C,m,_);for(let G=0;G<M.length;G++)rn(M[G],m,_,w);r(p.anchor,m,_);return}if(U===ml){O(p,m,_);return}if(w!==2&&D&1&&N)if(w===0)N.beforeEnter(C),r(C,m,_),Pt(()=>N.enter(C),b);else{const{leave:G,delayLeave:Y,afterLeave:te}=N,se=()=>r(C,m,_),Re=()=>{G(C,()=>{se(),te&&te()})};Y?Y(C,se,Re):Re()}else r(C,m,_)},Rt=(p,m,_,w=!1,b=!1)=>{const{type:C,props:U,ref:N,children:M,dynamicChildren:D,shapeFlag:Q,patchFlag:G,dirs:Y}=p;if(N!=null&&Zl(N,null,_,p,!0),Q&256){m.ctx.deactivate(p);return}const te=Q&1&&Y,se=!va(p);let Re;if(se&&(Re=U&&U.onVnodeBeforeUnmount)&&on(Re,m,p),Q&6)Xo(p.component,_,w);else{if(Q&128){p.suspense.unmount(_,w);return}te&&vr(p,null,m,"beforeUnmount"),Q&64?p.type.remove(p,m,_,b,F,w):D&&(C!==Ft||G>0&&G&64)?dt(D,m,_,!1,!0):(C===Ft&&G&384||!b&&Q&16)&&dt(M,m,_),w&&hi(p)}(se&&(Re=U&&U.onVnodeUnmounted)||te)&&Pt(()=>{Re&&on(Re,m,p),te&&vr(p,null,m,"unmounted")},_)},hi=p=>{const{type:m,el:_,anchor:w,transition:b}=p;if(m===Ft){di(_,w);return}if(m===ml){V(p);return}const C=()=>{i(_),b&&!b.persisted&&b.afterLeave&&b.afterLeave()};if(p.shapeFlag&1&&b&&!b.persisted){const{leave:U,delayLeave:N}=b,M=()=>U(_,C);N?N(p.el,C,M):M()}else C()},di=(p,m)=>{let _;for(;p!==m;)_=d(p),i(p),p=_;i(m)},Xo=(p,m,_)=>{const{bum:w,scope:b,update:C,subTree:U,um:N}=p;w&&ya(w),b.stop(),C&&(C.active=!1,Rt(U,p,m,_)),N&&Pt(N,m),Pt(()=>{p.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&p.asyncDep&&!p.asyncResolved&&p.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},dt=(p,m,_,w=!1,b=!1,C=0)=>{for(let U=C;U<p.length;U++)Rt(p[U],m,_,w,b)},A=p=>p.shapeFlag&6?A(p.component.subTree):p.shapeFlag&128?p.suspense.next():d(p.anchor||p.el),q=(p,m,_)=>{p==null?m._vnode&&Rt(m._vnode,null,null,!0):I(m._vnode||null,p,m,null,null,null,_),ff(),mg(),m._vnode=p},F={p:I,um:Rt,m:rn,r:hi,mt:It,mc:Z,pc:_e,pbc:me,n:A,o:t};let H,ye;return e&&([H,ye]=e(F)),{render:q,hydrate:H,createApp:ST(q,H)}}function Ir({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Mg(t,e,n=!1){const r=t.children,i=e.children;if(X(r)&&X(i))for(let s=0;s<r.length;s++){const o=r[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=qn(i[s]),a.el=o.el),n||Mg(o,a)),a.type===Ec&&(a.el=o.el)}}function OT(t){const e=t.slice(),n=[0];let r,i,s,o,a;const c=t.length;for(r=0;r<c;r++){const l=t[r];if(l!==0){if(i=n[n.length-1],t[i]<l){e[r]=i,n.push(r);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<l?s=a+1:o=a;l<t[n[s]]&&(s>0&&(e[r]=n[s-1]),n[s]=r)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}const kT=t=>t.__isTeleport,Ft=Symbol.for("v-fgt"),Ec=Symbol.for("v-txt"),Jt=Symbol.for("v-cmt"),ml=Symbol.for("v-stc"),Os=[];let Qt=null;function ae(t=!1){Os.push(Qt=t?null:[])}function MT(){Os.pop(),Qt=Os[Os.length-1]||null}let Qs=1;function bf(t){Qs+=t}function Fg(t){return t.dynamicChildren=Qs>0?Qt||Si:null,MT(),Qs>0&&Qt&&Qt.push(t),t}function ge(t,e,n,r,i,s){return Fg(g(t,e,n,r,i,s,!0))}function ka(t,e,n,r,i){return Fg(Je(t,e,n,r,i,!0))}function eu(t){return t?t.__v_isVNode===!0:!1}function Rr(t,e){return t.type===e.type&&t.key===e.key}const Tc="__vInternal",Lg=({key:t})=>t??null,Ea=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?We(t)||_t(t)||ie(t)?{i:Lt,r:t,k:e,f:!!n}:t:null);function g(t,e=null,n=null,r=0,i=null,s=t===Ft?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Lg(e),ref:e&&Ea(e),scopeId:_c,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Lt};return a?(dh(c,n),s&128&&t.normalize(c)):n&&(c.shapeFlag|=We(n)?8:16),Qs>0&&!o&&Qt&&(c.patchFlag>0||s&6)&&c.patchFlag!==32&&Qt.push(c),c}const Je=FT;function FT(t,e=null,n=null,r=0,i=null,s=!1){if((!t||t===_T)&&(t=Jt),eu(t)){const a=er(t,e,!0);return n&&dh(a,n),Qs>0&&!s&&Qt&&(a.shapeFlag&6?Qt[Qt.indexOf(t)]=a:Qt.push(a)),a.patchFlag|=-2,a}if(QT(t)&&(t=t.__vccOpts),e){e=LT(e);let{class:a,style:c}=e;a&&!We(a)&&(e.class=Ao(a)),Se(c)&&(og(c)&&!X(c)&&(c=He({},c)),e.style=Zu(c))}const o=We(t)?1:tT(t)?128:kT(t)?64:Se(t)?4:ie(t)?2:0;return g(t,e,n,r,i,o,s,!0)}function LT(t){return t?og(t)||Tc in t?He({},t):t:null}function er(t,e,n=!1){const{props:r,ref:i,patchFlag:s,children:o}=t,a=e?BT(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&Lg(a),ref:e&&e.ref?n&&i?X(i)?i.concat(Ea(e)):[i,Ea(e)]:Ea(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ft?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&er(t.ssContent),ssFallback:t.ssFallback&&er(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function Ys(t=" ",e=0){return Je(Ec,null,t,e)}function mt(t="",e=!1){return e?(ae(),ka(Jt,null,t)):Je(Jt,null,t)}function an(t){return t==null||typeof t=="boolean"?Je(Jt):X(t)?Je(Ft,null,t.slice()):typeof t=="object"?qn(t):Je(Ec,null,String(t))}function qn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:er(t)}function dh(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(X(e))n=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),dh(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!(Tc in e)?e._ctx=Lt:i===3&&Lt&&(Lt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ie(e)?(e={default:e,_ctx:Lt},n=32):(e=String(e),r&64?(n=16,e=[Ys(e)]):n=8);t.children=e,t.shapeFlag|=n}function BT(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=Ao([e.class,r.class]));else if(i==="style")e.style=Zu([e.style,r.style]);else if(lc(i)){const s=e[i],o=r[i];o&&s!==o&&!(X(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function on(t,e,n,r=null){Kt(t,e,7,[n,r])}const UT=Dg();let $T=0;function qT(t,e,n){const r=t.type,i=(e?e.appContext:t.appContext)||UT,s={uid:$T++,vnode:t,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new Hm(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Vg(r,i),emitsOptions:_g(r,i),emit:null,emitted:null,propsDefaults:De,inheritAttrs:r.inheritAttrs,ctx:De,data:De,props:De,attrs:De,slots:De,refs:De,setupState:De,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=YE.bind(null,s),t.ce&&t.ce(s),s}let nt=null;const GT=()=>nt||Lt;let fh,pi,Sf="__VUE_INSTANCE_SETTERS__";(pi=$l()[Sf])||(pi=$l()[Sf]=[]),pi.push(t=>nt=t),fh=t=>{pi.length>1?pi.forEach(e=>e(t)):pi[0](t)};const Fi=t=>{fh(t),t.scope.on()},qr=()=>{nt&&nt.scope.off(),fh(null)};function Bg(t){return t.vnode.shapeFlag&4}let Xs=!1;function jT(t,e=!1){Xs=e;const{props:n,children:r}=t.vnode,i=Bg(t);RT(t,n,i,e),DT(t,r);const s=i?KT(t,e):void 0;return Xs=!1,s}function KT(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=ag(new Proxy(t.ctx,vT));const{setup:r}=n;if(r){const i=t.setupContext=r.length>1?HT(t):null;Fi(t),ts();const s=Qn(r,t,0,[t.props,i]);if(ns(),qr(),qm(s)){if(s.then(qr,qr),e)return s.then(o=>{Rf(t,o,e)}).catch(o=>{mc(o,t,0)});t.asyncDep=s}else Rf(t,s,e)}else Ug(t,e)}function Rf(t,e,n){ie(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Se(e)&&(t.setupState=hg(e)),Ug(t,n)}let Pf;function Ug(t,e,n){const r=t.type;if(!t.render){if(!e&&Pf&&!r.render){const i=r.template||uh(t).template;if(i){const{isCustomElement:s,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=r,l=He(He({isCustomElement:s,delimiters:a},o),c);r.render=Pf(i,l)}}t.render=r.render||Xt}Fi(t),ts(),IT(t),ns(),qr()}function zT(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,n){return Nt(t,"get","$attrs"),e[n]}}))}function HT(t){const e=n=>{t.exposed=n||{}};return{get attrs(){return zT(t)},slots:t.slots,emit:t.emit,expose:e}}function wc(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(hg(ag(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Ns)return Ns[n](t)},has(e,n){return n in e||n in Ns}}))}function WT(t,e=!0){return ie(t)?t.displayName||t.name:t.name||e&&t.__name}function QT(t){return ie(t)&&"__vccOpts"in t}const qt=(t,e)=>jE(t,e,Xs);function ph(t,e,n){const r=arguments.length;return r===2?Se(e)&&!X(e)?eu(e)?Je(t,null,[e]):Je(t,e):Je(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&eu(n)&&(n=[n]),Je(t,e,n))}const YT=Symbol.for("v-scx"),XT=()=>An(YT),JT="3.3.4",ZT="http://www.w3.org/2000/svg",Pr=typeof document<"u"?document:null,Cf=Pr&&Pr.createElement("template"),ew={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const i=e?Pr.createElementNS(ZT,t):Pr.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:t=>Pr.createTextNode(t),createComment:t=>Pr.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Pr.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,i,s){const o=n?n.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===s||!(i=i.nextSibling)););else{Cf.innerHTML=r?`<svg>${t}</svg>`:t;const a=Cf.content;if(r){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function tw(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function nw(t,e,n){const r=t.style,i=We(n);if(n&&!i){if(e&&!We(e))for(const s in e)n[s]==null&&tu(r,s,"");for(const s in n)tu(r,s,n[s])}else{const s=r.display;i?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=s)}}const Df=/\s*!important$/;function tu(t,e,n){if(X(n))n.forEach(r=>tu(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=rw(t,e);Df.test(n)?t.setProperty(es(r),n.replace(Df,""),"important"):t[r]=n}}const xf=["Webkit","Moz","ms"],gl={};function rw(t,e){const n=gl[e];if(n)return n;let r=mn(e);if(r!=="filter"&&r in t)return gl[e]=r;r=dc(r);for(let i=0;i<xf.length;i++){const s=xf[i]+r;if(s in t)return gl[e]=s}return e}const Vf="http://www.w3.org/1999/xlink";function iw(t,e,n,r,i){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Vf,e.slice(6,e.length)):t.setAttributeNS(Vf,e,n);else{const s=aE(e);n==null||s&&!Km(n)?t.removeAttribute(e):t.setAttribute(e,s?"":n)}}function sw(t,e,n,r,i,s,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,i,s),t[e]=n??"";return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){t._value=n;const l=a==="OPTION"?t.getAttribute("value"):t.value,u=n??"";l!==u&&(t.value=u),n==null&&t.removeAttribute(e);return}let c=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=Km(n):n==null&&l==="string"?(n="",c=!0):l==="number"&&(n=0,c=!0)}try{t[e]=n}catch{}c&&t.removeAttribute(e)}function Cr(t,e,n,r){t.addEventListener(e,n,r)}function ow(t,e,n,r){t.removeEventListener(e,n,r)}function aw(t,e,n,r,i=null){const s=t._vei||(t._vei={}),o=s[e];if(r&&o)o.value=r;else{const[a,c]=cw(e);if(r){const l=s[e]=hw(r,i);Cr(t,a,l,c)}else o&&(ow(t,a,o,c),s[e]=void 0)}}const Nf=/(?:Once|Passive|Capture)$/;function cw(t){let e;if(Nf.test(t)){e={};let r;for(;r=t.match(Nf);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):es(t.slice(2)),e]}let _l=0;const lw=Promise.resolve(),uw=()=>_l||(lw.then(()=>_l=0),_l=Date.now());function hw(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;Kt(dw(r,n.value),e,5,[r])};return n.value=t,n.attached=uw(),n}function dw(t,e){if(X(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const Of=/^on[a-z]/,fw=(t,e,n,r,i=!1,s,o,a,c)=>{e==="class"?tw(t,r,i):e==="style"?nw(t,n,r):lc(e)?Yu(e)||aw(t,e,n,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):pw(t,e,r,i))?sw(t,e,r,s,o,a,c):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),iw(t,e,r,i))};function pw(t,e,n,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&Of.test(e)&&ie(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Of.test(e)&&We(n)?!1:e in t}const Mn="transition",ms="animation",mh=(t,{slots:e})=>ph(oT,mw(t),e);mh.displayName="Transition";const $g={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};mh.props=He({},Ig,$g);const Er=(t,e=[])=>{X(t)?t.forEach(n=>n(...e)):t&&t(...e)},kf=t=>t?X(t)?t.some(e=>e.length>1):t.length>1:!1;function mw(t){const e={};for(const z in t)z in $g||(e[z]=t[z]);if(t.css===!1)return e;const{name:n="v",type:r,duration:i,enterFromClass:s=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=s,appearActiveClass:l=o,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,v=gw(i),I=v&&v[0],T=v&&v[1],{onBeforeEnter:R,onEnter:x,onEnterCancelled:O,onLeave:V,onLeaveCancelled:W,onBeforeAppear:J=R,onAppear:pe=x,onAppearCancelled:Z=O}=e,Ae=(z,ve,It)=>{Tr(z,ve?u:a),Tr(z,ve?l:o),It&&It()},me=(z,ve)=>{z._isLeaving=!1,Tr(z,h),Tr(z,f),Tr(z,d),ve&&ve()},Ye=z=>(ve,It)=>{const yn=z?pe:x,Ue=()=>Ae(ve,z,It);Er(yn,[ve,Ue]),Mf(()=>{Tr(ve,z?c:s),Fn(ve,z?u:a),kf(yn)||Ff(ve,r,I,Ue)})};return He(e,{onBeforeEnter(z){Er(R,[z]),Fn(z,s),Fn(z,o)},onBeforeAppear(z){Er(J,[z]),Fn(z,c),Fn(z,l)},onEnter:Ye(!1),onAppear:Ye(!0),onLeave(z,ve){z._isLeaving=!0;const It=()=>me(z,ve);Fn(z,h),vw(),Fn(z,d),Mf(()=>{z._isLeaving&&(Tr(z,h),Fn(z,f),kf(V)||Ff(z,r,T,It))}),Er(V,[z,It])},onEnterCancelled(z){Ae(z,!1),Er(O,[z])},onAppearCancelled(z){Ae(z,!0),Er(Z,[z])},onLeaveCancelled(z){me(z),Er(W,[z])}})}function gw(t){if(t==null)return null;if(Se(t))return[yl(t.enter),yl(t.leave)];{const e=yl(t);return[e,e]}}function yl(t){return tE(t)}function Fn(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function Tr(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function Mf(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let _w=0;function Ff(t,e,n,r){const i=t._endId=++_w,s=()=>{i===t._endId&&r()};if(n)return setTimeout(s,n);const{type:o,timeout:a,propCount:c}=yw(t,e);if(!o)return r();const l=o+"end";let u=0;const h=()=>{t.removeEventListener(l,d),s()},d=f=>{f.target===t&&++u>=c&&h()};setTimeout(()=>{u<c&&h()},a+1),t.addEventListener(l,d)}function yw(t,e){const n=window.getComputedStyle(t),r=v=>(n[v]||"").split(", "),i=r(`${Mn}Delay`),s=r(`${Mn}Duration`),o=Lf(i,s),a=r(`${ms}Delay`),c=r(`${ms}Duration`),l=Lf(a,c);let u=null,h=0,d=0;e===Mn?o>0&&(u=Mn,h=o,d=s.length):e===ms?l>0&&(u=ms,h=l,d=c.length):(h=Math.max(o,l),u=h>0?o>l?Mn:ms:null,d=u?u===Mn?s.length:c.length:0);const f=u===Mn&&/\b(transform|all)(,|$)/.test(r(`${Mn}Property`).toString());return{type:u,timeout:h,propCount:d,hasTransform:f}}function Lf(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,r)=>Bf(n)+Bf(t[r])))}function Bf(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function vw(){return document.body.offsetHeight}const Ma=t=>{const e=t.props["onUpdate:modelValue"]||!1;return X(e)?n=>ya(e,n):e};function Iw(t){t.target.composing=!0}function Uf(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ft={created(t,{modifiers:{lazy:e,trim:n,number:r}},i){t._assign=Ma(i);const s=r||i.props&&i.props.type==="number";Cr(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),s&&(a=Da(a)),t._assign(a)}),n&&Cr(t,"change",()=>{t.value=t.value.trim()}),e||(Cr(t,"compositionstart",Iw),Cr(t,"compositionend",Uf),Cr(t,"change",Uf))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:r,number:i}},s){if(t._assign=Ma(s),t.composing||document.activeElement===t&&t.type!=="range"&&(n||r&&t.value.trim()===e||(i||t.type==="number")&&Da(t.value)===e))return;const o=e??"";t.value!==o&&(t.value=o)}},Ew={deep:!0,created(t,{value:e,modifiers:{number:n}},r){const i=uc(e);Cr(t,"change",()=>{const s=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Da(Fa(o)):Fa(o));t._assign(t.multiple?i?new Set(s):s:s[0])}),t._assign=Ma(r)},mounted(t,{value:e}){$f(t,e)},beforeUpdate(t,e,n){t._assign=Ma(n)},updated(t,{value:e}){$f(t,e)}};function $f(t,e){const n=t.multiple;if(!(n&&!X(e)&&!uc(e))){for(let r=0,i=t.options.length;r<i;r++){const s=t.options[r],o=Fa(s);if(n)X(e)?s.selected=lE(e,o)>-1:s.selected=e.has(o);else if(fc(Fa(s),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Fa(t){return"_value"in t?t._value:t.value}const Tw=["ctrl","shift","alt","meta"],ww={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Tw.some(n=>t[`${n}Key`]&&!e.includes(n))},Aw=(t,e)=>(n,...r)=>{for(let i=0;i<e.length;i++){const s=ww[e[i]];if(s&&s(n,e))return}return t(n,...r)},qg={beforeMount(t,{value:e},{transition:n}){t._vod=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):gs(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:r}){!e!=!n&&(r?e?(r.beforeEnter(t),gs(t,!0),r.enter(t)):r.leave(t,()=>{gs(t,!1)}):gs(t,e))},beforeUnmount(t,{value:e}){gs(t,e)}};function gs(t,e){t.style.display=e?t._vod:"none"}const bw=He({patchProp:fw},ew);let qf;function Sw(){return qf||(qf=VT(bw))}const Rw=(...t)=>{const e=Sw().createApp(...t),{mount:n}=e;return e.mount=r=>{const i=Pw(r);if(!i)return;const s=e._component;!ie(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.innerHTML="";const o=n(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function Pw(t){return We(t)?document.querySelector(t):t}function Cw(){return Gg().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Gg(){return typeof navigator<"u"&&typeof window<"u"?window:typeof global<"u"?global:{}}const Dw=typeof Proxy=="function",xw="devtools-plugin:setup",Vw="plugin:settings:set";let mi,nu;function Nw(){var t;return mi!==void 0||(typeof window<"u"&&window.performance?(mi=!0,nu=window.performance):typeof global<"u"&&(!((t=global.perf_hooks)===null||t===void 0)&&t.performance)?(mi=!0,nu=global.perf_hooks.performance):mi=!1),mi}function Ow(){return Nw()?nu.now():Date.now()}class kw{constructor(e,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=n;const r={};if(e.settings)for(const o in e.settings){const a=e.settings[o];r[o]=a.defaultValue}const i=`__vue-devtools-plugin-settings__${e.id}`;let s=Object.assign({},r);try{const o=localStorage.getItem(i),a=JSON.parse(o);Object.assign(s,a)}catch{}this.fallbacks={getSettings(){return s},setSettings(o){try{localStorage.setItem(i,JSON.stringify(o))}catch{}s=o},now(){return Ow()}},n&&n.on(Vw,(o,a)=>{o===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(o,a)=>this.target?this.target.on[a]:(...c)=>{this.onQueue.push({method:a,args:c})}}),this.proxiedTarget=new Proxy({},{get:(o,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...c)=>(this.targetQueue.push({method:a,args:c,resolve:()=>{}}),this.fallbacks[a](...c)):(...c)=>new Promise(l=>{this.targetQueue.push({method:a,args:c,resolve:l})})})}async setRealTarget(e){this.target=e;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(await this.target[n.method](...n.args))}}function Mw(t,e){const n=t,r=Gg(),i=Cw(),s=Dw&&n.enableEarlyProxy;if(i&&(r.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!s))i.emit(xw,t,e);else{const o=s?new kw(n,i):null;(r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:e,proxy:o}),o&&e(o.proxiedTarget)}}/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */var Fw="store";function rs(t,e){Object.keys(t).forEach(function(n){return e(t[n],n)})}function jg(t){return t!==null&&typeof t=="object"}function Lw(t){return t&&typeof t.then=="function"}function Bw(t,e){return function(){return t(e)}}function Kg(t,e,n){return e.indexOf(t)<0&&(n&&n.prepend?e.unshift(t):e.push(t)),function(){var r=e.indexOf(t);r>-1&&e.splice(r,1)}}function zg(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var n=t.state;Ac(t,n,[],t._modules.root,!0),gh(t,n,e)}function gh(t,e,n){var r=t._state,i=t._scope;t.getters={},t._makeLocalGettersCache=Object.create(null);var s=t._wrappedGetters,o={},a={},c=uE(!0);c.run(function(){rs(s,function(l,u){o[u]=Bw(l,t),a[u]=qt(function(){return o[u]()}),Object.defineProperty(t.getters,u,{get:function(){return a[u].value},enumerable:!0})})}),t._state=bo({data:e}),t._scope=c,t.strict&&jw(t),r&&n&&t._withCommit(function(){r.data=null}),i&&i.stop()}function Ac(t,e,n,r,i){var s=!n.length,o=t._modules.getNamespace(n);if(r.namespaced&&(t._modulesNamespaceMap[o],t._modulesNamespaceMap[o]=r),!s&&!i){var a=_h(e,n.slice(0,-1)),c=n[n.length-1];t._withCommit(function(){a[c]=r.state})}var l=r.context=Uw(t,o,n);r.forEachMutation(function(u,h){var d=o+h;$w(t,d,u,l)}),r.forEachAction(function(u,h){var d=u.root?h:o+h,f=u.handler||u;qw(t,d,f,l)}),r.forEachGetter(function(u,h){var d=o+h;Gw(t,d,u,l)}),r.forEachChild(function(u,h){Ac(t,e,n.concat(h),u,i)})}function Uw(t,e,n){var r=e==="",i={dispatch:r?t.dispatch:function(s,o,a){var c=La(s,o,a),l=c.payload,u=c.options,h=c.type;return(!u||!u.root)&&(h=e+h),t.dispatch(h,l)},commit:r?t.commit:function(s,o,a){var c=La(s,o,a),l=c.payload,u=c.options,h=c.type;(!u||!u.root)&&(h=e+h),t.commit(h,l,u)}};return Object.defineProperties(i,{getters:{get:r?function(){return t.getters}:function(){return Hg(t,e)}},state:{get:function(){return _h(t.state,n)}}}),i}function Hg(t,e){if(!t._makeLocalGettersCache[e]){var n={},r=e.length;Object.keys(t.getters).forEach(function(i){if(i.slice(0,r)===e){var s=i.slice(r);Object.defineProperty(n,s,{get:function(){return t.getters[i]},enumerable:!0})}}),t._makeLocalGettersCache[e]=n}return t._makeLocalGettersCache[e]}function $w(t,e,n,r){var i=t._mutations[e]||(t._mutations[e]=[]);i.push(function(o){n.call(t,r.state,o)})}function qw(t,e,n,r){var i=t._actions[e]||(t._actions[e]=[]);i.push(function(o){var a=n.call(t,{dispatch:r.dispatch,commit:r.commit,getters:r.getters,state:r.state,rootGetters:t.getters,rootState:t.state},o);return Lw(a)||(a=Promise.resolve(a)),t._devtoolHook?a.catch(function(c){throw t._devtoolHook.emit("vuex:error",c),c}):a})}function Gw(t,e,n,r){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(s){return n(r.state,r.getters,s.state,s.getters)})}function jw(t){xi(function(){return t._state.data},function(){},{deep:!0,flush:"sync"})}function _h(t,e){return e.reduce(function(n,r){return n[r]},t)}function La(t,e,n){return jg(t)&&t.type&&(n=e,e=t,t=t.type),{type:t,payload:e,options:n}}var Kw="vuex bindings",Gf="vuex:mutations",vl="vuex:actions",gi="vuex",zw=0;function Hw(t,e){Mw({id:"org.vuejs.vuex",app:t,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[Kw]},function(n){n.addTimelineLayer({id:Gf,label:"Vuex Mutations",color:jf}),n.addTimelineLayer({id:vl,label:"Vuex Actions",color:jf}),n.addInspector({id:gi,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree(function(r){if(r.app===t&&r.inspectorId===gi)if(r.filter){var i=[];Xg(i,e._modules.root,r.filter,""),r.rootNodes=i}else r.rootNodes=[Yg(e._modules.root,"")]}),n.on.getInspectorState(function(r){if(r.app===t&&r.inspectorId===gi){var i=r.nodeId;Hg(e,i),r.state=Yw(Jw(e._modules,i),i==="root"?e.getters:e._makeLocalGettersCache,i)}}),n.on.editInspectorState(function(r){if(r.app===t&&r.inspectorId===gi){var i=r.nodeId,s=r.path;i!=="root"&&(s=i.split("/").filter(Boolean).concat(s)),e._withCommit(function(){r.set(e._state.data,s,r.state.value)})}}),e.subscribe(function(r,i){var s={};r.payload&&(s.payload=r.payload),s.state=i,n.notifyComponentUpdate(),n.sendInspectorTree(gi),n.sendInspectorState(gi),n.addTimelineEvent({layerId:Gf,event:{time:Date.now(),title:r.type,data:s}})}),e.subscribeAction({before:function(r,i){var s={};r.payload&&(s.payload=r.payload),r._id=zw++,r._time=Date.now(),s.state=i,n.addTimelineEvent({layerId:vl,event:{time:r._time,title:r.type,groupId:r._id,subtitle:"start",data:s}})},after:function(r,i){var s={},o=Date.now()-r._time;s.duration={_custom:{type:"duration",display:o+"ms",tooltip:"Action duration",value:o}},r.payload&&(s.payload=r.payload),s.state=i,n.addTimelineEvent({layerId:vl,event:{time:Date.now(),title:r.type,groupId:r._id,subtitle:"end",data:s}})}})})}var jf=8702998,Ww=6710886,Qw=16777215,Wg={label:"namespaced",textColor:Qw,backgroundColor:Ww};function Qg(t){return t&&t!=="root"?t.split("/").slice(-2,-1)[0]:"Root"}function Yg(t,e){return{id:e||"root",label:Qg(e),tags:t.namespaced?[Wg]:[],children:Object.keys(t._children).map(function(n){return Yg(t._children[n],e+n+"/")})}}function Xg(t,e,n,r){r.includes(n)&&t.push({id:r||"root",label:r.endsWith("/")?r.slice(0,r.length-1):r||"Root",tags:e.namespaced?[Wg]:[]}),Object.keys(e._children).forEach(function(i){Xg(t,e._children[i],n,r+i+"/")})}function Yw(t,e,n){e=n==="root"?e:e[n];var r=Object.keys(e),i={state:Object.keys(t.state).map(function(o){return{key:o,editable:!0,value:t.state[o]}})};if(r.length){var s=Xw(e);i.getters=Object.keys(s).map(function(o){return{key:o.endsWith("/")?Qg(o):o,editable:!1,value:ru(function(){return s[o]})}})}return i}function Xw(t){var e={};return Object.keys(t).forEach(function(n){var r=n.split("/");if(r.length>1){var i=e,s=r.pop();r.forEach(function(o){i[o]||(i[o]={_custom:{value:{},display:o,tooltip:"Module",abstract:!0}}),i=i[o]._custom.value}),i[s]=ru(function(){return t[n]})}else e[n]=ru(function(){return t[n]})}),e}function Jw(t,e){var n=e.split("/").filter(function(r){return r});return n.reduce(function(r,i,s){var o=r[i];if(!o)throw new Error('Missing module "'+i+'" for path "'+e+'".');return s===n.length-1?o:o._children},e==="root"?t:t.root._children)}function ru(t){try{return t()}catch(e){return e}}var nn=function(e,n){this.runtime=n,this._children=Object.create(null),this._rawModule=e;var r=e.state;this.state=(typeof r=="function"?r():r)||{}},Jg={namespaced:{configurable:!0}};Jg.namespaced.get=function(){return!!this._rawModule.namespaced};nn.prototype.addChild=function(e,n){this._children[e]=n};nn.prototype.removeChild=function(e){delete this._children[e]};nn.prototype.getChild=function(e){return this._children[e]};nn.prototype.hasChild=function(e){return e in this._children};nn.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)};nn.prototype.forEachChild=function(e){rs(this._children,e)};nn.prototype.forEachGetter=function(e){this._rawModule.getters&&rs(this._rawModule.getters,e)};nn.prototype.forEachAction=function(e){this._rawModule.actions&&rs(this._rawModule.actions,e)};nn.prototype.forEachMutation=function(e){this._rawModule.mutations&&rs(this._rawModule.mutations,e)};Object.defineProperties(nn.prototype,Jg);var ni=function(e){this.register([],e,!1)};ni.prototype.get=function(e){return e.reduce(function(n,r){return n.getChild(r)},this.root)};ni.prototype.getNamespace=function(e){var n=this.root;return e.reduce(function(r,i){return n=n.getChild(i),r+(n.namespaced?i+"/":"")},"")};ni.prototype.update=function(e){Zg([],this.root,e)};ni.prototype.register=function(e,n,r){var i=this;r===void 0&&(r=!0);var s=new nn(n,r);if(e.length===0)this.root=s;else{var o=this.get(e.slice(0,-1));o.addChild(e[e.length-1],s)}n.modules&&rs(n.modules,function(a,c){i.register(e.concat(c),a,r)})};ni.prototype.unregister=function(e){var n=this.get(e.slice(0,-1)),r=e[e.length-1],i=n.getChild(r);i&&i.runtime&&n.removeChild(r)};ni.prototype.isRegistered=function(e){var n=this.get(e.slice(0,-1)),r=e[e.length-1];return n?n.hasChild(r):!1};function Zg(t,e,n){if(e.update(n),n.modules)for(var r in n.modules){if(!e.getChild(r))return;Zg(t.concat(r),e.getChild(r),n.modules[r])}}function Zw(t){return new kt(t)}var kt=function(e){var n=this;e===void 0&&(e={});var r=e.plugins;r===void 0&&(r=[]);var i=e.strict;i===void 0&&(i=!1);var s=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new ni(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=s;var o=this,a=this,c=a.dispatch,l=a.commit;this.dispatch=function(d,f){return c.call(o,d,f)},this.commit=function(d,f,v){return l.call(o,d,f,v)},this.strict=i;var u=this._modules.root.state;Ac(this,u,[],this._modules.root),gh(this,u),r.forEach(function(h){return h(n)})},yh={state:{configurable:!0}};kt.prototype.install=function(e,n){e.provide(n||Fw,this),e.config.globalProperties.$store=this;var r=this._devtools!==void 0?this._devtools:!1;r&&Hw(e,this)};yh.state.get=function(){return this._state.data};yh.state.set=function(t){};kt.prototype.commit=function(e,n,r){var i=this,s=La(e,n,r),o=s.type,a=s.payload,c={type:o,payload:a},l=this._mutations[o];l&&(this._withCommit(function(){l.forEach(function(h){h(a)})}),this._subscribers.slice().forEach(function(u){return u(c,i.state)}))};kt.prototype.dispatch=function(e,n){var r=this,i=La(e,n),s=i.type,o=i.payload,a={type:s,payload:o},c=this._actions[s];if(c){try{this._actionSubscribers.slice().filter(function(u){return u.before}).forEach(function(u){return u.before(a,r.state)})}catch{}var l=c.length>1?Promise.all(c.map(function(u){return u(o)})):c[0](o);return new Promise(function(u,h){l.then(function(d){try{r._actionSubscribers.filter(function(f){return f.after}).forEach(function(f){return f.after(a,r.state)})}catch{}u(d)},function(d){try{r._actionSubscribers.filter(function(f){return f.error}).forEach(function(f){return f.error(a,r.state,d)})}catch{}h(d)})})}};kt.prototype.subscribe=function(e,n){return Kg(e,this._subscribers,n)};kt.prototype.subscribeAction=function(e,n){var r=typeof e=="function"?{before:e}:e;return Kg(r,this._actionSubscribers,n)};kt.prototype.watch=function(e,n,r){var i=this;return xi(function(){return e(i.state,i.getters)},n,Object.assign({},r))};kt.prototype.replaceState=function(e){var n=this;this._withCommit(function(){n._state.data=e})};kt.prototype.registerModule=function(e,n,r){r===void 0&&(r={}),typeof e=="string"&&(e=[e]),this._modules.register(e,n),Ac(this,this.state,e,this._modules.get(e),r.preserveState),gh(this,this.state)};kt.prototype.unregisterModule=function(e){var n=this;typeof e=="string"&&(e=[e]),this._modules.unregister(e),this._withCommit(function(){var r=_h(n.state,e.slice(0,-1));delete r[e[e.length-1]]}),zg(this)};kt.prototype.hasModule=function(e){return typeof e=="string"&&(e=[e]),this._modules.isRegistered(e)};kt.prototype.hotUpdate=function(e){this._modules.update(e),zg(this,!0)};kt.prototype._withCommit=function(e){var n=this._committing;this._committing=!0,e(),this._committing=n};Object.defineProperties(kt.prototype,yh);var Po=Eh(function(t,e){var n={};return Ih(e).forEach(function(r){var i=r.key,s=r.val;n[i]=function(){var a=this.$store.state,c=this.$store.getters;if(t){var l=Th(this.$store,"mapState",t);if(!l)return;a=l.context.state,c=l.context.getters}return typeof s=="function"?s.call(this,a,c):a[s]},n[i].vuex=!0}),n}),bc=Eh(function(t,e){var n={};return Ih(e).forEach(function(r){var i=r.key,s=r.val;n[i]=function(){for(var a=[],c=arguments.length;c--;)a[c]=arguments[c];var l=this.$store.commit;if(t){var u=Th(this.$store,"mapMutations",t);if(!u)return;l=u.context.commit}return typeof s=="function"?s.apply(this,[l].concat(a)):l.apply(this.$store,[s].concat(a))}}),n}),vh=Eh(function(t,e){var n={};return Ih(e).forEach(function(r){var i=r.key,s=r.val;n[i]=function(){for(var a=[],c=arguments.length;c--;)a[c]=arguments[c];var l=this.$store.dispatch;if(t){var u=Th(this.$store,"mapActions",t);if(!u)return;l=u.context.dispatch}return typeof s=="function"?s.apply(this,[l].concat(a)):l.apply(this.$store,[s].concat(a))}}),n});function Ih(t){return eA(t)?Array.isArray(t)?t.map(function(e){return{key:e,val:e}}):Object.keys(t).map(function(e){return{key:e,val:t[e]}}):[]}function eA(t){return Array.isArray(t)||jg(t)}function Eh(t){return function(e,n){return typeof e!="string"?(n=e,e=""):e.charAt(e.length-1)!=="/"&&(e+="/"),t(e,n)}}function Th(t,e,n){var r=t._modulesNamespaceMap[n];return r}const tA="/assets/file-invoice-dollar-solid-5b7c53d4.png";const dr=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n},nA={name:"app-navigation"},rA=t=>(So("data-v-a84a5ac7"),t=t(),Ro(),t),iA={class:"flex"},sA=rA(()=>g("div",{class:"branding flex"},[g("img",{src:tA,alt:""})],-1)),oA=[sA];function aA(t,e,n,r,i,s){return ae(),ge("header",iA,oA)}const cA=dr(nA,[["render",aA],["__scopeId","data-v-a84a5ac7"]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},lA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},t_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),r.push(n[u],n[h],n[d],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(e_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):lA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const l=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new uA;const d=s<<2|a>>4;if(r.push(d),l!==64){const f=a<<4&240|l>>2;if(r.push(f),h!==64){const v=l<<6&192|h;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class uA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hA=function(t){const e=e_(t);return t_.encodeByteArray(e,!0)},Ba=function(t){return hA(t).replace(/\./g,"")},dA=function(t){try{return t_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ua(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!fA(n)||(t[n]=Ua(t[n],e[n]));return t}function fA(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA=()=>pA().__FIREBASE_DEFAULTS__,gA=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},_A=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&dA(t[1]);return e&&JSON.parse(e)},n_=()=>{try{return mA()||gA()||_A()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},r_=()=>{var t;return(t=n_())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Ba(JSON.stringify(n)),Ba(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function IA(){var t;const e=(t=n_())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function EA(){return typeof self=="object"&&self.self===self}function TA(){return!IA()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function i_(){try{return typeof indexedDB=="object"}catch{return!1}}function wA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA="FirebaseError";class ri extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=AA,Object.setPrototypeOf(this,ri.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sc.prototype.create)}}class Sc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?bA(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ri(i,a,r)}}function bA(t,e){return t.replace(SA,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const SA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function su(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(zf(s)&&zf(o)){if(!su(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function zf(t){return t!==null&&typeof t=="object"}function RA(t,e){const n=new PA(t,e);return n.subscribe.bind(n)}class PA{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");CA(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Il),i.error===void 0&&(i.error=Il),i.complete===void 0&&(i.complete=Il);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function CA(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Il(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(t){return t&&t._delegate?t._delegate:t}class Kr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ar="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new yA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(VA(e))try{this.getOrInitializeService({instanceIdentifier:Ar})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ar){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ar){return this.instances.has(e)}getOptions(e=Ar){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ar){return this.component?this.component.multipleInstances?e:Ar:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xA(t){return t===Ar?void 0:t}function VA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new DA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh=[];var de;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(de||(de={}));const s_={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},OA=de.INFO,kA={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},MA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=kA[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ah{constructor(e){this.name=e,this._logLevel=OA,this._logHandler=MA,this._userLogHandler=null,wh.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?s_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...e),this._logHandler(this,de.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...e),this._logHandler(this,de.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.INFO,...e),this._logHandler(this,de.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.WARN,...e),this._logHandler(this,de.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.ERROR,...e),this._logHandler(this,de.ERROR,...e)}}function FA(t){wh.forEach(e=>{e.setLogLevel(t)})}function LA(t,e){for(const n of wh){let r=null;e&&e.level&&(r=s_[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,s,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&t({level:de[s].toLowerCase(),message:a,args:o,type:i.name})}}}const BA=(t,e)=>e.some(n=>t instanceof n);let Hf,Wf;function UA(){return Hf||(Hf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $A(){return Wf||(Wf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const o_=new WeakMap,ou=new WeakMap,a_=new WeakMap,El=new WeakMap,bh=new WeakMap;function qA(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Yn(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&o_.set(n,t)}).catch(()=>{}),bh.set(e,t),e}function GA(t){if(ou.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});ou.set(t,e)}let au={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ou.get(t);if(e==="objectStoreNames")return t.objectStoreNames||a_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Yn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function jA(t){au=t(au)}function KA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Tl(this),e,...n);return a_.set(r,e.sort?e.sort():[e]),Yn(r)}:$A().includes(t)?function(...e){return t.apply(Tl(this),e),Yn(o_.get(this))}:function(...e){return Yn(t.apply(Tl(this),e))}}function zA(t){return typeof t=="function"?KA(t):(t instanceof IDBTransaction&&GA(t),BA(t,UA())?new Proxy(t,au):t)}function Yn(t){if(t instanceof IDBRequest)return qA(t);if(El.has(t))return El.get(t);const e=zA(t);return e!==t&&(El.set(t,e),bh.set(e,t)),e}const Tl=t=>bh.get(t);function HA(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Yn(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Yn(o.result),c.oldVersion,c.newVersion,Yn(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const WA=["get","getKey","getAll","getAllKeys","count"],QA=["put","add","delete","clear"],wl=new Map;function Qf(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(wl.get(e))return wl.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=QA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||WA.includes(n)))return;const s=async function(o,...a){const c=this.transaction(o,i?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),i&&c.done]))[0]};return wl.set(e,s),s}jA(t=>({...t,get:(e,n,r)=>Qf(e,n)||t.get(e,n,r),has:(e,n)=>!!Qf(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(XA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function XA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cu="@firebase/app",Yf="0.9.15";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr=new Ah("@firebase/app"),JA="@firebase/app-compat",ZA="@firebase/analytics-compat",eb="@firebase/analytics",tb="@firebase/app-check-compat",nb="@firebase/app-check",rb="@firebase/auth",ib="@firebase/auth-compat",sb="@firebase/database",ob="@firebase/database-compat",ab="@firebase/functions",cb="@firebase/functions-compat",lb="@firebase/installations",ub="@firebase/installations-compat",hb="@firebase/messaging",db="@firebase/messaging-compat",fb="@firebase/performance",pb="@firebase/performance-compat",mb="@firebase/remote-config",gb="@firebase/remote-config-compat",_b="@firebase/storage",yb="@firebase/storage-compat",vb="@firebase/firestore",Ib="@firebase/firestore-compat",Eb="firebase",Tb="10.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tr="[DEFAULT]",wb={[cu]:"fire-core",[JA]:"fire-core-compat",[eb]:"fire-analytics",[ZA]:"fire-analytics-compat",[nb]:"fire-app-check",[tb]:"fire-app-check-compat",[rb]:"fire-auth",[ib]:"fire-auth-compat",[sb]:"fire-rtdb",[ob]:"fire-rtdb-compat",[ab]:"fire-fn",[cb]:"fire-fn-compat",[lb]:"fire-iid",[ub]:"fire-iid-compat",[hb]:"fire-fcm",[db]:"fire-fcm-compat",[fb]:"fire-perf",[pb]:"fire-perf-compat",[mb]:"fire-rc",[gb]:"fire-rc-compat",[_b]:"fire-gcs",[yb]:"fire-gcs-compat",[vb]:"fire-fst",[Ib]:"fire-fst-compat","fire-js":"fire-js",[Eb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr=new Map,Js=new Map;function $a(t,e){try{t.container.addComponent(e)}catch(n){zr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function c_(t,e){t.container.addOrOverwriteComponent(e)}function Li(t){const e=t.name;if(Js.has(e))return zr.debug(`There were multiple attempts to register component ${e}.`),!1;Js.set(e,t);for(const n of nr.values())$a(n,t);return!0}function l_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Ab(t,e,n=tr){l_(t,e).clearInstance(n)}function bb(){Js.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},bn=new Sc("app","Firebase",Sb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rb=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Kr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh=Tb;function Rh(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:tr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw bn.create("bad-app-name",{appName:String(i)});if(n||(n=r_()),!n)throw bn.create("no-options");const s=nr.get(i);if(s){if(su(n,s.options)&&su(r,s.config))return s;throw bn.create("duplicate-app",{appName:i})}const o=new NA(i);for(const c of Js.values())o.addComponent(c);const a=new Rb(n,r,o);return nr.set(i,a),a}function Pb(t=tr){const e=nr.get(t);if(!e&&t===tr&&r_())return Rh();if(!e)throw bn.create("no-app",{appName:t});return e}function Cb(){return Array.from(nr.values())}async function u_(t){const e=t.name;nr.has(e)&&(nr.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Xn(t,e,n){var r;let i=(r=wb[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zr.warn(a.join(" "));return}Li(new Kr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function h_(t,e){if(t!==null&&typeof t!="function")throw bn.create("invalid-log-argument");LA(t,e)}function d_(t){FA(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db="firebase-heartbeat-database",xb=1,Zs="firebase-heartbeat-store";let Al=null;function f_(){return Al||(Al=HA(Db,xb,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Zs)}}}).catch(t=>{throw bn.create("idb-open",{originalErrorMessage:t.message})})),Al}async function Vb(t){try{return await(await f_()).transaction(Zs).objectStore(Zs).get(p_(t))}catch(e){if(e instanceof ri)zr.warn(e.message);else{const n=bn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});zr.warn(n.message)}}}async function Xf(t,e){try{const r=(await f_()).transaction(Zs,"readwrite");await r.objectStore(Zs).put(e,p_(t)),await r.done}catch(n){if(n instanceof ri)zr.warn(n.message);else{const r=bn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});zr.warn(r.message)}}}function p_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=1024,Ob=30*24*60*60*1e3;class kb{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Fb(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Jf();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=Ob}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Jf(),{heartbeatsToSend:n,unsentEntries:r}=Mb(this._heartbeatsCache.heartbeats),i=Ba(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Jf(){return new Date().toISOString().substring(0,10)}function Mb(t,e=Nb){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Zf(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Zf(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Fb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return i_()?wA().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Vb(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Xf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Xf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Zf(t){return Ba(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(t){Li(new Kr("platform-logger",e=>new YA(e),"PRIVATE")),Li(new Kr("heartbeat",e=>new kb(e),"PRIVATE")),Xn(cu,Yf,t),Xn(cu,Yf,"esm2017"),Xn("fire-js","")}Lb("");const Bb=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:ri,SDK_VERSION:Sh,_DEFAULT_ENTRY_NAME:tr,_addComponent:$a,_addOrOverwriteComponent:c_,_apps:nr,_clearComponents:bb,_components:Js,_getProvider:l_,_registerComponent:Li,_removeServiceInstance:Ab,deleteApp:u_,getApp:Pb,getApps:Cb,initializeApp:Rh,onLog:h_,registerVersion:Xn,setLogLevel:d_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,n){this._delegate=e,this.firebase=n,$a(e,new Kr("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),u_(this._delegate)))}_getService(e,n=tr){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=tr){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){$a(this._delegate,e)}_addOrOverwriteComponent(e){c_(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},ep=new Sc("app-compat","Firebase",$b);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(t){const e={},n={__esModule:!0,initializeApp:s,app:i,registerVersion:Xn,setLogLevel:d_,onLog:h_,apps:null,SDK_VERSION:Sh,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:Bb}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||tr,!Kf(e,l))throw ep.create("no-app",{appName:l});return e[l]}i.App=t;function s(l,u={}){const h=Rh(l,u);if(Kf(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(l=>e[l])}function a(l){const u=l.name,h=u.replace("-compat","");if(Li(l)&&l.type==="PUBLIC"){const d=(f=i())=>{if(typeof f[h]!="function")throw ep.create("invalid-app-argument",{appName:u});return f[h]()};l.serviceProps!==void 0&&Ua(d,l.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,l.multipleInstances?f:[])}}return l.type==="PUBLIC"?n[h]:null}function c(l,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(){const t=qb(Ub);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:m_,extendNamespace:e,createSubscribe:RA,ErrorFactory:Sc,deepExtend:Ua});function e(n){Ua(t,n)}return t}const Gb=m_();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp=new Ah("@firebase/app-compat"),jb="@firebase/app-compat",Kb="0.2.15";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zb(t){Xn(jb,Kb,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(EA()&&self.firebase!==void 0){tp.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&tp.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Ph=Gb;zb();var Hb="firebase",Wb="10.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ph.registerVersion(Hb,Wb,"app-compat");var Qb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},B,Ch=Ch||{},ee=Qb||self;function Rc(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Co(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Yb(t){return Object.prototype.hasOwnProperty.call(t,bl)&&t[bl]||(t[bl]=++Xb)}var bl="closure_uid_"+(1e9*Math.random()>>>0),Xb=0;function Jb(t,e,n){return t.call.apply(t.bind,arguments)}function Zb(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function yt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?yt=Jb:yt=Zb,yt.apply(null,arguments)}function ia(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function st(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function fr(){this.s=this.s,this.o=this.o}var e0=0;fr.prototype.s=!1;fr.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),e0!=0)&&Yb(this)};fr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const g_=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Dh(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function np(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Rc(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function vt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}vt.prototype.h=function(){this.defaultPrevented=!0};var t0=function(){if(!ee.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ee.addEventListener("test",()=>{},e),ee.removeEventListener("test",()=>{},e)}catch{}return t}();function eo(t){return/^[\s\xa0]*$/.test(t)}function Pc(){var t=ee.navigator;return t&&(t=t.userAgent)?t:""}function ln(t){return Pc().indexOf(t)!=-1}function xh(t){return xh[" "](t),t}xh[" "]=function(){};function n0(t,e){var n=W0;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var r0=ln("Opera"),Bi=ln("Trident")||ln("MSIE"),__=ln("Edge"),lu=__||Bi,y_=ln("Gecko")&&!(Pc().toLowerCase().indexOf("webkit")!=-1&&!ln("Edge"))&&!(ln("Trident")||ln("MSIE"))&&!ln("Edge"),i0=Pc().toLowerCase().indexOf("webkit")!=-1&&!ln("Edge");function v_(){var t=ee.document;return t?t.documentMode:void 0}var uu;e:{var Sl="",Rl=function(){var t=Pc();if(y_)return/rv:([^\);]+)(\)|;)/.exec(t);if(__)return/Edge\/([\d\.]+)/.exec(t);if(Bi)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(i0)return/WebKit\/(\S+)/.exec(t);if(r0)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Rl&&(Sl=Rl?Rl[1]:""),Bi){var Pl=v_();if(Pl!=null&&Pl>parseFloat(Sl)){uu=String(Pl);break e}}uu=Sl}var hu;if(ee.document&&Bi){var rp=v_();hu=rp||parseInt(uu,10)||void 0}else hu=void 0;var s0=hu;function to(t,e){if(vt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(y_){e:{try{xh(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:o0[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&to.$.h.call(this)}}st(to,vt);var o0={2:"touch",3:"pen",4:"mouse"};to.prototype.h=function(){to.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Do="closure_listenable_"+(1e6*Math.random()|0),a0=0;function c0(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++a0,this.fa=this.ia=!1}function Cc(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Vh(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function l0(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function I_(t){const e={};for(const n in t)e[n]=t[n];return e}const ip="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E_(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<ip.length;s++)n=ip[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Dc(t){this.src=t,this.g={},this.h=0}Dc.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=fu(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new c0(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function du(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=g_(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Cc(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function fu(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var Nh="closure_lm_"+(1e6*Math.random()|0),Cl={};function T_(t,e,n,r,i){if(r&&r.once)return A_(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)T_(t,e[s],n,r,i);return null}return n=Mh(n),t&&t[Do]?t.O(e,n,Co(r)?!!r.capture:!!r,i):w_(t,e,n,!1,r,i)}function w_(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Co(i)?!!i.capture:!!i,a=kh(t);if(a||(t[Nh]=a=new Dc(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=u0(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)t0||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(S_(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function u0(){function t(n){return e.call(t.src,t.listener,n)}const e=h0;return t}function A_(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)A_(t,e[s],n,r,i);return null}return n=Mh(n),t&&t[Do]?t.P(e,n,Co(r)?!!r.capture:!!r,i):w_(t,e,n,!0,r,i)}function b_(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)b_(t,e[s],n,r,i);else r=Co(r)?!!r.capture:!!r,n=Mh(n),t&&t[Do]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=fu(s,n,r,i),-1<n&&(Cc(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=kh(t))&&(e=t.g[e.toString()],t=-1,e&&(t=fu(e,n,r,i)),(n=-1<t?e[t]:null)&&Oh(n))}function Oh(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Do])du(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(S_(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=kh(e))?(du(n,t),n.h==0&&(n.src=null,e[Nh]=null)):Cc(t)}}}function S_(t){return t in Cl?Cl[t]:Cl[t]="on"+t}function h0(t,e){if(t.fa)t=!0;else{e=new to(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Oh(t),t=n.call(r,e)}return t}function kh(t){return t=t[Nh],t instanceof Dc?t:null}var Dl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mh(t){return typeof t=="function"?t:(t[Dl]||(t[Dl]=function(e){return t.handleEvent(e)}),t[Dl])}function it(){fr.call(this),this.i=new Dc(this),this.S=this,this.J=null}st(it,fr);it.prototype[Do]=!0;it.prototype.removeEventListener=function(t,e,n,r){b_(this,t,e,n,r)};function ht(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new vt(e,t);else if(e instanceof vt)e.target=e.target||t;else{var i=e;e=new vt(r,t),E_(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=sa(o,r,!0,e)&&i}if(o=e.g=t,i=sa(o,r,!0,e)&&i,i=sa(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=sa(o,r,!1,e)&&i}it.prototype.N=function(){if(it.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Cc(n[r]);delete t.g[e],t.h--}}this.J=null};it.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};it.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function sa(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&du(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var Fh=ee.JSON.stringify;class d0{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function f0(){var t=Lh;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class p0{constructor(){this.h=this.g=null}add(e,n){const r=R_.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var R_=new d0(()=>new m0,t=>t.reset());class m0{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function g0(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function _0(t){ee.setTimeout(()=>{throw t},0)}let no,ro=!1,Lh=new p0,P_=()=>{const t=ee.Promise.resolve(void 0);no=()=>{t.then(y0)}};var y0=()=>{for(var t;t=f0();){try{t.h.call(t.g)}catch(n){_0(n)}var e=R_;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ro=!1};function xc(t,e){it.call(this),this.h=t||1,this.g=e||ee,this.j=yt(this.qb,this),this.l=Date.now()}st(xc,it);B=xc.prototype;B.ga=!1;B.T=null;B.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ht(this,"tick"),this.ga&&(Bh(this),this.start()))}};B.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Bh(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}B.N=function(){xc.$.N.call(this),Bh(this),delete this.g};function Uh(t,e,n){if(typeof t=="function")n&&(t=yt(t,n));else if(t&&typeof t.handleEvent=="function")t=yt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ee.setTimeout(t,e||0)}function C_(t){t.g=Uh(()=>{t.g=null,t.i&&(t.i=!1,C_(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class v0 extends fr{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:C_(this)}N(){super.N(),this.g&&(ee.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function io(t){fr.call(this),this.h=t,this.g={}}st(io,fr);var sp=[];function D_(t,e,n,r){Array.isArray(n)||(n&&(sp[0]=n.toString()),n=sp);for(var i=0;i<n.length;i++){var s=T_(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function x_(t){Vh(t.g,function(e,n){this.g.hasOwnProperty(n)&&Oh(e)},t),t.g={}}io.prototype.N=function(){io.$.N.call(this),x_(this)};io.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Vc(){this.g=!0}Vc.prototype.Ea=function(){this.g=!1};function I0(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function E0(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Ai(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+w0(t,n)+(r?" "+r:"")})}function T0(t,e){t.info(function(){return"TIMEOUT: "+e})}Vc.prototype.info=function(){};function w0(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Fh(n)}catch{return e}}var ii={},op=null;function Nc(){return op=op||new it}ii.Ta="serverreachability";function V_(t){vt.call(this,ii.Ta,t)}st(V_,vt);function so(t){const e=Nc();ht(e,new V_(e))}ii.STAT_EVENT="statevent";function N_(t,e){vt.call(this,ii.STAT_EVENT,t),this.stat=e}st(N_,vt);function At(t){const e=Nc();ht(e,new N_(e,t))}ii.Ua="timingevent";function O_(t,e){vt.call(this,ii.Ua,t),this.size=e}st(O_,vt);function xo(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ee.setTimeout(function(){t()},e)}var Oc={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},k_={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function $h(){}$h.prototype.h=null;function ap(t){return t.h||(t.h=t.i())}function M_(){}var Vo={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function qh(){vt.call(this,"d")}st(qh,vt);function Gh(){vt.call(this,"c")}st(Gh,vt);var pu;function kc(){}st(kc,$h);kc.prototype.g=function(){return new XMLHttpRequest};kc.prototype.i=function(){return{}};pu=new kc;function No(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new io(this),this.P=A0,t=lu?125:void 0,this.V=new xc(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new F_}function F_(){this.i=null,this.g="",this.h=!1}var A0=45e3,mu={},qa={};B=No.prototype;B.setTimeout=function(t){this.P=t};function gu(t,e,n){t.L=1,t.v=Fc(Rn(e)),t.s=n,t.S=!0,L_(t,null)}function L_(t,e){t.G=Date.now(),Oo(t),t.A=Rn(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),z_(n.i,"t",r),t.C=0,n=t.l.J,t.h=new F_,t.g=fy(t.l,n?e:null,!t.s),0<t.O&&(t.M=new v0(yt(t.Pa,t,t.g),t.O)),D_(t.U,t.g,"readystatechange",t.nb),e=t.I?I_(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),so(),I0(t.j,t.u,t.A,t.m,t.W,t.s)}B.nb=function(t){t=t.target;const e=this.M;e&&un(t)==3?e.l():this.Pa(t)};B.Pa=function(t){try{if(t==this.g)e:{const u=un(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>u)&&(u!=3||lu||this.g&&(this.h.h||this.g.ja()||hp(this.g)))){this.J||u!=4||e==7||(e==8||0>=h?so(3):so(2)),Mc(this);var n=this.g.da();this.ca=n;t:if(B_(this)){var r=hp(this.g);t="";var i=r.length,s=un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Mr(this),ks(this);var o="";break t}this.h.i=new ee.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,E0(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!eo(a)){var l=a;break t}}l=null}if(n=l)Ai(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,_u(this,n);else{this.i=!1,this.o=3,At(12),Mr(this),ks(this);break e}}this.S?(U_(this,u,o),lu&&this.i&&u==3&&(D_(this.U,this.V,"tick",this.mb),this.V.start())):(Ai(this.j,this.m,o,null),_u(this,o)),u==4&&Mr(this),this.i&&!this.J&&(u==4?ly(this.l,this):(this.i=!1,Oo(this)))}else K0(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,At(12)):(this.o=0,At(13)),Mr(this),ks(this)}}}catch{}finally{}};function B_(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function U_(t,e,n){let r=!0,i;for(;!t.J&&t.C<n.length;)if(i=b0(t,n),i==qa){e==4&&(t.o=4,At(14),r=!1),Ai(t.j,t.m,null,"[Incomplete Response]");break}else if(i==mu){t.o=4,At(15),Ai(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ai(t.j,t.m,i,null),_u(t,i);B_(t)&&i!=qa&&i!=mu&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,At(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qh(e),e.M=!0,At(11))):(Ai(t.j,t.m,n,"[Invalid Chunked Response]"),Mr(t),ks(t))}B.mb=function(){if(this.g){var t=un(this.g),e=this.g.ja();this.C<e.length&&(Mc(this),U_(this,t,e),this.i&&t!=4&&Oo(this))}};function b0(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?qa:(n=Number(e.substring(n,r)),isNaN(n)?mu:(r+=1,r+n>e.length?qa:(e=e.slice(r,r+n),t.C=r+n,e)))}B.cancel=function(){this.J=!0,Mr(this)};function Oo(t){t.Y=Date.now()+t.P,$_(t,t.P)}function $_(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=xo(yt(t.lb,t),e)}function Mc(t){t.B&&(ee.clearTimeout(t.B),t.B=null)}B.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(T0(this.j,this.A),this.L!=2&&(so(),At(17)),Mr(this),this.o=2,ks(this)):$_(this,this.Y-t)};function ks(t){t.l.H==0||t.J||ly(t.l,t)}function Mr(t){Mc(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Bh(t.V),x_(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function _u(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||yu(n.i,t))){if(!t.K&&yu(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Ka(n),Uc(n);else break e;Wh(n),At(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=xo(yt(n.ib,n),6e3));if(1>=Q_(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Fr(n,11)}else if((t.K||n.g==t)&&Ka(n),!eo(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],n.H==2)if(l[0]=="c"){n.K=l[1],n.pa=l[2];const u=l[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));const h=l[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const v=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(v){var s=r.i;s.g||v.indexOf("spdy")==-1&&v.indexOf("quic")==-1&&v.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(jh(s,s.h),s.h=null))}if(r.F){const I=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;I&&(r.Da=I,xe(r.I,r.F,I))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=dy(r,r.J?r.pa:null,r.Y),o.K){Y_(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.B&&(Mc(a),Oo(a)),r.g=o}else ay(r);0<n.j.length&&$c(n)}else l[0]!="stop"&&l[0]!="close"||Fr(n,7);else n.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Fr(n,7):Hh(n):l[0]!="noop"&&n.h&&n.h.Aa(l),n.A=0)}}so(4)}catch{}}function S0(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Rc(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function R0(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Rc(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function q_(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Rc(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=R0(t),r=S0(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var G_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function P0(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Gr(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Gr){this.h=t.h,Ga(this,t.j),this.s=t.s,this.g=t.g,ja(this,t.m),this.l=t.l;var e=t.i,n=new oo;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),cp(this,n),this.o=t.o}else t&&(e=String(t).match(G_))?(this.h=!1,Ga(this,e[1]||"",!0),this.s=Ps(e[2]||""),this.g=Ps(e[3]||"",!0),ja(this,e[4]),this.l=Ps(e[5]||"",!0),cp(this,e[6]||"",!0),this.o=Ps(e[7]||"")):(this.h=!1,this.i=new oo(null,this.h))}Gr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Cs(e,lp,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Cs(e,lp,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Cs(n,n.charAt(0)=="/"?x0:D0,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Cs(n,N0)),t.join("")};function Rn(t){return new Gr(t)}function Ga(t,e,n){t.j=n?Ps(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ja(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function cp(t,e,n){e instanceof oo?(t.i=e,O0(t.i,t.h)):(n||(e=Cs(e,V0)),t.i=new oo(e,t.h))}function xe(t,e,n){t.i.set(e,n)}function Fc(t){return xe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ps(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Cs(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,C0),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function C0(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var lp=/[#\/\?@]/g,D0=/[#\?:]/g,x0=/[#\?]/g,V0=/[#\?@]/g,N0=/#/g;function oo(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function pr(t){t.g||(t.g=new Map,t.h=0,t.i&&P0(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}B=oo.prototype;B.add=function(t,e){pr(this),this.i=null,t=is(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function j_(t,e){pr(t),e=is(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function K_(t,e){return pr(t),e=is(t,e),t.g.has(e)}B.forEach=function(t,e){pr(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};B.ta=function(){pr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};B.Z=function(t){pr(this);let e=[];if(typeof t=="string")K_(this,t)&&(e=e.concat(this.g.get(is(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};B.set=function(t,e){return pr(this),this.i=null,t=is(this,t),K_(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};B.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function z_(t,e,n){j_(t,e),0<n.length&&(t.i=null,t.g.set(is(t,e),Dh(n)),t.h+=n.length)}B.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function is(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function O0(t,e){e&&!t.j&&(pr(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(j_(this,r),z_(this,i,n))},t)),t.j=e}var k0=class{constructor(t,e){this.g=t,this.map=e}};function H_(t){this.l=t||M0,ee.PerformanceNavigationTiming?(t=ee.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ee.g&&ee.g.Ka&&ee.g.Ka()&&ee.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var M0=10;function W_(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Q_(t){return t.h?1:t.g?t.g.size:0}function yu(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function jh(t,e){t.g?t.g.add(e):t.h=e}function Y_(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}H_.prototype.cancel=function(){if(this.i=X_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function X_(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Dh(t.i)}var F0=class{stringify(t){return ee.JSON.stringify(t,void 0)}parse(t){return ee.JSON.parse(t,void 0)}};function L0(){this.g=new F0}function B0(t,e,n){const r=n||"";try{q_(t,function(i,s){let o=i;Co(i)&&(o=Fh(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function U0(t,e){const n=new Vc;if(ee.Image){const r=new Image;r.onload=ia(oa,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ia(oa,n,r,"TestLoadImage: error",!1,e),r.onabort=ia(oa,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ia(oa,n,r,"TestLoadImage: timeout",!1,e),ee.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function oa(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function ko(t){this.l=t.fc||null,this.j=t.ob||!1}st(ko,$h);ko.prototype.g=function(){return new Lc(this.l,this.j)};ko.prototype.i=function(t){return function(){return t}}({});function Lc(t,e){it.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Kh,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}st(Lc,it);var Kh=0;B=Lc.prototype;B.open=function(t,e){if(this.readyState!=Kh)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ao(this)};B.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ee).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};B.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Mo(this)),this.readyState=Kh};B.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ao(this)),this.g&&(this.readyState=3,ao(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ee.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;J_(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function J_(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}B.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Mo(this):ao(this),this.readyState==3&&J_(this)}};B.Za=function(t){this.g&&(this.response=this.responseText=t,Mo(this))};B.Ya=function(t){this.g&&(this.response=t,Mo(this))};B.ka=function(){this.g&&Mo(this)};function Mo(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ao(t)}B.setRequestHeader=function(t,e){this.v.append(t,e)};B.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};B.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function ao(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Lc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var $0=ee.JSON.parse;function Le(t){it.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Z_,this.L=this.M=!1}st(Le,it);var Z_="",q0=/^https?$/i,G0=["POST","PUT"];B=Le.prototype;B.Oa=function(t){this.M=t};B.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():pu.g(),this.C=this.u?ap(this.u):ap(pu),this.g.onreadystatechange=yt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){up(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=ee.FormData&&t instanceof ee.FormData,!(0<=g_(G0,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{ny(this),0<this.B&&((this.L=j0(this.g))?(this.g.timeout=this.B,this.g.ontimeout=yt(this.ua,this)):this.A=Uh(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){up(this,s)}};function j0(t){return Bi&&typeof t.timeout=="number"&&t.ontimeout!==void 0}B.ua=function(){typeof Ch<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ht(this,"timeout"),this.abort(8))};function up(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,ey(t),Bc(t)}function ey(t){t.F||(t.F=!0,ht(t,"complete"),ht(t,"error"))}B.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ht(this,"complete"),ht(this,"abort"),Bc(this))};B.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Bc(this,!0)),Le.$.N.call(this)};B.La=function(){this.s||(this.G||this.v||this.l?ty(this):this.kb())};B.kb=function(){ty(this)};function ty(t){if(t.h&&typeof Ch<"u"&&(!t.C[1]||un(t)!=4||t.da()!=2)){if(t.v&&un(t)==4)Uh(t.La,0,t);else if(ht(t,"readystatechange"),un(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(G_)[1]||null;!i&&ee.self&&ee.self.location&&(i=ee.self.location.protocol.slice(0,-1)),r=!q0.test(i?i.toLowerCase():"")}n=r}if(n)ht(t,"complete"),ht(t,"success");else{t.m=6;try{var s=2<un(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",ey(t)}}finally{Bc(t)}}}}function Bc(t,e){if(t.g){ny(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||ht(t,"ready");try{n.onreadystatechange=r}catch{}}}function ny(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ee.clearTimeout(t.A),t.A=null)}B.isActive=function(){return!!this.g};function un(t){return t.g?t.g.readyState:0}B.da=function(){try{return 2<un(this)?this.g.status:-1}catch{return-1}};B.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};B.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),$0(e)}};function hp(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Z_:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function K0(t){const e={};t=(t.g&&2<=un(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(eo(t[r]))continue;var n=g0(t[r]);const i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}l0(e,function(r){return r.join(", ")})}B.Ia=function(){return this.m};B.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function ry(t){let e="";return Vh(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function zh(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=ry(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):xe(t,e,n))}function _s(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function iy(t){this.Ga=0,this.j=[],this.l=new Vc,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=_s("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=_s("baseRetryDelayMs",5e3,t),this.hb=_s("retryDelaySeedMs",1e4,t),this.eb=_s("forwardChannelMaxRetries",2,t),this.xa=_s("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new H_(t&&t.concurrentRequestLimit),this.Ja=new L0,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}B=iy.prototype;B.ra=8;B.H=1;function Hh(t){if(sy(t),t.H==3){var e=t.W++,n=Rn(t.I);if(xe(n,"SID",t.K),xe(n,"RID",e),xe(n,"TYPE","terminate"),Fo(t,n),e=new No(t,t.l,e),e.L=2,e.v=Fc(Rn(n)),n=!1,ee.navigator&&ee.navigator.sendBeacon)try{n=ee.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&ee.Image&&(new Image().src=e.v,n=!0),n||(e.g=fy(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Oo(e)}hy(t)}function Uc(t){t.g&&(Qh(t),t.g.cancel(),t.g=null)}function sy(t){Uc(t),t.u&&(ee.clearTimeout(t.u),t.u=null),Ka(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ee.clearTimeout(t.m),t.m=null)}function $c(t){if(!W_(t.i)&&!t.m){t.m=!0;var e=t.Na;no||P_(),ro||(no(),ro=!0),Lh.add(e,t),t.C=0}}function z0(t,e){return Q_(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=xo(yt(t.Na,t,e),uy(t,t.C)),t.C++,!0)}B.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new No(this,this.l,t);let s=this.s;if(this.U&&(s?(s=I_(s),E_(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=oy(this,i,e),n=Rn(this.I),xe(n,"RID",t),xe(n,"CVER",22),this.F&&xe(n,"X-HTTP-Session-Id",this.F),Fo(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(ry(s)))+"&"+e:this.o&&zh(n,this.o,s)),jh(this.i,i),this.bb&&xe(n,"TYPE","init"),this.P?(xe(n,"$req",e),xe(n,"SID","null"),i.aa=!0,gu(i,n,null)):gu(i,n,e),this.H=2}}else this.H==3&&(t?dp(this,t):this.j.length==0||W_(this.i)||dp(this))};function dp(t,e){var n;e?n=e.m:n=t.W++;const r=Rn(t.I);xe(r,"SID",t.K),xe(r,"RID",n),xe(r,"AID",t.V),Fo(t,r),t.o&&t.s&&zh(r,t.o,t.s),n=new No(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=oy(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),jh(t.i,n),gu(n,r,e)}function Fo(t,e){t.na&&Vh(t.na,function(n,r){xe(e,r,n)}),t.h&&q_({},function(n,r){xe(e,r,n)})}function oy(t,e,n){n=Math.min(t.j.length,n);var r=t.h?yt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let l=i[c].g;const u=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{B0(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function ay(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;no||P_(),ro||(no(),ro=!0),Lh.add(e,t),t.A=0}}function Wh(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=xo(yt(t.Ma,t),uy(t,t.A)),t.A++,!0)}B.Ma=function(){if(this.u=null,cy(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=xo(yt(this.jb,this),t)}};B.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,At(10),Uc(this),cy(this))};function Qh(t){t.B!=null&&(ee.clearTimeout(t.B),t.B=null)}function cy(t){t.g=new No(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Rn(t.wa);xe(e,"RID","rpc"),xe(e,"SID",t.K),xe(e,"AID",t.V),xe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&xe(e,"TO",t.qa),xe(e,"TYPE","xmlhttp"),Fo(t,e),t.o&&t.s&&zh(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=Fc(Rn(e)),n.s=null,n.S=!0,L_(n,t)}B.ib=function(){this.v!=null&&(this.v=null,Uc(this),Wh(this),At(19))};function Ka(t){t.v!=null&&(ee.clearTimeout(t.v),t.v=null)}function ly(t,e){var n=null;if(t.g==e){Ka(t),Qh(t),t.g=null;var r=2}else if(yu(t.i,e))n=e.F,Y_(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;r=Nc(),ht(r,new O_(r,n)),$c(t)}else ay(t);else if(i=e.o,i==3||i==0&&0<e.ca||!(r==1&&z0(t,e)||r==2&&Wh(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Fr(t,5);break;case 4:Fr(t,10);break;case 3:Fr(t,6);break;default:Fr(t,2)}}}function uy(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Fr(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=yt(t.pb,t);n||(n=new Gr("//www.google.com/images/cleardot.gif"),ee.location&&ee.location.protocol=="http"||Ga(n,"https"),Fc(n)),U0(n.toString(),r)}else At(2);t.H=0,t.h&&t.h.za(e),hy(t),sy(t)}B.pb=function(t){t?(this.l.info("Successfully pinged google.com"),At(2)):(this.l.info("Failed to ping google.com"),At(1))};function hy(t){if(t.H=0,t.ma=[],t.h){const e=X_(t.i);(e.length!=0||t.j.length!=0)&&(np(t.ma,e),np(t.ma,t.j),t.i.i.length=0,Dh(t.j),t.j.length=0),t.h.ya()}}function dy(t,e,n){var r=n instanceof Gr?Rn(n):new Gr(n);if(r.g!="")e&&(r.g=e+"."+r.g),ja(r,r.m);else{var i=ee.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Gr(null);r&&Ga(s,r),e&&(s.g=e),i&&ja(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&xe(r,n,e),xe(r,"VER",t.ra),Fo(t,r),r}function fy(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new Le(new ko({ob:!0})):new Le(t.va),e.Oa(t.J),e}B.isActive=function(){return!!this.h&&this.h.isActive(this)};function py(){}B=py.prototype;B.Ba=function(){};B.Aa=function(){};B.za=function(){};B.ya=function(){};B.isActive=function(){return!0};B.Va=function(){};function za(){if(Bi&&!(10<=Number(s0)))throw Error("Environmental error: no available transport.")}za.prototype.g=function(t,e){return new Bt(t,e)};function Bt(t,e){it.call(this),this.g=new iy(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!eo(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!eo(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new ss(this)}st(Bt,it);Bt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;At(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=dy(t,null,t.Y),$c(t)};Bt.prototype.close=function(){Hh(this.g)};Bt.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Fh(t),t=n);e.j.push(new k0(e.fb++,t)),e.H==3&&$c(e)};Bt.prototype.N=function(){this.g.h=null,delete this.j,Hh(this.g),delete this.g,Bt.$.N.call(this)};function my(t){qh.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}st(my,qh);function gy(){Gh.call(this),this.status=1}st(gy,Gh);function ss(t){this.g=t}st(ss,py);ss.prototype.Ba=function(){ht(this.g,"a")};ss.prototype.Aa=function(t){ht(this.g,new my(t))};ss.prototype.za=function(t){ht(this.g,new gy)};ss.prototype.ya=function(){ht(this.g,"b")};function H0(){this.blockSize=-1}function Zt(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}st(Zt,H0);Zt.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function xl(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Zt.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)xl(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){xl(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){xl(this,r),i=0;break}}this.h=i,this.i+=e};Zt.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Te(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var W0={};function Yh(t){return-128<=t&&128>t?n0(t,function(e){return new Te([e|0],0>e?-1:0)}):new Te([t|0],0>t?-1:0)}function hn(t){if(isNaN(t)||!isFinite(t))return Vi;if(0>t)return lt(hn(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=vu;return new Te(e,0)}function _y(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return lt(_y(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=hn(Math.pow(e,8)),r=Vi,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=hn(Math.pow(e,s)),r=r.R(s).add(hn(o))):(r=r.R(n),r=r.add(hn(o)))}return r}var vu=4294967296,Vi=Yh(0),Iu=Yh(1),fp=Yh(16777216);B=Te.prototype;B.ea=function(){if(Gt(this))return-lt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:vu+r)*e,e*=vu}return t};B.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Tn(this))return"0";if(Gt(this))return"-"+lt(this).toString(t);for(var e=hn(Math.pow(t,6)),n=this,r="";;){var i=Wa(n,e).g;n=Ha(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Tn(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};B.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Tn(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Gt(t){return t.h==-1}B.X=function(t){return t=Ha(this,t),Gt(t)?-1:Tn(t)?0:1};function lt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Te(n,~t.h).add(Iu)}B.abs=function(){return Gt(this)?lt(this):this};B.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Te(n,n[n.length-1]&-2147483648?-1:0)};function Ha(t,e){return t.add(lt(e))}B.R=function(t){if(Tn(this)||Tn(t))return Vi;if(Gt(this))return Gt(t)?lt(this).R(lt(t)):lt(lt(this).R(t));if(Gt(t))return lt(this.R(lt(t)));if(0>this.X(fp)&&0>t.X(fp))return hn(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,aa(n,2*r+2*i),n[2*r+2*i+1]+=s*c,aa(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,aa(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,aa(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Te(n,0)};function aa(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function ys(t,e){this.g=t,this.h=e}function Wa(t,e){if(Tn(e))throw Error("division by zero");if(Tn(t))return new ys(Vi,Vi);if(Gt(t))return e=Wa(lt(t),e),new ys(lt(e.g),lt(e.h));if(Gt(e))return e=Wa(t,lt(e)),new ys(lt(e.g),e.h);if(30<t.g.length){if(Gt(t)||Gt(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Iu,r=e;0>=r.X(t);)n=pp(n),r=pp(r);var i=_i(n,1),s=_i(r,1);for(r=_i(r,2),n=_i(n,2);!Tn(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=_i(r,1),n=_i(n,1)}return e=Ha(t,i.R(e)),new ys(i,e)}for(i=Vi;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=hn(n),o=s.R(e);Gt(o)||0<o.X(t);)n-=r,s=hn(n),o=s.R(e);Tn(s)&&(s=Iu),i=i.add(s),t=Ha(t,o)}return new ys(i,t)}B.gb=function(t){return Wa(this,t).h};B.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Te(n,this.h&t.h)};B.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Te(n,this.h|t.h)};B.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Te(n,this.h^t.h)};function pp(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Te(n,t.h)}function _i(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Te(i,t.h)}za.prototype.createWebChannel=za.prototype.g;Bt.prototype.send=Bt.prototype.u;Bt.prototype.open=Bt.prototype.m;Bt.prototype.close=Bt.prototype.close;Oc.NO_ERROR=0;Oc.TIMEOUT=8;Oc.HTTP_ERROR=6;k_.COMPLETE="complete";M_.EventType=Vo;Vo.OPEN="a";Vo.CLOSE="b";Vo.ERROR="c";Vo.MESSAGE="d";it.prototype.listen=it.prototype.O;Le.prototype.listenOnce=Le.prototype.P;Le.prototype.getLastError=Le.prototype.Sa;Le.prototype.getLastErrorCode=Le.prototype.Ia;Le.prototype.getStatus=Le.prototype.da;Le.prototype.getResponseJson=Le.prototype.Wa;Le.prototype.getResponseText=Le.prototype.ja;Le.prototype.send=Le.prototype.ha;Le.prototype.setWithCredentials=Le.prototype.Oa;Zt.prototype.digest=Zt.prototype.l;Zt.prototype.reset=Zt.prototype.reset;Zt.prototype.update=Zt.prototype.j;Te.prototype.add=Te.prototype.add;Te.prototype.multiply=Te.prototype.R;Te.prototype.modulo=Te.prototype.gb;Te.prototype.compare=Te.prototype.X;Te.prototype.toNumber=Te.prototype.ea;Te.prototype.toString=Te.prototype.toString;Te.prototype.getBits=Te.prototype.D;Te.fromNumber=hn;Te.fromString=_y;var Q0=function(){return new za},Y0=function(){return Nc()},Vl=Oc,X0=k_,J0=ii,mp={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Z0=ko,ca=M_,eS=Le,tS=Zt,Ni=Te;const gp="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tt.UNAUTHENTICATED=new tt(null),tt.GOOGLE_CREDENTIALS=new tt("google-credentials-uid"),tt.FIRST_PARTY=new tt("first-party-uid"),tt.MOCK_USER=new tt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let os="10.1.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr=new Ah("@firebase/firestore");function Eu(){return rr.logLevel}function nS(t){rr.setLogLevel(t)}function P(t,...e){if(rr.logLevel<=de.DEBUG){const n=e.map(Xh);rr.debug(`Firestore (${os}): ${t}`,...n)}}function $e(t,...e){if(rr.logLevel<=de.ERROR){const n=e.map(Xh);rr.error(`Firestore (${os}): ${t}`,...n)}}function en(t,...e){if(rr.logLevel<=de.WARN){const n=e.map(Xh);rr.warn(`Firestore (${os}): ${t}`,...n)}}function Xh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $(t="Unexpected state"){const e=`FIRESTORE (${os}) INTERNAL ASSERTION FAILED: `+t;throw $e(e),new Error(e)}function K(t,e){t||$()}function rS(t,e){t||$()}function L(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class S extends ri{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(tt.UNAUTHENTICATED))}shutdown(){}}class sS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class oS{constructor(e){this.t=e,this.currentUser=tt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new rt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new rt,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{P("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(P("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new rt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(P("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(K(typeof r.accessToken=="string"),new yy(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return K(e===null||typeof e=="string"),new tt(e)}}class aS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=tt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class cS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new aS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(tt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{s.error!=null&&P("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,P("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{P("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):P("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(K(typeof n.token=="string"),this.R=n.token,new lS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{static V(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=hS(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function ne(t,e){return t<e?-1:t>e?1:0}function Ui(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function Iy(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new S(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new S(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new S(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new S(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ke.fromMillis(Date.now())}static fromDate(e){return ke.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ke(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e){this.timestamp=e}static fromTimestamp(e){return new j(e)}static min(){return new j(new ke(0,0))}static max(){return new j(new ke(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,n,r){n===void 0?n=0:n>e.length&&$(),r===void 0?r=e.length-n:r>e.length-n&&$(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return co.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof co?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class le extends co{construct(e,n,r){return new le(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new S(E.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new le(n)}static emptyPath(){return new le([])}}const dS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qe extends co{construct(e,n,r){return new qe(e,n,r)}static isValidIdentifier(e){return dS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new qe(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new S(E.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new S(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new S(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new S(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qe(n)}static emptyPath(){return new qe([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k{constructor(e){this.path=e}static fromPath(e){return new k(le.fromString(e))}static fromName(e){return new k(le.fromString(e).popFirst(5))}static empty(){return new k(le.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&le.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return le.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new k(new le(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Tu(t){return t.fields.find(e=>e.kind===2)}function br(t){return t.fields.filter(e=>e.kind!==2)}Ey.UNKNOWN_ID=-1;class fS{constructor(e,n){this.fieldPath=e,this.kind=n}}class Qa{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Qa(0,Ut.min())}}function Ty(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=j.fromTimestamp(r===1e9?new ke(n+1,0):new ke(n,r));return new Ut(i,k.empty(),e)}function wy(t){return new Ut(t.readTime,t.key,-1)}class Ut{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ut(j.min(),k.empty(),-1)}static max(){return new Ut(j.max(),k.empty(),-1)}}function Jh(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=k.comparator(t.documentKey,e.documentKey),n!==0?n:ne(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class by{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mr(t){if(t.code!==E.FAILED_PRECONDITION||t.message!==Ay)throw t;P("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new y((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof y?n:y.resolve(n)}catch(n){return y.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):y.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):y.reject(n)}static resolve(e){return new y((n,r)=>{n(e)})}static reject(e){return new y((n,r)=>{r(e)})}static waitFor(e){return new y((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=y.resolve(!1);for(const r of e)n=n.next(i=>i?y.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new y((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,n){return new y((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.m=new rt,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{n.error?this.m.reject(new Ms(e,n.error)):this.m.resolve()},this.transaction.onerror=r=>{const i=Zh(r.target.error);this.m.reject(new Ms(e,i))}}static open(e,n,r,i){try{return new qc(n,e.transaction(i,r))}catch(s){throw new Ms(n,s)}}get g(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(P("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}p(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new mS(n)}}class Yt{constructor(e,n,r){this.name=e,this.version=n,this.S=r,Yt.D(iu())===12.2&&$e("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return P("SimpleDb","Removing database:",e),Dr(window.indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!i_())return!1;if(Yt.C())return!0;const e=iu(),n=Yt.D(e),r=0<n&&n<10,i=Yt.F(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.M)==="YES"}static O(e,n){return e.store(n)}static D(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static F(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async N(e){return this.db||(P("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Ms(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new S(E.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new S(E.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ms(e,o))},i.onupgradeneeded=s=>{P("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.S.B(o,i.transaction,s.oldVersion,this.version).next(()=>{P("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.N(e);const a=qc.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.p(),l)).catch(l=>(a.abort(l),y.reject(l))).toPromise();return c.catch(()=>{}),await a.g,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(P("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class pS{constructor(e){this.q=e,this.K=!1,this.$=null}get isDone(){return this.K}get U(){return this.$}set cursor(e){this.q=e}done(){this.K=!0}W(e){this.$=e}delete(){return Dr(this.q.delete())}}class Ms extends S{constructor(e,n){super(E.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function gr(t){return t.name==="IndexedDbTransactionError"}class mS{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(P("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(P("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Dr(r)}add(e){return P("SimpleDb","ADD",this.store.name,e,e),Dr(this.store.add(e))}get(e){return Dr(this.store.get(e)).next(n=>(n===void 0&&(n=null),P("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return P("SimpleDb","DELETE",this.store.name,e),Dr(this.store.delete(e))}count(){return P("SimpleDb","COUNT",this.store.name),Dr(this.store.count())}G(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.j(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new y((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}H(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new y((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}J(e,n){P("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const i=this.cursor(r);return this.j(i,(s,o,a)=>a.delete())}Z(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.j(i,n)}X(e){const n=this.cursor({});return new y((r,i)=>{n.onerror=s=>{const o=Zh(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}j(e,n){const r=[];return new y((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const c=new pS(a),l=n(a.primaryKey,a.value,c);if(l instanceof y){const u=l.catch(h=>(c.done(),y.reject(h)));r.push(u)}c.isDone?i():c.U===null?a.continue():a.continue(c.U)}}).next(()=>y.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Dr(t){return new y((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Zh(r.target.error);n(i)}})}let _p=!1;function Zh(t){const e=Yt.D(iu());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new S("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _p||(_p=!0,setTimeout(()=>{throw r},0)),r}}return t}class gS{constructor(e,n){this.asyncQueue=e,this.ee=n,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}te(e){P("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{P("IndexBackiller",`Documents written: ${await this.ee.ne()}`)}catch(n){gr(n)?P("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await mr(n)}await this.te(6e4)})}}class _S{constructor(e,n){this.localStore=e,this.persistence=n}async ne(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.re(n,e))}re(e,n){const r=new Set;let i=n,s=!0;return y.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return P("IndexBackiller",`Processing collection: ${o}`),this.ie(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ie(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.se(i,s)).next(a=>(P("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}se(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=wy(s);Jh(o,r)>0&&(r=o)}),new Ut(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.oe(r),this._e=r=>n.writeSequenceNumber(r))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Dt.ae=-1;function Lo(t){return t==null}function lo(t){return t===0&&1/t==-1/0}function Sy(t){return typeof t=="number"&&Number.isInteger(t)&&!lo(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=yp(e)),e=yS(t.get(n),e);return yp(e)}function yS(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function yp(t){return t+""}function dn(t){const e=t.length;if(K(e>=2),e===2)return K(t.charAt(0)===""&&t.charAt(1)===""),le.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&$(),t.charAt(o+1)){case"":const a=t.substring(s,o);let c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:$()}s=o+2}return new le(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ta(t,e){return[t,bt(e)]}function Ry(t,e,n){return[t,bt(e),n]}const vS={},IS=["prefixPath","collectionGroup","readTime","documentId"],ES=["prefixPath","collectionGroup","documentId"],TS=["collectionGroup","readTime","prefixPath","documentId"],wS=["canonicalId","targetId"],AS=["targetId","path"],bS=["path","targetId"],SS=["collectionId","parent"],RS=["indexId","uid"],PS=["uid","sequenceNumber"],CS=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],DS=["indexId","uid","orderedDocumentKey"],xS=["userId","collectionPath","documentId"],VS=["userId","collectionPath","largestBatchId"],NS=["userId","collectionGroup","largestBatchId"],Py=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],OS=[...Py,"documentOverlays"],Cy=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Dy=Cy,kS=[...Dy,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends by{constructor(e,n){super(),this.ue=e,this.currentSequenceNumber=n}}function ot(t,e){const n=L(t);return Yt.O(n.ue,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function si(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xy(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e,n){this.comparator=e,this.root=n||ct.EMPTY}insert(e,n){return new Ce(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ct.BLACK,null,null))}remove(e){return new Ce(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ct.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new la(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new la(this.root,e,this.comparator,!1)}getReverseIterator(){return new la(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new la(this.root,e,this.comparator,!0)}}class la{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ct{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??ct.RED,this.left=i??ct.EMPTY,this.right=s??ct.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new ct(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ct.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return ct.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ct.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ct.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();const e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}}ct.EMPTY=null,ct.RED=!0,ct.BLACK=!1;ct.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,n,r,i,s){return this}insert(e,n,r){return new ct(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.comparator=e,this.data=new Ce(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ep(this.data.getIterator())}getIteratorFrom(e){return new Ep(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ne)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ne(this.comparator);return n.data=e,n}}class Ep{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function yi(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.fields=e,e.sort(qe.comparator)}static empty(){return new xt([])}unionWith(e){let n=new Ne(qe.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new xt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ui(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Vy("Invalid base64 string: "+s):s}}(e);return new Ze(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Ze(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ze.EMPTY_BYTE_STRING=new Ze("");const FS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ir(t){if(K(!!t),typeof t=="string"){let e=0;const n=FS.exec(t);if(K(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Fe(t.seconds),nanos:Fe(t.nanos)}}function Fe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function sr(t){return typeof t=="string"?Ze.fromBase64String(t):Ze.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gc(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ed(t){const e=t.mapValue.fields.__previous_value__;return Gc(e)?ed(e):e}function uo(t){const e=ir(t.mapValue.fields.__local_write_time__.timestampValue);return new ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,n,r,i,s,o,a,c,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class or{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new or("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof or&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},wa={nullValue:"NULL_VALUE"};function Hr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Gc(t)?4:Ny(t)?9007199254740991:10:$()}function gn(t,e){if(t===e)return!0;const n=Hr(t);if(n!==Hr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return uo(t).isEqual(uo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ir(i.timestampValue),a=ir(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return sr(i.bytesValue).isEqual(sr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Fe(i.geoPointValue.latitude)===Fe(s.geoPointValue.latitude)&&Fe(i.geoPointValue.longitude)===Fe(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Fe(i.integerValue)===Fe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Fe(i.doubleValue),a=Fe(s.doubleValue);return o===a?lo(o)===lo(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ui(t.arrayValue.values||[],e.arrayValue.values||[],gn);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Ip(o)!==Ip(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!gn(o[c],a[c])))return!1;return!0}(t,e);default:return $()}}function ho(t,e){return(t.values||[]).find(n=>gn(n,e))!==void 0}function ar(t,e){if(t===e)return 0;const n=Hr(t),r=Hr(e);if(n!==r)return ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ne(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Fe(s.integerValue||s.doubleValue),c=Fe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return Tp(t.timestampValue,e.timestampValue);case 4:return Tp(uo(t),uo(e));case 5:return ne(t.stringValue,e.stringValue);case 6:return function(s,o){const a=sr(s),c=sr(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){const u=ne(a[l],c[l]);if(u!==0)return u}return ne(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ne(Fe(s.latitude),Fe(o.latitude));return a!==0?a:ne(Fe(s.longitude),Fe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){const u=ar(a[l],c[l]);if(u)return u}return ne(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Hn.mapValue&&o===Hn.mapValue)return 0;if(s===Hn.mapValue)return 1;if(o===Hn.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const d=ne(c[h],u[h]);if(d!==0)return d;const f=ar(a[c[h]],l[u[h]]);if(f!==0)return f}return ne(c.length,u.length)}(t.mapValue,e.mapValue);default:throw $()}}function Tp(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ne(t,e);const n=ir(t),r=ir(e),i=ne(n.seconds,r.seconds);return i!==0?i:ne(n.nanos,r.nanos)}function $i(t){return Au(t)}function Au(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ir(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return sr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return k.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Au(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Au(n.fields[o])}`;return i+"}"}(t.mapValue):$()}function Wr(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function bu(t){return!!t&&"integerValue"in t}function fo(t){return!!t&&"arrayValue"in t}function wp(t){return!!t&&"nullValue"in t}function Ap(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Aa(t){return!!t&&"mapValue"in t}function Fs(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return si(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Fs(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fs(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ny(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function BS(t){return"nullValue"in t?wa:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Wr(or.empty(),k.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:$()}function US(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Wr(or.empty(),k.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Hn:$()}function bp(t,e){const n=ar(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Sp(t,e){const n=ar(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.value=e}static empty(){return new ut({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Aa(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fs(n)}setAll(e){let n=qe.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Fs(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Aa(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return gn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Aa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){si(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new ut(Fs(this.value))}}function Oy(t){const e=[];return si(t.fields,(n,r)=>{const i=new qe([n]);if(Aa(r)){const s=Oy(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new xt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ve(e,0,j.min(),j.min(),j.min(),ut.empty(),0)}static newFoundDocument(e,n,r,i){return new Ve(e,1,n,j.min(),r,i,0)}static newNoDocument(e,n){return new Ve(e,2,n,j.min(),j.min(),ut.empty(),0)}static newUnknownDocument(e,n){return new Ve(e,3,n,j.min(),j.min(),ut.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ve&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ve(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e,n){this.position=e,this.inclusive=n}}function Rp(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=k.comparator(k.fromName(o.referenceValue),n.key):r=ar(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Pp(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!gn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,n="asc"){this.field=e,this.dir=n}}function $S(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{}class oe extends ky{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new qS(e,n,r):n==="array-contains"?new KS(e,r):n==="in"?new $y(e,r):n==="not-in"?new zS(e,r):n==="array-contains-any"?new HS(e,r):new oe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new GS(e,r):new jS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ar(n,this.value)):n!==null&&Hr(this.value)===Hr(n)&&this.matchesComparison(ar(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Ee extends ky{constructor(e,n){super(),this.filters=e,this.op=n,this.ce=null}static create(e,n){return new Ee(e,n)}matches(e){return qi(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.le(n=>n.isInequality());return e!==null?e.field:null}le(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function qi(t){return t.op==="and"}function Su(t){return t.op==="or"}function td(t){return My(t)&&qi(t)}function My(t){for(const e of t.filters)if(e instanceof Ee)return!1;return!0}function Ru(t){if(t instanceof oe)return t.field.canonicalString()+t.op.toString()+$i(t.value);if(td(t))return t.filters.map(e=>Ru(e)).join(",");{const e=t.filters.map(n=>Ru(n)).join(",");return`${t.op}(${e})`}}function Fy(t,e){return t instanceof oe?function(r,i){return i instanceof oe&&r.op===i.op&&r.field.isEqual(i.field)&&gn(r.value,i.value)}(t,e):t instanceof Ee?function(r,i){return i instanceof Ee&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&Fy(o,i.filters[a]),!0):!1}(t,e):void $()}function Ly(t,e){const n=t.filters.concat(e);return Ee.create(n,t.op)}function By(t){return t instanceof oe?function(n){return`${n.field.canonicalString()} ${n.op} ${$i(n.value)}`}(t):t instanceof Ee?function(n){return n.op.toString()+" {"+n.getFilters().map(By).join(" ,")+"}"}(t):"Filter"}class qS extends oe{constructor(e,n,r){super(e,n,r),this.key=k.fromName(r.referenceValue)}matches(e){const n=k.comparator(e.key,this.key);return this.matchesComparison(n)}}class GS extends oe{constructor(e,n){super(e,"in",n),this.keys=Uy("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class jS extends oe{constructor(e,n){super(e,"not-in",n),this.keys=Uy("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Uy(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>k.fromName(r.referenceValue))}class KS extends oe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return fo(n)&&ho(n.arrayValue,this.value)}}class $y extends oe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ho(this.value.arrayValue,n)}}class zS extends oe{constructor(e,n){super(e,"not-in",n)}matches(e){if(ho(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!ho(this.value.arrayValue,n)}}class HS extends oe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!fo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ho(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.he=null}}function Pu(t,e=null,n=[],r=[],i=null,s=null,o=null){return new WS(t,e,n,r,i,s,o)}function Qr(t){const e=L(t);if(e.he===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ru(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Lo(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>$i(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>$i(r)).join(",")),e.he=n}return e.he}function Bo(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!$S(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Fy(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Pp(t.startAt,e.startAt)&&Pp(t.endAt,e.endAt)}function Ya(t){return k.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Xa(t,e){return t.filters.filter(n=>n instanceof oe&&n.field.isEqual(e))}function Cp(t,e,n){let r=wa,i=!0;for(const s of Xa(t,e)){let o=wa,a=!0;switch(s.op){case"<":case"<=":o=BS(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=wa}bp({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];bp({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function Dp(t,e,n){let r=Hn,i=!0;for(const s of Xa(t,e)){let o=Hn,a=!0;switch(s.op){case">=":case">":o=US(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Hn}Sp({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Sp({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Pe=null,this.Ie=null,this.startAt,this.endAt}}function qy(t,e,n,r,i,s,o,a){return new Dn(t,e,n,r,i,s,o,a)}function as(t){return new Dn(t)}function xp(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function nd(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function jc(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function rd(t){return t.collectionGroup!==null}function jr(t){const e=L(t);if(e.Pe===null){e.Pe=[];const n=jc(e),r=nd(e);if(n!==null&&r===null)n.isKeyField()||e.Pe.push(new Oi(n)),e.Pe.push(new Oi(qe.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.Pe.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.Pe.push(new Oi(qe.keyField(),s))}}}return e.Pe}function Ot(t){const e=L(t);if(!e.Ie)if(e.limitType==="F")e.Ie=Pu(e.path,e.collectionGroup,jr(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const s of jr(e)){const o=s.dir==="desc"?"asc":"desc";n.push(new Oi(s.field,o))}const r=e.endAt?new cr(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new cr(e.startAt.position,e.startAt.inclusive):null;e.Ie=Pu(e.path,e.collectionGroup,n,e.filters,e.limit,r,i)}return e.Ie}function Cu(t,e){e.getFirstInequalityField(),jc(t);const n=t.filters.concat([e]);return new Dn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ja(t,e,n){return new Dn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Uo(t,e){return Bo(Ot(t),Ot(e))&&t.limitType===e.limitType}function Gy(t){return`${Qr(Ot(t))}|lt:${t.limitType}`}function Du(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>By(i)).join(", ")}]`),Lo(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>$i(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>$i(i)).join(",")),`Target(${r})`}(Ot(t))}; limitType=${t.limitType})`}function $o(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):k.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of jr(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){const l=Rp(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,jr(r),i)||r.endAt&&!function(o,a,c){const l=Rp(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,jr(r),i))}(t,e)}function jy(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Ky(t){return(e,n)=>{let r=!1;for(const i of jr(t)){const s=QS(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function QS(t,e,n){const r=t.field.isKeyField()?k.comparator(e.key,n.key):function(s,o,a){const c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?ar(c,l):$()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){si(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return xy(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS=new Ce(k.comparator);function Vt(){return YS}const zy=new Ce(k.comparator);function Ds(...t){let e=zy;for(const n of t)e=e.insert(n.key,n);return e}function Hy(t){let e=zy;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function fn(){return Ls()}function Wy(){return Ls()}function Ls(){return new _r(t=>t.toString(),(t,e)=>t.isEqual(e))}const XS=new Ce(k.comparator),JS=new Ne(k.comparator);function re(...t){let e=JS;for(const n of t)e=e.add(n);return e}const ZS=new Ne(ne);function id(){return ZS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lo(e)?"-0":e}}function Yy(t){return{integerValue:""+t}}function Xy(t,e){return Sy(e)?Yy(e):Qy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(){this._=void 0}}function eR(t,e,n){return t instanceof Gi?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Gc(s)&&(s=ed(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Yr?Zy(t,e):t instanceof Xr?ev(t,e):function(i,s){const o=Jy(i,s),a=Vp(o)+Vp(i.Te);return bu(o)&&bu(i.Te)?Yy(a):Qy(i.serializer,a)}(t,e)}function tR(t,e,n){return t instanceof Yr?Zy(t,e):t instanceof Xr?ev(t,e):n}function Jy(t,e){return t instanceof ji?function(r){return bu(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Gi extends Kc{}class Yr extends Kc{constructor(e){super(),this.elements=e}}function Zy(t,e){const n=tv(e);for(const r of t.elements)n.some(i=>gn(i,r))||n.push(r);return{arrayValue:{values:n}}}class Xr extends Kc{constructor(e){super(),this.elements=e}}function ev(t,e){let n=tv(e);for(const r of t.elements)n=n.filter(i=>!gn(i,r));return{arrayValue:{values:n}}}class ji extends Kc{constructor(e,n){super(),this.serializer=e,this.Te=n}}function Vp(t){return Fe(t.integerValue||t.doubleValue)}function tv(t){return fo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,n){this.field=e,this.transform=n}}function nR(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Yr&&i instanceof Yr||r instanceof Xr&&i instanceof Xr?Ui(r.elements,i.elements,gn):r instanceof ji&&i instanceof ji?gn(r.Te,i.Te):r instanceof Gi&&i instanceof Gi}(t.transform,e.transform)}class rR{constructor(e,n){this.version=e,this.transformResults=n}}class Oe{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Oe}static exists(e){return new Oe(void 0,e)}static updateTime(e){return new Oe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ba(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class zc{}function nv(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ls(t.key,Oe.none()):new cs(t.key,t.data,Oe.none());{const n=t.data,r=ut.empty();let i=new Ne(qe.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new xn(t.key,r,new xt(i.toArray()),Oe.none())}}function iR(t,e,n){t instanceof cs?function(i,s,o){const a=i.value.clone(),c=Op(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof xn?function(i,s,o){if(!ba(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Op(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(rv(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Bs(t,e,n,r){return t instanceof cs?function(s,o,a,c){if(!ba(s.precondition,o))return a;const l=s.value.clone(),u=kp(s.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof xn?function(s,o,a,c){if(!ba(s.precondition,o))return a;const l=kp(s.fieldTransforms,c,o),u=o.data;return u.setAll(rv(s)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return ba(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function sR(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Jy(r.transform,i||null);s!=null&&(n===null&&(n=ut.empty()),n.set(r.field,s))}return n||null}function Np(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ui(r,i,(s,o)=>nR(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class cs extends zc{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class xn extends zc{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function rv(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Op(t,e,n){const r=new Map;K(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,tR(o,a,n[i]))}return r}function kp(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,eR(s,o,e))}return r}class ls extends zc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sd extends zc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&iR(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Bs(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Bs(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Wy();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const c=nv(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(j.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),re())}isEqual(e){return this.batchId===e.batchId&&Ui(this.mutations,e.mutations,(n,r)=>Np(n,r))&&Ui(this.baseMutations,e.baseMutations,(n,r)=>Np(n,r))}}class ad{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){K(e.mutations.length===r.length);let i=function(){return XS}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new ad(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze,ce;function iv(t){switch(t){default:return $();case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0}}function sv(t){if(t===void 0)return $e("GRPC error has no .code"),E.UNKNOWN;switch(t){case ze.OK:return E.OK;case ze.CANCELLED:return E.CANCELLED;case ze.UNKNOWN:return E.UNKNOWN;case ze.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case ze.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case ze.INTERNAL:return E.INTERNAL;case ze.UNAVAILABLE:return E.UNAVAILABLE;case ze.UNAUTHENTICATED:return E.UNAUTHENTICATED;case ze.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case ze.NOT_FOUND:return E.NOT_FOUND;case ze.ALREADY_EXISTS:return E.ALREADY_EXISTS;case ze.PERMISSION_DENIED:return E.PERMISSION_DENIED;case ze.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case ze.ABORTED:return E.ABORTED;case ze.OUT_OF_RANGE:return E.OUT_OF_RANGE;case ze.UNIMPLEMENTED:return E.UNIMPLEMENTED;case ze.DATA_LOSS:return E.DATA_LOSS;default:return $()}}(ce=ze||(ze={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return ua}static getOrCreateInstance(){return ua===null&&(ua=new ld),ua}onExistenceFilterMismatch(e){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(e))}}let ua=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ov(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR=new Ni([4294967295,4294967295],0);function Mp(t){const e=ov().encode(t),n=new tS;return n.update(e),new Uint8Array(n.digest())}function Fp(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ni([n,r],0),new Ni([i,s],0)]}class ud{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new xs(`Invalid padding: ${n}`);if(r<0)throw new xs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new xs(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new xs(`Invalid padding when bitmap length is 0: ${n}`);this.de=8*e.length-n,this.Ae=Ni.fromNumber(this.de)}Re(e,n,r){let i=e.add(n.multiply(Ni.fromNumber(r)));return i.compare(aR)===1&&(i=new Ni([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ae).toNumber()}Ve(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.de===0)return!1;const n=Mp(e),[r,i]=Fp(n);for(let s=0;s<this.hashCount;s++){const o=this.Re(r,i,s);if(!this.Ve(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new ud(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.de===0)return;const n=Mp(e),[r,i]=Fp(n);for(let s=0;s<this.hashCount;s++){const o=this.Re(r,i,s);this.me(o)}}me(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class xs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,jo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Go(j.min(),i,new Ce(ne),Vt(),re())}}class jo{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new jo(r,n,re(),re(),re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e,n,r,i){this.fe=e,this.removedTargetIds=n,this.key=r,this.ge=i}}class av{constructor(e,n){this.targetId=e,this.pe=n}}class cv{constructor(e,n,r=Ze.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Lp{constructor(){this.ye=0,this.we=Up(),this.Se=Ze.EMPTY_BYTE_STRING,this.be=!1,this.De=!0}get current(){return this.be}get resumeToken(){return this.Se}get ve(){return this.ye!==0}get Ce(){return this.De}Fe(e){e.approximateByteSize()>0&&(this.De=!0,this.Se=e)}Me(){let e=re(),n=re(),r=re();return this.we.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:$()}}),new jo(this.Se,this.be,e,n,r)}xe(){this.De=!1,this.we=Up()}Oe(e,n){this.De=!0,this.we=this.we.insert(e,n)}Ne(e){this.De=!0,this.we=this.we.remove(e)}Be(){this.ye+=1}Le(){this.ye-=1}ke(){this.De=!0,this.be=!0}}class cR{constructor(e){this.qe=e,this.Qe=new Map,this.Ke=Vt(),this.$e=Bp(),this.Ue=new Ce(ne)}We(e){for(const n of e.fe)e.ge&&e.ge.isFoundDocument()?this.Ge(n,e.ge):this.ze(n,e.key,e.ge);for(const n of e.removedTargetIds)this.ze(n,e.key,e.ge)}je(e){this.forEachTarget(e,n=>{const r=this.He(n);switch(e.state){case 0:this.Je(n)&&r.Fe(e.resumeToken);break;case 1:r.Le(),r.ve||r.xe(),r.Fe(e.resumeToken);break;case 2:r.Le(),r.ve||this.removeTarget(n);break;case 3:this.Je(n)&&(r.ke(),r.Fe(e.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),r.Fe(e.resumeToken));break;default:$()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Qe.forEach((r,i)=>{this.Je(i)&&n(i)})}Ze(e){var n,r;const i=e.targetId,s=e.pe.count,o=this.Xe(i);if(o){const a=o.target;if(Ya(a))if(s===0){const c=new k(a.path);this.ze(i,c,Ve.newNoDocument(c,j.min()))}else K(s===1);else{const c=this.et(i);if(c!==s){const l=this.tt(e,c);if(l.status!==0){this.Ye(i);const u=l.status===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(i,u)}(n=ld.instance)===null||n===void 0||n.notifyOnExistenceFilterMismatch(function(h,d,f,v){var I,T,R,x,O,V;const W={localCacheCount:f,existenceFilterCount:v.count},J=v.unchangedNames;return J&&(W.bloomFilter={applied:h===0,hashCount:(I=J==null?void 0:J.hashCount)!==null&&I!==void 0?I:0,bitmapLength:(x=(R=(T=J==null?void 0:J.bits)===null||T===void 0?void 0:T.bitmap)===null||R===void 0?void 0:R.length)!==null&&x!==void 0?x:0,padding:(V=(O=J==null?void 0:J.bits)===null||O===void 0?void 0:O.padding)!==null&&V!==void 0?V:0},d&&(W.bloomFilter.mightContain=d)),W}(l.status,(r=l.nt)!==null&&r!==void 0?r:null,c,e.pe))}}}}tt(e,n){const{unchangedNames:r,count:i}=e.pe;if(!r||!r.bits)return{status:1};const{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=r;let c,l;try{c=sr(s).toUint8Array()}catch(h){if(h instanceof Vy)return en("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),{status:1};throw h}try{l=new ud(c,o,a)}catch(h){return en(h instanceof xs?"BloomFilter error: ":"Applying bloom filter failed: ",h),{status:1}}const u=h=>{const d=this.qe.rt();return l.mightContain(`projects/${d.projectId}/databases/${d.database}/documents/${h}`)};return l.de===0?{status:1}:{status:i===n-this.it(e.targetId,u)?0:2,nt:u}}it(e,n){const r=this.qe.getRemoteKeysForTarget(e);let i=0;return r.forEach(s=>{n(s.path.canonicalString())||(this.ze(e,s,null),i++)}),i}st(e){const n=new Map;this.Qe.forEach((s,o)=>{const a=this.Xe(o);if(a){if(s.current&&Ya(a.target)){const c=new k(a.target.path);this.Ke.get(c)!==null||this.ot(o,c)||this.ze(o,c,Ve.newNoDocument(c,e))}s.Ce&&(n.set(o,s.Me()),s.xe())}});let r=re();this.$e.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Xe(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.Ke.forEach((s,o)=>o.setReadTime(e));const i=new Go(e,n,this.Ue,this.Ke,r);return this.Ke=Vt(),this.$e=Bp(),this.Ue=new Ce(ne),i}Ge(e,n){if(!this.Je(e))return;const r=this.ot(e,n.key)?2:0;this.He(e).Oe(n.key,r),this.Ke=this.Ke.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(e))}ze(e,n,r){if(!this.Je(e))return;const i=this.He(e);this.ot(e,n)?i.Oe(n,1):i.Ne(n),this.$e=this.$e.insert(n,this._t(n).delete(e)),r&&(this.Ke=this.Ke.insert(n,r))}removeTarget(e){this.Qe.delete(e)}et(e){const n=this.He(e).Me();return this.qe.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Be(e){this.He(e).Be()}He(e){let n=this.Qe.get(e);return n||(n=new Lp,this.Qe.set(e,n)),n}_t(e){let n=this.$e.get(e);return n||(n=new Ne(ne),this.$e=this.$e.insert(e,n)),n}Je(e){const n=this.Xe(e)!==null;return n||P("WatchChangeAggregator","Detected inactive target",e),n}Xe(e){const n=this.Qe.get(e);return n&&n.ve?null:this.qe.ut(e)}Ye(e){this.Qe.set(e,new Lp),this.qe.getRemoteKeysForTarget(e).forEach(n=>{this.ze(e,n,null)})}ot(e,n){return this.qe.getRemoteKeysForTarget(e).has(n)}}function Bp(){return new Ce(k.comparator)}function Up(){return new Ce(k.comparator)}const lR=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),uR=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),hR=(()=>({and:"AND",or:"OR"}))();class dR{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function xu(t,e){return t.useProto3Json||Lo(e)?e:{value:e}}function Ki(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function lv(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function fR(t,e){return Ki(t,e.toTimestamp())}function Ge(t){return K(!!t),j.fromTimestamp(function(n){const r=ir(n);return new ke(r.seconds,r.nanos)}(t))}function hd(t,e){return function(r){return new le(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function uv(t){const e=le.fromString(t);return K(vv(e)),e}function po(t,e){return hd(t.databaseId,e.path)}function pn(t,e){const n=uv(e);if(n.get(1)!==t.databaseId.projectId)throw new S(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new S(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new k(dv(n))}function Vu(t,e){return hd(t.databaseId,e)}function hv(t){const e=uv(t);return e.length===4?le.emptyPath():dv(e)}function mo(t){return new le(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function dv(t){return K(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function $p(t,e,n){return{name:po(t,e),fields:n.value.mapValue.fields}}function fv(t,e,n){const r=pn(t,e.name),i=Ge(e.updateTime),s=e.createTime?Ge(e.createTime):j.min(),o=new ut({mapValue:{fields:e.fields}}),a=Ve.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function pR(t,e){return"found"in e?function(r,i){K(!!i.found),i.found.name,i.found.updateTime;const s=pn(r,i.found.name),o=Ge(i.found.updateTime),a=i.found.createTime?Ge(i.found.createTime):j.min(),c=new ut({mapValue:{fields:i.found.fields}});return Ve.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){K(!!i.missing),K(!!i.readTime);const s=pn(r,i.missing),o=Ge(i.readTime);return Ve.newNoDocument(s,o)}(t,e):$()}function mR(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(K(u===void 0||typeof u=="string"),Ze.fromBase64String(u||"")):(K(u===void 0||u instanceof Uint8Array),Ze.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const u=l.code===void 0?E.UNKNOWN:sv(l.code);return new S(u,l.message||"")}(o);n=new cv(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=pn(t,r.document.name),s=Ge(r.document.updateTime),o=r.document.createTime?Ge(r.document.createTime):j.min(),a=new ut({mapValue:{fields:r.document.fields}}),c=Ve.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new Sa(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=pn(t,r.document),s=r.readTime?Ge(r.readTime):j.min(),o=Ve.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Sa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=pn(t,r.document),s=r.removedTargetIds||[];n=new Sa([],s,i,null)}else{if(!("filter"in e))return $();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new oR(i,s),a=r.targetId;n=new av(a,o)}}return n}function go(t,e){let n;if(e instanceof cs)n={update:$p(t,e.key,e.value)};else if(e instanceof ls)n={delete:po(t,e.key)};else if(e instanceof xn)n={update:$p(t,e.key,e.data),updateMask:ER(e.fieldMask)};else{if(!(e instanceof sd))return $();n={verify:po(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Gi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Yr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Xr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ji)return{fieldPath:o.field.canonicalString(),increment:a.Te};throw $()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:fR(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:$()}(t,e.precondition)),n}function Nu(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Oe.updateTime(Ge(s.updateTime)):s.exists!==void 0?Oe.exists(s.exists):Oe.none()}(e.currentDocument):Oe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)K(a.setToServerValue==="REQUEST_TIME"),c=new Gi;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];c=new Yr(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];c=new Xr(u)}else"increment"in a?c=new ji(o,a.increment):$();const l=qe.fromServerFormat(a.fieldPath);return new qo(l,c)}(t,i)):[];if(e.update){e.update.name;const i=pn(t,e.update.name),s=new ut({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const l=c.fieldPaths||[];return new xt(l.map(u=>qe.fromServerFormat(u)))}(e.updateMask);return new xn(i,s,o,n,r)}return new cs(i,s,n,r)}if(e.delete){const i=pn(t,e.delete);return new ls(i,n)}if(e.verify){const i=pn(t,e.verify);return new sd(i,n)}return $()}function gR(t,e){return t&&t.length>0?(K(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Ge(i.updateTime):Ge(s);return o.isEqual(j.min())&&(o=Ge(s)),new rR(o,i.transformResults||[])}(n,e))):[]}function pv(t,e){return{documents:[Vu(t,e.path)]}}function mv(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Vu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Vu(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(c){if(c.length!==0)return yv(Ee.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:Ii(h.field),direction:yR(h.dir)}}(l))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=xu(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function gv(t){let e=hv(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){K(r===1);const u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=function(h){const d=_v(h);return d instanceof Ee&&td(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(d=>function(v){return new Oi(Ei(v.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(d))}(n.orderBy));let a=null;n.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,Lo(d)?null:d}(n.limit));let c=null;n.startAt&&(c=function(h){const d=!!h.before,f=h.values||[];return new cr(f,d)}(n.startAt));let l=null;return n.endAt&&(l=function(h){const d=!h.before,f=h.values||[];return new cr(f,d)}(n.endAt)),qy(e,i,o,s,a,"F",c,l)}function _R(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function _v(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ei(n.unaryFilter.field);return oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ei(n.unaryFilter.field);return oe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ei(n.unaryFilter.field);return oe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ei(n.unaryFilter.field);return oe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(t):t.fieldFilter!==void 0?function(n){return oe.create(Ei(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ee.create(n.compositeFilter.filters.map(r=>_v(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $()}}(n.compositeFilter.op))}(t):$()}function yR(t){return lR[t]}function vR(t){return uR[t]}function IR(t){return hR[t]}function Ii(t){return{fieldPath:t.canonicalString()}}function Ei(t){return qe.fromServerFormat(t.fieldPath)}function yv(t){return t instanceof oe?function(n){if(n.op==="=="){if(Ap(n.value))return{unaryFilter:{field:Ii(n.field),op:"IS_NAN"}};if(wp(n.value))return{unaryFilter:{field:Ii(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ap(n.value))return{unaryFilter:{field:Ii(n.field),op:"IS_NOT_NAN"}};if(wp(n.value))return{unaryFilter:{field:Ii(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ii(n.field),op:vR(n.op),value:n.value}}}(t):t instanceof Ee?function(n){const r=n.getFilters().map(i=>yv(i));return r.length===1?r[0]:{compositeFilter:{op:IR(n.op),filters:r}}}(t):$()}function ER(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function vv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e,n,r,i,s=j.min(),o=j.min(),a=Ze.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new wn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new wn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new wn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new wn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e){this.ct=e}}function TR(t,e){let n;if(e.document)n=fv(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=k.fromSegments(e.noDocument.path),i=Zr(e.noDocument.readTime);n=Ve.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return $();{const r=k.fromSegments(e.unknownDocument.path),i=Zr(e.unknownDocument.version);n=Ve.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new ke(i[0],i[1]);return j.fromTimestamp(s)}(e.readTime)),n}function qp(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Za(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:po(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ki(s,o.version.toTimestamp()),createTime:Ki(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Jr(e.version)};else{if(!e.isUnknownDocument())return $();r.unknownDocument={path:n.path.toArray(),version:Jr(e.version)}}return r}function Za(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Jr(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zr(t){const e=new ke(t.seconds,t.nanoseconds);return j.fromTimestamp(e)}function xr(t,e){const n=(e.baseMutations||[]).map(s=>Nu(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Nu(t.ct,s)),i=ke.fromMillis(e.localWriteTimeMs);return new od(e.batchId,i,n,r)}function Vs(t){const e=Zr(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Zr(t.lastLimboFreeSnapshotVersion):j.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return K(s.documents.length===1),Ot(as(hv(s.documents[0])))}(t.query):function(s){return Ot(gv(s))}(t.query),new wn(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Ze.fromBase64String(t.resumeToken))}function Ev(t,e){const n=Jr(e.snapshotVersion),r=Jr(e.lastLimboFreeSnapshotVersion);let i;i=Ya(e.target)?pv(t.ct,e.target):mv(t.ct,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Qr(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function dd(t){const e=gv({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ja(e,e.limit,"L"):e}function Nl(t,e){return new cd(e.largestBatchId,Nu(t.ct,e.overlayMutation))}function Gp(t,e){const n=e.path.lastSegment();return[t,bt(e.path.popLast()),n]}function jp(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Jr(r.readTime),documentKey:bt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{getBundleMetadata(e,n){return Kp(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Zr(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return Kp(e).put(function(i){return{bundleId:i.id,createTime:Jr(Ge(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return zp(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:dd(s.bundledQuery),readTime:Zr(s.readTime)}}(r)})}saveNamedQuery(e,n){return zp(e).put(function(i){return{name:i.name,readTime:Jr(Ge(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function Kp(t){return ot(t,"bundles")}function zp(t){return ot(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Hc(e,r)}getOverlay(e,n){return vs(e).get(Gp(this.userId,n)).next(r=>r?Nl(this.serializer,r):null)}getOverlays(e,n){const r=fn();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new cd(n,o);i.push(this.ht(e,a))}),y.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(bt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(vs(e).J("collectionPathOverlayIndex",a))}),y.waitFor(s)}getOverlaysForCollection(e,n,r){const i=fn(),s=bt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return vs(e).G("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const l=Nl(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=fn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return vs(e).Z({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{const h=Nl(this.serializer,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>s)}ht(e,n){return vs(e).put(function(i,s,o){const[a,c,l]=Gp(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:go(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function vs(t){return ot(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Fe(e.integerValue));else if("doubleValue"in e){const r=Fe(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),lo(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(sr(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?Ny(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):$()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){const r=e.fields||{};this.Et(n,55);for(const i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){const r=e.values||[];this.Et(n,50);for(const i of r)this.It(i,n)}gt(e,n){this.Et(n,37),k.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}}Vr.bt=new Vr;function AR(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function Hp(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=AR(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class bR{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.vt(r.value),r=n.next();this.Ct()}Ft(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.vt(r);else if(r<2048)this.vt(960|r>>>6),this.vt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.vt(480|r>>>12),this.vt(128|63&r>>>6),this.vt(128|63&r);else{const i=n.codePointAt(0);this.vt(240|i>>>18),this.vt(128|63&i>>>12),this.vt(128|63&i>>>6),this.vt(128|63&i)}}this.Ct()}Nt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{const i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Bt(e){const n=this.Lt(e),r=Hp(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){const n=this.Lt(e),r=Hp(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}vt(e){const n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}Ct(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class SR{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}}class RR{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class Is{constructor(){this.Gt=new bR,this.zt=new SR(this.Gt),this.jt=new RR(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Nr(this.indexId,this.documentKey,this.arrayValue,r)}}function Ln(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=Wp(t.arrayValue,e.arrayValue),n!==0?n:(n=Wp(t.directionalValue,e.directionalValue),n!==0?n:k.comparator(t.documentKey,e.documentKey)))}function Wp(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=r:this.Zt.push(r)}}en(e){K(e.collectionGroup===this.collectionId);const n=Tu(e);if(n!==void 0&&!this.tn(n))return!1;const r=br(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt!==void 0){if(!i.has(this.Xt.field.canonicalString())){const a=r[s];if(!this.nn(this.Xt,a)||!this.rn(this.Yt[o++],a))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.Yt.length||!this.rn(this.Yt[o++],a))return!1}return!0}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(t){var e,n;if(K(t instanceof oe||t instanceof Ee),t instanceof oe){if(t instanceof $y){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>oe.create(t.field,"==",s)))||[];return Ee.create(i,"or")}return t}const r=t.filters.map(i=>Tv(i));return Ee.create(r,t.op)}function CR(t){if(t.getFilters().length===0)return[];const e=Mu(Tv(t));return K(wv(e)),Ou(e)||ku(e)?[e]:e.getFilters()}function Ou(t){return t instanceof oe}function ku(t){return t instanceof Ee&&td(t)}function wv(t){return Ou(t)||ku(t)||function(n){if(n instanceof Ee&&Su(n)){for(const r of n.getFilters())if(!Ou(r)&&!ku(r))return!1;return!0}return!1}(t)}function Mu(t){if(K(t instanceof oe||t instanceof Ee),t instanceof oe)return t;if(t.filters.length===1)return Mu(t.filters[0]);const e=t.filters.map(r=>Mu(r));let n=Ee.create(e,t.op);return n=ec(n),wv(n)?n:(K(n instanceof Ee),K(qi(n)),K(n.filters.length>1),n.filters.reduce((r,i)=>fd(r,i)))}function fd(t,e){let n;return K(t instanceof oe||t instanceof Ee),K(e instanceof oe||e instanceof Ee),n=t instanceof oe?e instanceof oe?function(i,s){return Ee.create([i,s],"and")}(t,e):Qp(t,e):e instanceof oe?Qp(e,t):function(i,s){if(K(i.filters.length>0&&s.filters.length>0),qi(i)&&qi(s))return Ly(i,s.getFilters());const o=Su(i)?i:s,a=Su(i)?s:i,c=o.filters.map(l=>fd(l,a));return Ee.create(c,"or")}(t,e),ec(n)}function Qp(t,e){if(qi(e))return Ly(e,t.getFilters());{const n=e.filters.map(r=>fd(t,r));return Ee.create(n,"or")}}function ec(t){if(K(t instanceof oe||t instanceof Ee),t instanceof oe)return t;const e=t.getFilters();if(e.length===1)return ec(e[0]);if(My(t))return t;const n=e.map(i=>ec(i)),r=[];return n.forEach(i=>{i instanceof oe?r.push(i):i instanceof Ee&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ee.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(){this.sn=new pd}addToCollectionParentIndex(e,n){return this.sn.add(n),y.resolve()}getCollectionParents(e,n){return y.resolve(this.sn.getEntries(n))}addFieldIndex(e,n){return y.resolve()}deleteFieldIndex(e,n){return y.resolve()}getDocumentsMatchingTarget(e,n){return y.resolve(null)}getIndexType(e,n){return y.resolve(0)}getFieldIndexes(e,n){return y.resolve([])}getNextCollectionGroupToUpdate(e){return y.resolve(null)}getMinOffset(e,n){return y.resolve(Ut.min())}getMinOffsetFromCollectionGroup(e,n){return y.resolve(Ut.min())}updateCollectionGroup(e,n,r){return y.resolve()}updateIndexEntries(e,n){return y.resolve()}}class pd{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ne(le.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ne(le.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha=new Uint8Array(0);class xR{constructor(e,n){this.user=e,this.databaseId=n,this.on=new pd,this._n=new _r(r=>Qr(r),(r,i)=>Bo(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.on.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.on.add(n)});const s={collectionId:r,parent:bt(i)};return Yp(e).put(s)}return y.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[Iy(n),""],!1,!0);return Yp(e).G(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(dn(o.parent))}return r})}addFieldIndex(e,n){const r=da(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Ts(e);return s.next(a=>{o.put(jp(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=da(e),i=Ts(e),s=Es(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=Es(e);let i=!0;const s=new Map;return y.forEach(this.an(n),o=>this.un(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=re();const a=[];return y.forEach(s,(c,l)=>{P("IndexedDbIndexManager",`Using index ${function(O){return`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(c)} to execute ${Qr(n)}`);const u=function(O,V){const W=Tu(V);if(W===void 0)return null;for(const J of Xa(O,W.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null}(l,c),h=function(O,V){const W=new Map;for(const J of br(V))for(const pe of Xa(O,J.fieldPath))switch(pe.op){case"==":case"in":W.set(J.fieldPath.canonicalString(),pe.value);break;case"not-in":case"!=":return W.set(J.fieldPath.canonicalString(),pe.value),Array.from(W.values())}return null}(l,c),d=function(O,V){const W=[];let J=!0;for(const pe of br(V)){const Z=pe.kind===0?Cp(O,pe.fieldPath,O.startAt):Dp(O,pe.fieldPath,O.startAt);W.push(Z.value),J&&(J=Z.inclusive)}return new cr(W,J)}(l,c),f=function(O,V){const W=[];let J=!0;for(const pe of br(V)){const Z=pe.kind===0?Dp(O,pe.fieldPath,O.endAt):Cp(O,pe.fieldPath,O.endAt);W.push(Z.value),J&&(J=Z.inclusive)}return new cr(W,J)}(l,c),v=this.cn(c,l,d),I=this.cn(c,l,f),T=this.ln(c,l,h),R=this.hn(c.indexId,u,v,d.inclusive,I,f.inclusive,T);return y.forEach(R,x=>r.H(x,n.limit).next(O=>{O.forEach(V=>{const W=k.fromSegments(V.documentKey);o.has(W)||(o=o.add(W),a.push(W))})}))}).next(()=>a)}return y.resolve(null)})}an(e){let n=this._n.get(e);return n||(e.filters.length===0?n=[e]:n=CR(Ee.create(e.filters,"and")).map(r=>Pu(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this._n.set(e,n),n)}hn(e,n,r,i,s,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,s.length),l=c/(n!=null?n.length:1),u=[];for(let h=0;h<c;++h){const d=n?this.Pn(n[h/l]):ha,f=this.In(e,d,r[h%l],i),v=this.Tn(e,d,s[h%l],o),I=a.map(T=>this.In(e,d,T,!0));u.push(...this.createRange(f,v,I))}return u}In(e,n,r,i){const s=new Nr(e,k.empty(),n,r);return i?s:s.Jt()}Tn(e,n,r,i){const s=new Nr(e,k.empty(),n,r);return i?s.Jt():s}un(e,n){const r=new PR(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.an(n);return y.forEach(i,s=>this.un(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new Ne(qe.comparator),u=!1;for(const h of c.filters)for(const d of h.getFlattenedFilters())d.field.isKeyField()||(d.op==="array-contains"||d.op==="array-contains-any"?u=!0:l=l.add(d.field));for(const h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(u?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}En(e,n){const r=new Is;for(const i of br(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Ht(i.kind);Vr.bt.Pt(s,o)}return r.Wt()}Pn(e){const n=new Is;return Vr.bt.Pt(e,n.Ht(0)),n.Wt()}dn(e,n){const r=new Is;return Vr.bt.Pt(Wr(this.databaseId,n),r.Ht(function(s){const o=br(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}ln(e,n,r){if(r===null)return[];let i=[];i.push(new Is);let s=0;for(const o of br(e)){const a=r[s++];for(const c of i)if(this.An(n,o.fieldPath)&&fo(a))i=this.Rn(i,o,a);else{const l=c.Ht(o.kind);Vr.bt.Pt(a,l)}}return this.Vn(i)}cn(e,n,r){return this.ln(e,n,r.position)}Vn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}Rn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const c=new Is;c.seed(a.Wt()),Vr.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}An(e,n){return!!e.filters.find(r=>r instanceof oe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=da(e),i=Ts(e);return(n?r.G("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.G()).next(s=>{const o=[];return y.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(u,h){const d=h?new Qa(h.sequenceNumber,new Ut(Zr(h.readTime),new k(dn(h.documentKey)),h.largestBatchId)):Qa.empty(),f=u.fields.map(([v,I])=>new fS(qe.fromServerFormat(v),I));return new Ey(u.indexId,u.collectionGroup,f,d)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ne(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=da(e),s=Ts(e);return this.mn(e).next(o=>i.G("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>y.forEach(a,c=>s.put(jp(c.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return y.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?y.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),y.forEach(a,c=>this.fn(e,i,c).next(l=>{const u=this.gn(s,c);return l.isEqual(u)?y.resolve():this.pn(e,s,c,l,u)}))))})}yn(e,n,r,i){return Es(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.dn(r,n.key),documentKey:n.key.path.toArray()})}wn(e,n,r,i){return Es(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.dn(r,n.key),n.key.path.toArray()])}fn(e,n,r){const i=Es(e);let s=new Ne(Ln);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.dn(r,n)])},(o,a)=>{s=s.add(new Nr(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}gn(e,n){let r=new Ne(Ln);const i=this.En(n,e);if(i==null)return r;const s=Tu(n);if(s!=null){const o=e.data.field(s.fieldPath);if(fo(o))for(const a of o.arrayValue.values||[])r=r.add(new Nr(n.indexId,e.key,this.Pn(a),i))}else r=r.add(new Nr(n.indexId,e.key,ha,i));return r}pn(e,n,r,i,s){P("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(c,l,u,h,d){const f=c.getIterator(),v=l.getIterator();let I=yi(f),T=yi(v);for(;I||T;){let R=!1,x=!1;if(I&&T){const O=u(I,T);O<0?x=!0:O>0&&(R=!0)}else I!=null?x=!0:R=!0;R?(h(T),T=yi(v)):x?(d(I),I=yi(f)):(I=yi(f),T=yi(v))}}(i,s,Ln,a=>{o.push(this.yn(e,n,r,a))},a=>{o.push(this.wn(e,n,r,a))}),y.waitFor(o)}mn(e){let n=1;return Ts(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ln(o,a)).filter((o,a,c)=>!a||Ln(o,c[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Ln(o,e),c=Ln(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Sn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,ha,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,ha,[]];s.push(IDBKeyRange.bound(a,c))}return s}Sn(e,n){return Ln(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Xp)}getMinOffset(e,n){return y.mapArray(this.an(n),r=>this.un(e,r).next(i=>i||$())).next(Xp)}}function Yp(t){return ot(t,"collectionParents")}function Es(t){return ot(t,"indexEntries")}function da(t){return ot(t,"indexConfiguration")}function Ts(t){return ot(t,"indexState")}function Xp(t){K(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Jh(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Ut(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ct{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ct(e,Ct.DEFAULT_COLLECTION_PERCENTILE,Ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Z({range:o},(u,h,d)=>(a++,d.delete()));s.push(c.next(()=>{K(a===1)}));const l=[];for(const u of n.mutations){const h=Ry(e,u.key.path,n.batchId);s.push(i.delete(h)),l.push(u.key)}return y.waitFor(s).next(()=>l)}function tc(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw $();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ct.DEFAULT_COLLECTION_PERCENTILE=10,Ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ct.DEFAULT=new Ct(41943040,Ct.DEFAULT_COLLECTION_PERCENTILE,Ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ct.DISABLED=new Ct(-1,0,0);class Wc{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.bn={}}static lt(e,n,r,i){K(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Wc(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Bn(e).Z({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Ti(e),o=Bn(e);return o.add({}).next(a=>{K(typeof a=="number");const c=new od(a,n,r,i),l=function(f,v,I){const T=I.baseMutations.map(x=>go(f.ct,x)),R=I.mutations.map(x=>go(f.ct,x));return{userId:v,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:T,mutations:R}}(this.serializer,this.userId,c),u=[];let h=new Ne((d,f)=>ne(d.canonicalString(),f.canonicalString()));for(const d of i){const f=Ry(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(s.put(f,vS))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.bn[a]=c.keys()}),y.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Bn(e).get(n).next(r=>r?(K(r.userId===this.userId),xr(this.serializer,r)):null)}Dn(e,n){return this.bn[n]?y.resolve(this.bn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.bn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Bn(e).Z({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(K(a.batchId>=r),s=xr(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Bn(e).Z({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Bn(e).G("userMutationsIndex",n).next(r=>r.map(i=>xr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Ta(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ti(e).Z({range:i},(o,a,c)=>{const[l,u,h]=o,d=dn(u);if(l===this.userId&&n.path.isEqual(d))return Bn(e).get(h).next(f=>{if(!f)throw $();K(f.userId===this.userId),s.push(xr(this.serializer,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ne(ne);const i=[];return n.forEach(s=>{const o=Ta(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Ti(e).Z({range:a},(l,u,h)=>{const[d,f,v]=l,I=dn(f);d===this.userId&&s.path.isEqual(I)?r=r.add(v):h.done()});i.push(c)}),y.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Ta(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ne(ne);return Ti(e).Z({range:o},(c,l,u)=>{const[h,d,f]=c,v=dn(d);h===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(f)):u.done()}).next(()=>this.vn(e,a))}vn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Bn(e).get(s).next(o=>{if(o===null)throw $();K(o.userId===this.userId),r.push(xr(this.serializer,o))}))}),y.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return Av(e.ue,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Cn(n.batchId)}),y.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Cn(e){delete this.bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return y.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ti(e).Z({range:r},(s,o,a)=>{if(s[0]===this.userId){const c=dn(s[1]);i.push(c)}else a.done()}).next(()=>{K(i.length===0)})})}containsKey(e,n){return bv(e,this.userId,n)}Fn(e){return Sv(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function bv(t,e,n){const r=Ta(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ti(t).Z({range:s,Y:!0},(a,c,l)=>{const[u,h,d]=a;u===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function Bn(t){return ot(t,"mutations")}function Ti(t){return ot(t,"documentMutations")}function Sv(t){return ot(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e){this.Mn=e}next(){return this.Mn+=2,this.Mn}static xn(){return new ei(0)}static On(){return new ei(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Nn(e).next(n=>{const r=new ei(n.highestTargetId);return n.highestTargetId=r.next(),this.Bn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Nn(e).next(n=>j.fromTimestamp(new ke(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Nn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Nn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Bn(e,i)))}addTargetData(e,n){return this.Ln(e,n).next(()=>this.Nn(e).next(r=>(r.targetCount+=1,this.kn(n,r),this.Bn(e,r))))}updateTargetData(e,n){return this.Ln(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>vi(e).delete(n.targetId)).next(()=>this.Nn(e)).next(r=>(K(r.targetCount>0),r.targetCount-=1,this.Bn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return vi(e).Z((o,a)=>{const c=Vs(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>y.waitFor(s)).next(()=>i)}forEachTarget(e,n){return vi(e).Z((r,i)=>{const s=Vs(i);n(s)})}Nn(e){return Zp(e).get("targetGlobalKey").next(n=>(K(n!==null),n))}Bn(e,n){return Zp(e).put("targetGlobalKey",n)}Ln(e,n){return vi(e).put(Ev(this.serializer,n))}kn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Nn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Qr(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return vi(e).Z({range:i,index:"queryTargetsIndex"},(o,a,c)=>{const l=Vs(a);Bo(n,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=jn(e);return n.forEach(o=>{const a=bt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),y.waitFor(i)}removeMatchingKeys(e,n,r){const i=jn(e);return y.forEach(n,s=>{const o=bt(s.path);return y.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=jn(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=jn(e);let s=re();return i.Z({range:r,Y:!0},(o,a,c)=>{const l=dn(o[1]),u=new k(l);s=s.add(u)}).next(()=>s)}containsKey(e,n){const r=bt(n.path),i=IDBKeyRange.bound([r],[Iy(r)],!1,!0);let s=0;return jn(e).Z({index:"documentTargetsIndex",Y:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ut(e,n){return vi(e).get(n).next(r=>r?Vs(r):null)}}function vi(t){return ot(t,"targets")}function Zp(t){return ot(t,"targetGlobal")}function jn(t){return ot(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em([t,e],[n,r]){const i=ne(t,n);return i===0?ne(e,r):i}class NR{constructor(e){this.qn=e,this.buffer=new Ne(em),this.Qn=0}Kn(){return++this.Qn}$n(e){const n=[e,this.Kn()];if(this.buffer.size<this.qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();em(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class OR{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Un=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Wn(6e4)}stop(){this.Un&&(this.Un.cancel(),this.Un=null)}get started(){return this.Un!==null}Wn(e){P("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Un=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Un=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){gr(n)?P("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await mr(n)}await this.Wn(3e5)})}}class kR{constructor(e,n){this.Gn=e,this.params=n}calculateTargetCount(e,n){return this.Gn.zn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return y.resolve(Dt.ae);const r=new NR(n);return this.Gn.forEachTarget(e,i=>r.$n(i.sequenceNumber)).next(()=>this.Gn.jn(e,i=>r.$n(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Gn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Gn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(P("LruGarbageCollector","Garbage collection skipped; disabled"),y.resolve(Jp)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(P("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Jp):this.Hn(e,n))}getCacheSize(e){return this.Gn.getCacheSize(e)}Hn(e,n){let r,i,s,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(P("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),Eu()<=de.DEBUG&&P("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),y.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function MR(t,e){return new kR(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e,n){this.db=e,this.garbageCollector=MR(this,n)}zn(e){const n=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Jn(e){let n=0;return this.jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}jn(e,n){return this.Yn(e,(r,i)=>n(i))}addReference(e,n,r){return fa(e,r)}removeReference(e,n,r){return fa(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return fa(e,n)}Zn(e,n){return function(i,s){let o=!1;return Sv(i).X(a=>bv(i,a,s).next(c=>(c&&(o=!0),y.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Yn(e,(o,a)=>{if(a<=n){const c=this.Zn(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,j.min()),jn(e).delete(function(h){return[0,bt(h.path)]}(o))))});i.push(c)}}).next(()=>y.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return fa(e,n)}Yn(e,n){const r=jn(e);let i,s=Dt.ae;return r.Z({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==Dt.ae&&n(new k(dn(i)),s),s=l,i=c):s=Dt.ae}).next(()=>{s!==Dt.ae&&n(new k(dn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function fa(t,e){return jn(t).put(function(r,i){return{targetId:0,path:bt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.changes=new _r(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ve.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LR{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return wr(e).put(r)}removeEntry(e,n,r){return wr(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Za(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Xn(e,r)))}getEntry(e,n){let r=Ve.newInvalidDocument(n);return wr(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(ws(n))},(i,s)=>{r=this.er(n,s)}).next(()=>r)}tr(e,n){let r={size:0,document:Ve.newInvalidDocument(n)};return wr(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(ws(n))},(i,s)=>{r={document:this.er(n,s),size:tc(s)}}).next(()=>r)}getEntries(e,n){let r=Vt();return this.nr(e,n,(i,s)=>{const o=this.er(i,s);r=r.insert(i,o)}).next(()=>r)}rr(e,n){let r=Vt(),i=new Ce(k.comparator);return this.nr(e,n,(s,o)=>{const a=this.er(s,o);r=r.insert(s,a),i=i.insert(s,tc(o))}).next(()=>({documents:r,ir:i}))}nr(e,n,r){if(n.isEmpty())return y.resolve();let i=new Ne(rm);n.forEach(c=>i=i.add(c));const s=IDBKeyRange.bound(ws(i.first()),ws(i.last())),o=i.getIterator();let a=o.getNext();return wr(e).Z({index:"documentKeyIndex",range:s},(c,l,u)=>{const h=k.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&rm(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?u.W(ws(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i){const s=n.path,o=[s.popLast().toArray(),s.lastSegment(),Za(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wr(e).G(IDBKeyRange.bound(o,a,!0)).next(c=>{let l=Vt();for(const u of c){const h=this.er(k.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);h.isFoundDocument()&&($o(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=Vt();const o=nm(n,r),a=nm(n,Ut.max());return wr(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{const h=this.er(k.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new BR(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return tm(e).get("remoteDocumentGlobalKey").next(n=>(K(!!n),n))}Xn(e,n){return tm(e).put("remoteDocumentGlobalKey",n)}er(e,n){if(n){const r=TR(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(j.min())))return r}return Ve.newInvalidDocument(e)}}function Pv(t){return new LR(t)}class BR extends Rv{constructor(e,n){super(),this.sr=e,this.trackRemovals=n,this._r=new _r(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ne((s,o)=>ne(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this._r.get(s);if(n.push(this.sr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const c=qp(this.sr.serializer,o);i=i.add(s.path.popLast());const l=tc(c);r+=l-a.size,n.push(this.sr.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){const c=qp(this.sr.serializer,o.convertToNoDocument(j.min()));n.push(this.sr.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.sr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.sr.updateMetadata(e,r)),y.waitFor(n)}getFromCache(e,n){return this.sr.tr(e,n).next(r=>(this._r.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.sr.rr(e,n).next(({documents:r,ir:i})=>(i.forEach((s,o)=>{this._r.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function tm(t){return ot(t,"remoteDocumentGlobal")}function wr(t){return ot(t,"remoteDocumentsV14")}function ws(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function nm(t,e){const n=e.documentKey.path.toArray();return[t,Za(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function rm(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ne(n[s],r[s]),i)return i;return i=ne(n.length,r.length),i||(i=ne(n[n.length-2],r[r.length-2]),i||ne(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Bs(r.mutation,i,xt.empty(),ke.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,n,r=re()){const i=fn();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ds();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=fn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,re()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Vt();const o=Ls(),a=function(){return Ls()}();return n.forEach((c,l)=>{const u=r.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof xn)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),Bs(u.mutation,l,u.mutation.getFieldMask(),ke.now())):o.set(l.key,xt.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new UR(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Ls();let i=new Ce((o,a)=>o-a),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=r.get(c)||xt.empty();u=a.applyToLocalView(l,u),r.set(c,u);const h=(i.get(a.batchId)||re()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=Wy();u.forEach(d=>{if(!s.has(d)){const f=nv(n.get(d),r.get(d));f!==null&&h.set(d,f),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return y.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return k.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):rd(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):y.resolve(fn());let a=-1,c=s;return o.next(l=>y.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?y.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,re())).next(u=>({batchId:a,changes:Hy(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new k(n)).next(r=>{let i=Ds();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const i=n.collectionGroup;let s=Ds();return this.indexManager.getCollectionParents(e,i).next(o=>y.forEach(o,a=>{const c=function(u,h){return new Dn(h,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(l=>{l.forEach((u,h)=>{s=s.insert(u,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i))).next(s=>{i.forEach((a,c)=>{const l=c.getKey();s.get(l)===null&&(s=s.insert(l,Ve.newInvalidDocument(l)))});let o=Ds();return s.forEach((a,c)=>{const l=i.get(a);l!==void 0&&Bs(l.mutation,c,xt.empty(),ke.now()),$o(n,c)&&(o=o.insert(a,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e){this.serializer=e,this.ar=new Map,this.ur=new Map}getBundleMetadata(e,n){return y.resolve(this.ar.get(n))}saveBundleMetadata(e,n){return this.ar.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ge(i.createTime)}}(n)),y.resolve()}getNamedQuery(e,n){return y.resolve(this.ur.get(n))}saveNamedQuery(e,n){return this.ur.set(n.name,function(i){return{name:i.name,query:dd(i.bundledQuery),readTime:Ge(i.readTime)}}(n)),y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(){this.overlays=new Ce(k.comparator),this.cr=new Map}getOverlay(e,n){return y.resolve(this.overlays.get(n))}getOverlays(e,n){const r=fn();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),y.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.cr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.cr.delete(r)),y.resolve()}getOverlaysForCollection(e,n,r){const i=fn(),s=n.length+1,o=new k(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return y.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ce((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=s.get(l.largestBatchId);u===null&&(u=fn(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=fn(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=i)););return y.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.cr.get(i.largestBatchId).delete(r.key);this.cr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new cd(n,r));let s=this.cr.get(n);s===void 0&&(s=re(),this.cr.set(n,s)),this.cr.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(){this.lr=new Ne(et.hr),this.Pr=new Ne(et.Ir)}isEmpty(){return this.lr.isEmpty()}addReference(e,n){const r=new et(e,n);this.lr=this.lr.add(r),this.Pr=this.Pr.add(r)}Tr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Er(new et(e,n))}dr(e,n){e.forEach(r=>this.removeReference(r,n))}Ar(e){const n=new k(new le([])),r=new et(n,e),i=new et(n,e+1),s=[];return this.Pr.forEachInRange([r,i],o=>{this.Er(o),s.push(o.key)}),s}Rr(){this.lr.forEach(e=>this.Er(e))}Er(e){this.lr=this.lr.delete(e),this.Pr=this.Pr.delete(e)}Vr(e){const n=new k(new le([])),r=new et(n,e),i=new et(n,e+1);let s=re();return this.Pr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new et(e,0),r=this.lr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class et{constructor(e,n){this.key=e,this.mr=n}static hr(e,n){return k.comparator(e.key,n.key)||ne(e.mr,n.mr)}static Ir(e,n){return ne(e.mr,n.mr)||k.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.gr=1,this.pr=new Ne(et.hr)}checkEmpty(e){return y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.gr;this.gr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new od(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.pr=this.pr.add(new et(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return y.resolve(o)}lookupMutationBatch(e,n){return y.resolve(this.yr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.wr(r),s=i<0?0:i;return y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return y.resolve(this.mutationQueue.length===0?-1:this.gr-1)}getAllMutationBatches(e){return y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new et(n,0),i=new et(n,Number.POSITIVE_INFINITY),s=[];return this.pr.forEachInRange([r,i],o=>{const a=this.yr(o.mr);s.push(a)}),y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ne(ne);return n.forEach(i=>{const s=new et(i,0),o=new et(i,Number.POSITIVE_INFINITY);this.pr.forEachInRange([s,o],a=>{r=r.add(a.mr)})}),y.resolve(this.Sr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;k.isDocumentKey(s)||(s=s.child(""));const o=new et(new k(s),0);let a=new Ne(ne);return this.pr.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.mr)),!0)},o),y.resolve(this.Sr(a))}Sr(e){const n=[];return e.forEach(r=>{const i=this.yr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){K(this.br(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.pr;return y.forEach(n.mutations,i=>{const s=new et(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.pr=r})}Cn(e){}containsKey(e,n){const r=new et(n,0),i=this.pr.firstAfterOrEqual(r);return y.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,y.resolve()}br(e,n){return this.wr(e)}wr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}yr(e){const n=this.wr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e){this.Dr=e,this.docs=function(){return new Ce(k.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Dr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return y.resolve(r?r.document.mutableCopy():Ve.newInvalidDocument(n))}getEntries(e,n){let r=Vt();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ve.newInvalidDocument(i))}),y.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Vt();const o=n.path,a=new k(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Jh(wy(u),r)<=0||(i.has(u.key)||$o(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return y.resolve(s)}getAllFromCollectionGroup(e,n,r,i){$()}vr(e,n){return y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new KR(this)}getSize(e){return y.resolve(this.size)}}class KR extends Rv{constructor(e){super(),this.sr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.sr.addEntry(e,i)):this.sr.removeEntry(r)}),y.waitFor(n)}getFromCache(e,n){return this.sr.getEntry(e,n)}getAllFromCache(e,n){return this.sr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e){this.persistence=e,this.Cr=new _r(n=>Qr(n),Bo),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.Fr=0,this.Mr=new md,this.targetCount=0,this.Or=ei.xn()}forEachTarget(e,n){return this.Cr.forEach((r,i)=>n(i)),y.resolve()}getLastRemoteSnapshotVersion(e){return y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return y.resolve(this.Fr)}allocateTargetId(e){return this.highestTargetId=this.Or.next(),y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Fr&&(this.Fr=n),y.resolve()}Ln(e){this.Cr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Or=new ei(n),this.highestTargetId=n),e.sequenceNumber>this.Fr&&(this.Fr=e.sequenceNumber)}addTargetData(e,n){return this.Ln(n),this.targetCount+=1,y.resolve()}updateTargetData(e,n){return this.Ln(n),y.resolve()}removeTargetData(e,n){return this.Cr.delete(n.target),this.Mr.Ar(n.targetId),this.targetCount-=1,y.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Cr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Cr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),y.waitFor(s).next(()=>i)}getTargetCount(e){return y.resolve(this.targetCount)}getTargetData(e,n){const r=this.Cr.get(n)||null;return y.resolve(r)}addMatchingKeys(e,n,r){return this.Mr.Tr(n,r),y.resolve()}removeMatchingKeys(e,n,r){this.Mr.dr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),y.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Mr.Ar(n),y.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Mr.Vr(n);return y.resolve(r)}containsKey(e,n){return y.resolve(this.Mr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,n){this.Nr={},this.overlays={},this.Br=new Dt(0),this.Lr=!1,this.Lr=!0,this.referenceDelegate=e(this),this.kr=new zR(this),this.indexManager=new DR,this.remoteDocumentCache=function(i){return new jR(i)}(r=>this.referenceDelegate.qr(r)),this.serializer=new Iv(n),this.Qr=new $R(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Lr=!1,Promise.resolve()}get started(){return this.Lr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new qR,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Nr[e.toKey()];return r||(r=new GR(n,this.referenceDelegate),this.Nr[e.toKey()]=r),r}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Qr}runTransaction(e,n,r){P("MemoryPersistence","Starting transaction:",e);const i=new HR(this.Br.next());return this.referenceDelegate.Kr(),r(i).next(s=>this.referenceDelegate.$r(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ur(e,n){return y.or(Object.values(this.Nr).map(r=>()=>r.containsKey(e,n)))}}class HR extends by{constructor(e){super(),this.currentSequenceNumber=e}}class Qc{constructor(e){this.persistence=e,this.Wr=new md,this.Gr=null}static zr(e){return new Qc(e)}get jr(){if(this.Gr)return this.Gr;throw $()}addReference(e,n,r){return this.Wr.addReference(r,n),this.jr.delete(r.toString()),y.resolve()}removeReference(e,n,r){return this.Wr.removeReference(r,n),this.jr.add(r.toString()),y.resolve()}markPotentiallyOrphaned(e,n){return this.jr.add(n.toString()),y.resolve()}removeTarget(e,n){this.Wr.Ar(n.targetId).forEach(i=>this.jr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Kr(){this.Gr=new Set}$r(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return y.forEach(this.jr,r=>{const i=k.fromPath(r);return this.Hr(e,i).next(s=>{s||n.removeEntry(i,j.min())})}).next(()=>(this.Gr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Hr(e,n).next(r=>{r?this.jr.delete(n.toString()):this.jr.add(n.toString())})}qr(e){return 0}Hr(e,n){return y.or([()=>y.resolve(this.Wr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ur(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e){this.serializer=e}B(e,n,r,i){const s=new qc("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",vp,{unique:!0}),c.createObjectStore("documentMutations")}(e),im(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=y.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),im(e)),o=o.next(()=>function(c){const l=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:j.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",u)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").G().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",vp,{unique:!0});const h=l.store("mutations"),d=u.map(f=>h.put(f));return y.waitFor(d)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Yr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.Zr(s)))),r<7&&i>=7&&(o=o.next(()=>this.Xr(s))),r<8&&i>=8&&(o=o.next(()=>this.ei(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ti(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){const l=c.createObjectStore("documentOverlays",{keyPath:xS});l.createIndex("collectionPathOverlayIndex",VS,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",NS,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){const l=c.createObjectStore("remoteDocumentsV14",{keyPath:IS});l.createIndex("documentKeyIndex",ES),l.createIndex("collectionGroupIndex",TS)}(e)).next(()=>this.ni(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ri(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:RS}).createIndex("sequenceNumberIndex",PS,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:CS}).createIndex("documentKeyIndex",DS,{unique:!1})}(e))),o}Zr(e){let n=0;return e.store("remoteDocuments").Z((r,i)=>{n+=tc(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Yr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.G().next(i=>y.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.G("userMutationsIndex",o).next(a=>y.forEach(a,c=>{K(c.userId===s.userId);const l=xr(this.serializer,c);return Av(e,s.userId,l).next(()=>{})}))}))}Xr(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Z((o,a)=>{const c=new le(o),l=function(h){return[0,bt(h)]}(c);s.push(n.get(l).next(u=>u?y.resolve():(h=>n.put({targetId:0,path:bt(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>y.waitFor(s))})}ei(e,n){e.createObjectStore("collectionParents",{keyPath:SS});const r=n.store("collectionParents"),i=new pd,s=o=>{if(i.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:bt(c)})}};return n.store("remoteDocuments").Z({Y:!0},(o,a)=>{const c=new le(o);return s(c.popLast())}).next(()=>n.store("documentMutations").Z({Y:!0},([o,a,c],l)=>{const u=dn(a);return s(u.popLast())}))}ti(e){const n=e.store("targets");return n.Z((r,i)=>{const s=Vs(i),o=Ev(this.serializer,s);return n.put(o)})}ni(e,n){const r=n.store("remoteDocuments"),i=[];return r.Z((s,o)=>{const a=n.store("remoteDocumentsV14"),c=function(h){return h.document?new k(le.fromString(h.document.name).popFirst(5)):h.noDocument?k.fromSegments(h.noDocument.path):h.unknownDocument?k.fromSegments(h.unknownDocument.path):$()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>y.waitFor(i))}ri(e,n){const r=n.store("mutations"),i=Pv(this.serializer),s=new Dv(Qc.zr,this.serializer.ct);return r.G().next(o=>{const a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:re();xr(this.serializer,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),y.forEach(a,(c,l)=>{const u=new tt(l),h=Hc.lt(this.serializer,u),d=s.getIndexManager(u),f=Wc.lt(u,this.serializer,d,s.referenceDelegate);return new Cv(i,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new wu(n,Dt.ae),c).next()})})}}function im(t){t.createObjectStore("targetDocuments",{keyPath:AS}).createIndex("documentTargetsIndex",bS,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",wS,{unique:!0}),t.createObjectStore("targetGlobal")}const Ol="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class gd{constructor(e,n,r,i,s,o,a,c,l,u,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ii=s,this.window=o,this.document=a,this.si=l,this.oi=u,this._i=h,this.Br=null,this.Lr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ai=null,this.inForeground=!1,this.ui=null,this.ci=null,this.li=Number.NEGATIVE_INFINITY,this.hi=d=>Promise.resolve(),!gd.v())throw new S(E.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new FR(this,i),this.Pi=n+"main",this.serializer=new Iv(c),this.Ii=new Yt(this.Pi,this._i,new WR(this.serializer)),this.kr=new VR(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Pv(this.serializer),this.Qr=new wR,this.window&&this.window.localStorage?this.Ti=this.window.localStorage:(this.Ti=null,u===!1&&$e("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ei().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new S(E.FAILED_PRECONDITION,Ol);return this.di(),this.Ai(),this.Ri(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.kr.getHighestSequenceNumber(e))}).then(e=>{this.Br=new Dt(e,this.si)}).then(()=>{this.Lr=!0}).catch(e=>(this.Ii&&this.Ii.close(),Promise.reject(e)))}Vi(e){return this.hi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ii.k(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(async()=>{this.started&&await this.Ei()}))}Ei(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>pa(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.mi(e).next(n=>{n||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.hi(!1)))})}).next(()=>this.fi(e)).next(n=>this.isPrimary&&!n?this.gi(e).next(()=>!1):!!n&&this.pi(e).next(()=>!0))).catch(e=>{if(gr(e))return P("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return P("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.hi(e)),this.isPrimary=e})}mi(e){return As(e).get("owner").next(n=>y.resolve(this.yi(n)))}wi(e){return pa(e).delete(this.clientId)}async Si(){if(this.isPrimary&&!this.bi(this.li,18e5)){this.li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=ot(n,"clientMetadata");return r.G().next(i=>{const s=this.Di(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return y.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ti)for(const n of e)this.Ti.removeItem(this.vi(n.clientId))}}Ri(){this.ci=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ei().then(()=>this.Si()).then(()=>this.Ri()))}yi(e){return!!e&&e.ownerId===this.clientId}fi(e){return this.oi?y.resolve(!0):As(e).get("owner").next(n=>{if(n!==null&&this.bi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)){if(this.yi(n)&&this.networkEnabled)return!0;if(!this.yi(n)){if(!n.allowTabSynchronization)throw new S(E.FAILED_PRECONDITION,Ol);return!1}}return!(!this.networkEnabled||!this.inForeground)||pa(e).G().next(r=>this.Di(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&P("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Lr=!1,this.Fi(),this.ci&&(this.ci.cancel(),this.ci=null),this.Mi(),this.xi(),await this.Ii.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new wu(e,Dt.ae);return this.gi(n).next(()=>this.wi(n))}),this.Ii.close(),this.Oi()}Di(e,n){return e.filter(r=>this.bi(r.updateTimeMs,n)&&!this.Ci(r.clientId))}Ni(){return this.runTransaction("getActiveClients","readonly",e=>pa(e).G().next(n=>this.Di(n,18e5).map(r=>r.clientId)))}get started(){return this.Lr}getMutationQueue(e,n){return Wc.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new xR(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Hc.lt(this.serializer,e)}getBundleCache(){return this.Qr}runTransaction(e,n,r){P("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===15?kS:c===14?Dy:c===13?Cy:c===12?OS:c===11?Py:void $()}(this._i);let o;return this.Ii.runTransaction(e,i,s,a=>(o=new wu(a,this.Br?this.Br.next():Dt.ae),n==="readwrite-primary"?this.mi(o).next(c=>!!c||this.fi(o)).next(c=>{if(!c)throw $e(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.hi(!1)),new S(E.FAILED_PRECONDITION,Ay);return r(o)}).next(c=>this.pi(o).next(()=>c)):this.Bi(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Bi(e){return As(e).get("owner").next(n=>{if(n!==null&&this.bi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)&&!this.yi(n)&&!(this.oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new S(E.FAILED_PRECONDITION,Ol)})}pi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return As(e).put("owner",n)}static v(){return Yt.v()}gi(e){const n=As(e);return n.get("owner").next(r=>this.yi(r)?(P("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):y.resolve())}bi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||($e(`Detected an update time that is in the future: ${e} > ${r}`),!1))}di(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ui=()=>{this.ii.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ei()))},this.document.addEventListener("visibilitychange",this.ui),this.inForeground=this.document.visibilityState==="visible")}Mi(){this.ui&&(this.document.removeEventListener("visibilitychange",this.ui),this.ui=null)}Ai(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ai=()=>{this.Fi();const n=/(?:Version|Mobile)\/1[456]/;TA()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ai))}xi(){this.ai&&(this.window.removeEventListener("pagehide",this.ai),this.ai=null)}Ci(e){var n;try{const r=((n=this.Ti)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return P("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return $e("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Fi(){if(this.Ti)try{this.Ti.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){$e("Failed to set zombie client id.",e)}}Oi(){if(this.Ti)try{this.Ti.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function As(t){return ot(t,"owner")}function pa(t){return ot(t,"clientMetadata")}function _d(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Li=r,this.ki=i}static qi(e,n){let r=re(),i=re();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new yd(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(){this.Qi=!1}initialize(e,n){this.Ki=e,this.indexManager=n,this.Qi=!0}getDocumentsMatchingQuery(e,n,r,i){return this.$i(e,n).next(s=>s||this.Ui(e,n,i,r)).next(s=>s||this.Wi(e,n))}$i(e,n){if(xp(n))return y.resolve(null);let r=Ot(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Ja(n,null,"F"),r=Ot(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=re(...s);return this.Ki.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const l=this.Gi(n,a);return this.zi(n,l,o,c.readTime)?this.$i(e,Ja(n,null,"F")):this.ji(e,l,n,c)}))})))}Ui(e,n,r,i){return xp(n)||i.isEqual(j.min())?this.Wi(e,n):this.Ki.getDocuments(e,r).next(s=>{const o=this.Gi(n,s);return this.zi(n,o,r,i)?this.Wi(e,n):(Eu()<=de.DEBUG&&P("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Du(n)),this.ji(e,o,n,Ty(i,-1)))})}Gi(e,n){let r=new Ne(Ky(e));return n.forEach((i,s)=>{$o(e,s)&&(r=r.add(s))}),r}zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Wi(e,n){return Eu()<=de.DEBUG&&P("QueryEngine","Using full collection scan to execute query:",Du(n)),this.Ki.getDocumentsMatchingQuery(e,n,Ut.min())}ji(e,n,r,i){return this.Ki.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e,n,r,i){this.persistence=e,this.Hi=n,this.serializer=i,this.Ji=new Ce(ne),this.Yi=new _r(s=>Qr(s),Bo),this.Zi=new Map,this.Xi=e.getRemoteDocumentCache(),this.kr=e.getTargetCache(),this.Qr=e.getBundleCache(),this.es(r)}es(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Cv(this.Xi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Xi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ji))}}function Vv(t,e,n,r){return new QR(t,e,n,r)}async function Nv(t,e){const n=L(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.es(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let c=re();for(const l of i){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of s){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({ts:l,removedBatchIds:o,addedBatchIds:a}))})})}function YR(t,e){const n=L(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Xi.newChangeBuffer({trackRemovals:!0});return function(a,c,l,u){const h=l.batch,d=h.keys();let f=y.resolve();return d.forEach(v=>{f=f.next(()=>u.getEntry(c,v)).next(I=>{const T=l.docVersions.get(v);K(T!==null),I.version.compareTo(T)<0&&(h.applyToRemoteDocument(I,l),I.isValidDocument()&&(I.setReadTime(l.commitVersion),u.addEntry(I)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=re();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Ov(t){const e=L(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.kr.getLastRemoteSnapshotVersion(n))}function XR(t,e){const n=L(t),r=e.snapshotVersion;let i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Xi.newChangeBuffer({trackRemovals:!0});i=n.Ji;const a=[];e.targetChanges.forEach((u,h)=>{const d=i.get(h);if(!d)return;a.push(n.kr.removeMatchingKeys(s,u.removedDocuments,h).next(()=>n.kr.addMatchingKeys(s,u.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(Ze.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),i=i.insert(h,f),function(I,T,R){return I.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(d,f,u)&&a.push(n.kr.updateTargetData(s,f))});let c=Vt(),l=re();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(kv(s,o,e.documentUpdates).next(u=>{c=u.ns,l=u.rs})),!r.isEqual(j.min())){const u=n.kr.getLastRemoteSnapshotVersion(s).next(h=>n.kr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return y.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.Ji=i,s))}function kv(t,e,n){let r=re(),i=re();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Vt();return n.forEach((a,c)=>{const l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(j.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):P("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{ns:o,rs:i}})}function JR(t,e){const n=L(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function zi(t,e){const n=L(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.kr.getTargetData(r,e).next(s=>s?(i=s,y.resolve(i)):n.kr.allocateTargetId(r).next(o=>(i=new wn(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.kr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ji.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(r.targetId,r),n.Yi.set(e,r.targetId)),r})}async function Hi(t,e,n){const r=L(t),i=r.Ji.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!gr(o))throw o;P("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(i.target)}function nc(t,e,n){const r=L(t);let i=j.min(),s=re();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,l,u){const h=L(c),d=h.Yi.get(u);return d!==void 0?y.resolve(h.Ji.get(d)):h.kr.getTargetData(l,u)}(r,o,Ot(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.kr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,e,n?i:j.min(),n?s:re())).next(a=>(Lv(r,jy(e),a),{documents:a,ss:s})))}function Mv(t,e){const n=L(t),r=L(n.kr),i=n.Ji.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ut(s,e).next(o=>o?o.target:null))}function Fv(t,e){const n=L(t),r=n.Zi.get(e)||j.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.Xi.getAllFromCollectionGroup(i,e,Ty(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Lv(n,e,i),i))}function Lv(t,e,n){let r=t.Zi.get(e)||j.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Zi.set(e,r)}async function ZR(t,e,n,r){const i=L(t);let s=re(),o=Vt();for(const l of n){const u=e.os(l.metadata.name);l.document&&(s=s.add(u));const h=e._s(l);h.setReadTime(e.us(l.metadata.readTime)),o=o.insert(u,h)}const a=i.Xi.newChangeBuffer({trackRemovals:!0}),c=await zi(i,function(u){return Ot(as(le.fromString(`__bundle__/docs/${u}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>kv(l,a,o).next(u=>(a.apply(l),u)).next(u=>i.kr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.kr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,u.ns,u.rs)).next(()=>u.ns)))}async function eP(t,e,n=re()){const r=await zi(t,Ot(dd(e.bundledQuery))),i=L(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=Ge(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qr.saveNamedQuery(s,e);const a=r.withResumeToken(Ze.EMPTY_BYTE_STRING,o);return i.Ji=i.Ji.insert(a.targetId,a),i.kr.updateTargetData(s,a).next(()=>i.kr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.kr.addMatchingKeys(s,n,r.targetId)).next(()=>i.Qr.saveNamedQuery(s,e))})}function sm(t,e){return`firestore_clients_${t}_${e}`}function om(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function kl(t,e){return`firestore_targets_${t}_${e}`}class rc{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static cs(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new S(i.error.code,i.error.message))),o?new rc(e,n,i.state,s):($e("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ls(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Us{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static cs(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new S(r.error.code,r.error.message))),s?new Us(e,r.state,i):($e("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ls(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ic{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static cs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=id();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=Sy(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new ic(e,s):($e("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class vd{constructor(e,n){this.clientId=e,this.onlineState=n}static cs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new vd(n.clientId,n.onlineState):($e("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Fu{constructor(){this.activeTargetIds=id()}hs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ps(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ls(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ml{constructor(e,n,r,i,s){this.window=e,this.ii=n,this.persistenceKey=r,this.Is=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ts=this.Es.bind(this),this.ds=new Ce(ne),this.started=!1,this.As=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Rs=sm(this.persistenceKey,this.Is),this.Vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ds=this.ds.insert(this.Is,new Fu),this.fs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.gs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.ps=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.ys=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.ws=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ts)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ni();for(const r of e){if(r===this.Is)continue;const i=this.getItem(sm(this.persistenceKey,r));if(i){const s=ic.cs(r,i);s&&(this.ds=this.ds.insert(s.clientId,s))}}this.Ss();const n=this.storage.getItem(this.ys);if(n){const r=this.bs(n);r&&this.Ds(r)}for(const r of this.As)this.Es(r);this.As=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.vs(this.ds)}isActiveQueryTarget(e){let n=!1;return this.ds.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Cs(e,"pending")}updateMutationState(e,n,r){this.Cs(e,n,r),this.Fs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(kl(this.persistenceKey,e));if(r){const i=Us.cs(e,r);i&&(n=i.state)}}return this.Ms.hs(e),this.Ss(),n}removeLocalQueryTarget(e){this.Ms.Ps(e),this.Ss()}isLocalQueryTarget(e){return this.Ms.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(kl(this.persistenceKey,e))}updateQueryState(e,n,r){this.xs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Fs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Os(e)}notifyBundleLoaded(e){this.Ns(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ts),this.removeItem(this.Rs),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return P("SharedClientState","READ",e,n),n}setItem(e,n){P("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){P("SharedClientState","REMOVE",e),this.storage.removeItem(e)}Es(e){const n=e;if(n.storageArea===this.storage){if(P("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Rs)return void $e("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.fs.test(n.key)){if(n.newValue==null){const r=this.Bs(n.key);return this.Ls(r,null)}{const r=this.ks(n.key,n.newValue);if(r)return this.Ls(r.clientId,r)}}else if(this.gs.test(n.key)){if(n.newValue!==null){const r=this.qs(n.key,n.newValue);if(r)return this.Qs(r)}}else if(this.ps.test(n.key)){if(n.newValue!==null){const r=this.Ks(n.key,n.newValue);if(r)return this.$s(r)}}else if(n.key===this.ys){if(n.newValue!==null){const r=this.bs(n.newValue);if(r)return this.Ds(r)}}else if(n.key===this.Vs){const r=function(s){let o=Dt.ae;if(s!=null)try{const a=JSON.parse(s);K(typeof a=="number"),o=a}catch(a){$e("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Dt.ae&&this.sequenceNumberHandler(r)}else if(n.key===this.ws){const r=this.Us(n.newValue);await Promise.all(r.map(i=>this.syncEngine.Ws(i)))}}}else this.As.push(n)})}}get Ms(){return this.ds.get(this.Is)}Ss(){this.setItem(this.Rs,this.Ms.ls())}Cs(e,n,r){const i=new rc(this.currentUser,e,n,r),s=om(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ls())}Fs(e){const n=om(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Os(e){const n={clientId:this.Is,onlineState:e};this.storage.setItem(this.ys,JSON.stringify(n))}xs(e,n,r){const i=kl(this.persistenceKey,e),s=new Us(e,n,r);this.setItem(i,s.ls())}Ns(e){const n=JSON.stringify(Array.from(e));this.setItem(this.ws,n)}Bs(e){const n=this.fs.exec(e);return n?n[1]:null}ks(e,n){const r=this.Bs(e);return ic.cs(r,n)}qs(e,n){const r=this.gs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return rc.cs(new tt(s),i,n)}Ks(e,n){const r=this.ps.exec(e),i=Number(r[1]);return Us.cs(i,n)}bs(e){return vd.cs(e)}Us(e){return JSON.parse(e)}async Qs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Gs(e.batchId,e.state,e.error);P("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}$s(e){return this.syncEngine.zs(e.targetId,e.state,e.error)}Ls(e,n){const r=n?this.ds.insert(e,n):this.ds.remove(e),i=this.vs(this.ds),s=this.vs(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.js(o,a).then(()=>{this.ds=r})}Ds(e){this.ds.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}vs(e){let n=id();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class Bv{constructor(){this.Hs=new Fu,this.Js={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Hs.hs(e),this.Js[e]||"not-current"}updateQueryState(e,n,r){this.Js[e]=n}removeLocalQueryTarget(e){this.Hs.Ps(e)}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){delete this.Js[e]}getAllActiveQueryTargets(){return this.Hs.activeTargetIds}isActiveQueryTarget(e){return this.Hs.activeTargetIds.has(e)}start(){return this.Hs=new Fu,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{Ys(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(){this.Zs=()=>this.Xs(),this.eo=()=>this.no(),this.ro=[],this.io()}Ys(e){this.ro.push(e)}shutdown(){window.removeEventListener("online",this.Zs),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Zs),window.addEventListener("offline",this.eo)}Xs(){P("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ro)e(0)}no(){P("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ro)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ma=null;function Fl(){return ma===null?ma=function(){return 268435456+Math.round(2147483648*Math.random())}():ma++,"0x"+ma.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e){this.so=e.so,this.oo=e.oo}_o(e){this.ao=e}uo(e){this.co=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.so(e)}ho(){this.ao()}Po(e){this.co(e)}Io(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pt="WebChannelConnection";class iP extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.To=r+"://"+n.host,this.Eo=`projects/${i}/databases/${s}`,this.Ao=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Ro(){return!1}Vo(n,r,i,s,o){const a=Fl(),c=this.mo(n,r);P("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);const l={"google-cloud-resource-prefix":this.Eo,"x-goog-request-params":this.Ao};return this.fo(l,s,o),this.po(n,c,l,i).then(u=>(P("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw en("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",c,"request:",i),u})}yo(n,r,i,s,o,a){return this.Vo(n,r,i,s,o)}fo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+os}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}mo(n,r){const i=nP[n];return`${this.To}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}po(e,n,r,i){const s=Fl();return new Promise((o,a)=>{const c=new eS;c.setWithCredentials(!0),c.listenOnce(X0.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Vl.NO_ERROR:const u=c.getResponseJson();P(pt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case Vl.TIMEOUT:P(pt,`RPC '${e}' ${s} timed out`),a(new S(E.DEADLINE_EXCEEDED,"Request time out"));break;case Vl.HTTP_ERROR:const h=c.getStatus();if(P(pt,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=d==null?void 0:d.error;if(f&&f.status&&f.message){const v=function(T){const R=T.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(R)>=0?R:E.UNKNOWN}(f.status);a(new S(v,f.message))}else a(new S(E.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new S(E.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{P(pt,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);P(pt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",l,r,15)})}wo(e,n,r){const i=Fl(),s=[this.To,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Q0(),a=Y0(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Z0({})),this.fo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const u=s.join("");P(pt,`Creating RPC '${e}' stream ${i}: ${u}`,c);const h=o.createWebChannel(u,c);let d=!1,f=!1;const v=new rP({so:T=>{f?P(pt,`Not sending because RPC '${e}' stream ${i} is closed:`,T):(d||(P(pt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),P(pt,`RPC '${e}' stream ${i} sending:`,T),h.send(T))},oo:()=>h.close()}),I=(T,R,x)=>{T.listen(R,O=>{try{x(O)}catch(V){setTimeout(()=>{throw V},0)}})};return I(h,ca.EventType.OPEN,()=>{f||P(pt,`RPC '${e}' stream ${i} transport opened.`)}),I(h,ca.EventType.CLOSE,()=>{f||(f=!0,P(pt,`RPC '${e}' stream ${i} transport closed`),v.Po())}),I(h,ca.EventType.ERROR,T=>{f||(f=!0,en(pt,`RPC '${e}' stream ${i} transport errored:`,T),v.Po(new S(E.UNAVAILABLE,"The operation could not be completed")))}),I(h,ca.EventType.MESSAGE,T=>{var R;if(!f){const x=T.data[0];K(!!x);const O=x,V=O.error||((R=O[0])===null||R===void 0?void 0:R.error);if(V){P(pt,`RPC '${e}' stream ${i} received error:`,V);const W=V.status;let J=function(Ae){const me=ze[Ae];if(me!==void 0)return sv(me)}(W),pe=V.message;J===void 0&&(J=E.INTERNAL,pe="Unknown error status: "+W+" with message "+V.message),f=!0,v.Po(new S(J,pe)),h.close()}else P(pt,`RPC '${e}' stream ${i} received:`,x),v.Io(x)}}),I(a,J0.STAT_EVENT,T=>{T.stat===mp.PROXY?P(pt,`RPC '${e}' stream ${i} detected buffering proxy`):T.stat===mp.NOPROXY&&P(pt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.ho()},0),v}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(){return typeof window<"u"?window:null}function Ra(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(t){return new dR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=n,this.So=r,this.bo=i,this.Do=s,this.vo=0,this.Co=null,this.Fo=Date.now(),this.reset()}reset(){this.vo=0}Mo(){this.vo=this.Do}xo(e){this.cancel();const n=Math.floor(this.vo+this.Oo()),r=Math.max(0,Date.now()-this.Fo),i=Math.max(0,n-r);i>0&&P("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.vo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Co=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Fo=Date.now(),e())),this.vo*=this.bo,this.vo<this.So&&(this.vo=this.So),this.vo>this.Do&&(this.vo=this.Do)}No(){this.Co!==null&&(this.Co.skipDelay(),this.Co=null)}cancel(){this.Co!==null&&(this.Co.cancel(),this.Co=null)}Oo(){return(Math.random()-.5)*this.vo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e,n,r,i,s,o,a,c){this.ii=e,this.Bo=r,this.Lo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.ko=0,this.qo=null,this.Qo=null,this.stream=null,this.Ko=new Id(e,n)}$o(){return this.state===1||this.state===5||this.Uo()}Uo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Wo()}async stop(){this.$o()&&await this.close(0)}Go(){this.state=0,this.Ko.reset()}zo(){this.Uo()&&this.qo===null&&(this.qo=this.ii.enqueueAfterDelay(this.Bo,6e4,()=>this.jo()))}Ho(e){this.Jo(),this.stream.send(e)}async jo(){if(this.Uo())return this.close(0)}Jo(){this.qo&&(this.qo.cancel(),this.qo=null)}Yo(){this.Qo&&(this.Qo.cancel(),this.Qo=null)}async close(e,n){this.Jo(),this.Yo(),this.Ko.cancel(),this.ko++,e!==4?this.Ko.reset():n&&n.code===E.RESOURCE_EXHAUSTED?($e(n.toString()),$e("Using maximum backoff delay to prevent overloading the backend."),this.Ko.Mo()):n&&n.code===E.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Zo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.uo(n)}Zo(){}auth(){this.state=1;const e=this.Xo(this.ko),n=this.ko;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.ko===n&&this.e_(r,i)},r=>{e(()=>{const i=new S(E.UNKNOWN,"Fetching auth token failed: "+r.message);return this.t_(i)})})}e_(e,n){const r=this.Xo(this.ko);this.stream=this.n_(e,n),this.stream._o(()=>{r(()=>(this.state=2,this.Qo=this.ii.enqueueAfterDelay(this.Lo,1e4,()=>(this.Uo()&&(this.state=3),Promise.resolve())),this.listener._o()))}),this.stream.uo(i=>{r(()=>this.t_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Wo(){this.state=5,this.Ko.xo(async()=>{this.state=0,this.start()})}t_(e){return P("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return n=>{this.ii.enqueueAndForget(()=>this.ko===e?n():(P("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sP extends $v{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}n_(e,n){return this.connection.wo("Listen",e,n)}onMessage(e){this.Ko.reset();const n=mR(this.serializer,e),r=function(s){if(!("targetChange"in s))return j.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?j.min():o.readTime?Ge(o.readTime):j.min()}(e);return this.listener.r_(n,r)}i_(e){const n={};n.database=mo(this.serializer),n.addTarget=function(s,o){let a;const c=o.target;if(a=Ya(c)?{documents:pv(s,c)}:{query:mv(s,c)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=lv(s,o.resumeToken);const l=xu(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(j.min())>0){a.readTime=Ki(s,o.snapshotVersion.toTimestamp());const l=xu(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);const r=_R(this.serializer,e);r&&(n.labels=r),this.Ho(n)}s_(e){const n={};n.database=mo(this.serializer),n.removeTarget=e,this.Ho(n)}}class oP extends $v{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.o_=!1}get __(){return this.o_}start(){this.o_=!1,this.lastStreamToken=void 0,super.start()}Zo(){this.o_&&this.a_([])}n_(e,n){return this.connection.wo("Write",e,n)}onMessage(e){if(K(!!e.streamToken),this.lastStreamToken=e.streamToken,this.o_){this.Ko.reset();const n=gR(e.writeResults,e.commitTime),r=Ge(e.commitTime);return this.listener.u_(r,n)}return K(!e.writeResults||e.writeResults.length===0),this.o_=!0,this.listener.c_()}l_(){const e={};e.database=mo(this.serializer),this.Ho(e)}a_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>go(this.serializer,r))};this.Ho(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.h_=!1}P_(){if(this.h_)throw new S(E.FAILED_PRECONDITION,"The client has already been terminated.")}Vo(e,n,r){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Vo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new S(E.UNKNOWN,i.toString())})}yo(e,n,r,i){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.yo(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new S(E.UNKNOWN,s.toString())})}terminate(){this.h_=!0}}class cP{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.T_=0,this.E_=null,this.d_=!0}A_(){this.T_===0&&(this.R_("Unknown"),this.E_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.E_=null,this.V_("Backend didn't respond within 10 seconds."),this.R_("Offline"),Promise.resolve())))}m_(e){this.state==="Online"?this.R_("Unknown"):(this.T_++,this.T_>=1&&(this.f_(),this.V_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.R_("Offline")))}set(e){this.f_(),this.T_=0,e==="Online"&&(this.d_=!1),this.R_(e)}R_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}V_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.d_?($e(n),this.d_=!1):P("OnlineStateTracker",n)}f_(){this.E_!==null&&(this.E_.cancel(),this.E_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.g_=[],this.p_=new Map,this.y_=new Set,this.w_=[],this.S_=s,this.S_.Ys(o=>{r.enqueueAndForget(async()=>{yr(this)&&(P("RemoteStore","Restarting streams for network reachability change."),await async function(c){const l=L(c);l.y_.add(4),await us(l),l.b_.set("Unknown"),l.y_.delete(4),await zo(l)}(this))})}),this.b_=new cP(r,i)}}async function zo(t){if(yr(t))for(const e of t.w_)await e(!0)}async function us(t){for(const e of t.w_)await e(!1)}function Yc(t,e){const n=L(t);n.p_.has(e.targetId)||(n.p_.set(e.targetId,e),wd(n)?Td(n):ds(n).Uo()&&Ed(n,e))}function _o(t,e){const n=L(t),r=ds(n);n.p_.delete(e),r.Uo()&&qv(n,e),n.p_.size===0&&(r.Uo()?r.zo():yr(n)&&n.b_.set("Unknown"))}function Ed(t,e){if(t.D_.Be(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ds(t).i_(e)}function qv(t,e){t.D_.Be(e),ds(t).s_(e)}function Td(t){t.D_=new cR({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.p_.get(e)||null,rt:()=>t.datastore.serializer.databaseId}),ds(t).start(),t.b_.A_()}function wd(t){return yr(t)&&!ds(t).$o()&&t.p_.size>0}function yr(t){return L(t).y_.size===0}function Gv(t){t.D_=void 0}async function uP(t){t.p_.forEach((e,n)=>{Ed(t,e)})}async function hP(t,e){Gv(t),wd(t)?(t.b_.m_(e),Td(t)):t.b_.set("Unknown")}async function dP(t,e,n){if(t.b_.set("Online"),e instanceof cv&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.p_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.p_.delete(a),i.D_.removeTarget(a))}(t,e)}catch(r){P("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await sc(t,r)}else if(e instanceof Sa?t.D_.We(e):e instanceof av?t.D_.Ze(e):t.D_.je(e),!n.isEqual(j.min()))try{const r=await Ov(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.D_.st(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.p_.get(l);u&&s.p_.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{const u=s.p_.get(c);if(!u)return;s.p_.set(c,u.withResumeToken(Ze.EMPTY_BYTE_STRING,u.snapshotVersion)),qv(s,c);const h=new wn(u.target,c,l,u.sequenceNumber);Ed(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){P("RemoteStore","Failed to raise snapshot:",r),await sc(t,r)}}async function sc(t,e,n){if(!gr(e))throw e;t.y_.add(1),await us(t),t.b_.set("Offline"),n||(n=()=>Ov(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{P("RemoteStore","Retrying IndexedDB access"),await n(),t.y_.delete(1),await zo(t)})}function jv(t,e){return e().catch(n=>sc(t,n,e))}async function hs(t){const e=L(t),n=lr(e);let r=e.g_.length>0?e.g_[e.g_.length-1].batchId:-1;for(;fP(e);)try{const i=await JR(e.localStore,r);if(i===null){e.g_.length===0&&n.zo();break}r=i.batchId,pP(e,i)}catch(i){await sc(e,i)}Kv(e)&&zv(e)}function fP(t){return yr(t)&&t.g_.length<10}function pP(t,e){t.g_.push(e);const n=lr(t);n.Uo()&&n.__&&n.a_(e.mutations)}function Kv(t){return yr(t)&&!lr(t).$o()&&t.g_.length>0}function zv(t){lr(t).start()}async function mP(t){lr(t).l_()}async function gP(t){const e=lr(t);for(const n of t.g_)e.a_(n.mutations)}async function _P(t,e,n){const r=t.g_.shift(),i=ad.from(r,e,n);await jv(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await hs(t)}async function yP(t,e){e&&lr(t).__&&await async function(r,i){if(function(o){return iv(o)&&o!==E.ABORTED}(i.code)){const s=r.g_.shift();lr(r).Go(),await jv(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await hs(r)}}(t,e),Kv(t)&&zv(t)}async function cm(t,e){const n=L(t);n.asyncQueue.verifyOperationInProgress(),P("RemoteStore","RemoteStore received new credentials");const r=yr(n);n.y_.add(3),await us(n),r&&n.b_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.y_.delete(3),await zo(n)}async function Lu(t,e){const n=L(t);e?(n.y_.delete(2),await zo(n)):e||(n.y_.add(2),await us(n),n.b_.set("Unknown"))}function ds(t){return t.v_||(t.v_=function(n,r,i){const s=L(n);return s.P_(),new sP(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{_o:uP.bind(null,t),uo:hP.bind(null,t),r_:dP.bind(null,t)}),t.w_.push(async e=>{e?(t.v_.Go(),wd(t)?Td(t):t.b_.set("Unknown")):(await t.v_.stop(),Gv(t))})),t.v_}function lr(t){return t.C_||(t.C_=function(n,r,i){const s=L(n);return s.P_(),new oP(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{_o:mP.bind(null,t),uo:yP.bind(null,t),c_:gP.bind(null,t),u_:_P.bind(null,t)}),t.w_.push(async e=>{e?(t.C_.Go(),await hs(t)):(await t.C_.stop(),t.g_.length>0&&(P("RemoteStore",`Stopping write stream with ${t.g_.length} pending writes`),t.g_=[]))})),t.C_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new rt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Ad(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new S(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fs(t,e){if($e("AsyncQueue",`${e}: ${t}`),gr(t))return new S(E.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e){this.comparator=e?(n,r)=>e(n,r)||k.comparator(n.key,r.key):(n,r)=>k.comparator(n.key,r.key),this.keyedMap=Ds(),this.sortedSet=new Ce(this.comparator)}static emptySet(e){return new ki(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ki)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ki;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(){this.F_=new Ce(k.comparator)}track(e){const n=e.doc.key,r=this.F_.get(n);r?e.type!==0&&r.type===3?this.F_=this.F_.insert(n,e):e.type===3&&r.type!==1?this.F_=this.F_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.F_=this.F_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.F_=this.F_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.F_=this.F_.remove(n):e.type===1&&r.type===2?this.F_=this.F_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.F_=this.F_.insert(n,{type:2,doc:e.doc}):$():this.F_=this.F_.insert(n,e)}M_(){const e=[];return this.F_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Wi{constructor(e,n,r,i,s,o,a,c,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Wi(e,n,ki.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(){this.x_=void 0,this.listeners=[]}}class IP{constructor(){this.queries=new _r(e=>Gy(e),Uo),this.onlineState="Unknown",this.O_=new Set}}async function bd(t,e){const n=L(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new vP),i)try{s.x_=await n.onListen(r)}catch(o){const a=fs(o,`Initialization of query '${Du(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.N_(n.onlineState),s.x_&&e.B_(s.x_)&&Rd(n)}async function Sd(t,e){const n=L(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function EP(t,e){const n=L(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.B_(i)&&(r=!0);o.x_=i}}r&&Rd(n)}function TP(t,e,n){const r=L(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function Rd(t){t.O_.forEach(e=>{e.next()})}class Pd{constructor(e,n,r){this.query=e,this.L_=n,this.k_=!1,this.q_=null,this.onlineState="Unknown",this.options=r||{}}B_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Wi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.k_?this.Q_(e)&&(this.L_.next(e),n=!0):this.K_(e,this.onlineState)&&(this.U_(e),n=!0),this.q_=e,n}onError(e){this.L_.error(e)}N_(e){this.onlineState=e;let n=!1;return this.q_&&!this.k_&&this.K_(this.q_,e)&&(this.U_(this.q_),n=!0),n}K_(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.W_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Q_(e){if(e.docChanges.length>0)return!0;const n=this.q_&&this.q_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}U_(e){e=Wi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.k_=!0,this.L_.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,n){this.G_=e,this.byteLength=n}z_(){return"metadata"in this.G_}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e){this.serializer=e}os(e){return pn(this.serializer,e)}_s(e){return e.metadata.exists?fv(this.serializer,e.document,!1):Ve.newNoDocument(this.os(e.metadata.name),this.us(e.metadata.readTime))}us(e){return Ge(e)}}class AP{constructor(e,n,r){this.j_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Hv(e)}H_(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.G_.namedQuery)this.queries.push(e.G_.namedQuery);else if(e.G_.documentMetadata){this.documents.push({metadata:e.G_.documentMetadata}),e.G_.documentMetadata.exists||++n;const r=le.fromString(e.G_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.G_.document&&(this.documents[this.documents.length-1].document=e.G_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}J_(e){const n=new Map,r=new um(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.os(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||re()).add(s);n.set(o,a)}}return n}async complete(){const e=await ZR(this.localStore,new um(this.serializer),this.documents,this.j_.id),n=this.J_(this.documents);for(const r of this.queries)await eP(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Y_:this.collectionGroups,Z_:e}}}function Hv(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e){this.key=e}}class Qv{constructor(e){this.key=e}}class Yv{constructor(e,n){this.query=e,this.X_=n,this.ea=null,this.hasCachedResults=!1,this.current=!1,this.ta=re(),this.mutatedKeys=re(),this.na=Ky(e),this.ra=new ki(this.na)}get ia(){return this.X_}sa(e,n){const r=n?n.oa:new lm,i=n?n.ra:this.ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const d=i.get(u),f=$o(this.query,h)?h:null,v=!!d&&this.mutatedKeys.has(d.key),I=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let T=!1;d&&f?d.data.isEqual(f.data)?v!==I&&(r.track({type:3,doc:f}),T=!0):this._a(d,f)||(r.track({type:2,doc:f}),T=!0,(c&&this.na(f,c)>0||l&&this.na(f,l)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),T=!0):d&&!f&&(r.track({type:1,doc:d}),T=!0,(c||l)&&(a=!0)),T&&(f?(o=o.add(f),s=I?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{ra:o,oa:r,zi:a,mutatedKeys:s}}_a(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.ra;this.ra=e.ra,this.mutatedKeys=e.mutatedKeys;const s=e.oa.M_();s.sort((l,u)=>function(d,f){const v=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return v(d)-v(f)}(l.type,u.type)||this.na(l.doc,u.doc)),this.aa(r);const o=n?this.ua():[],a=this.ta.size===0&&this.current?1:0,c=a!==this.ea;return this.ea=a,s.length!==0||c?{snapshot:new Wi(this.query,e.ra,i,s,e.mutatedKeys,a===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),ca:o}:{ca:o}}N_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ra:this.ra,oa:new lm,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{ca:[]}}la(e){return!this.X_.has(e)&&!!this.ra.has(e)&&!this.ra.get(e).hasLocalMutations}aa(e){e&&(e.addedDocuments.forEach(n=>this.X_=this.X_.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.X_=this.X_.delete(n)),this.current=e.current)}ua(){if(!this.current)return[];const e=this.ta;this.ta=re(),this.ra.forEach(r=>{this.la(r.key)&&(this.ta=this.ta.add(r.key))});const n=[];return e.forEach(r=>{this.ta.has(r)||n.push(new Qv(r))}),this.ta.forEach(r=>{e.has(r)||n.push(new Wv(r))}),n}ha(e){this.X_=e.ss,this.ta=re();const n=this.sa(e.documents);return this.applyChanges(n,!0)}Pa(){return Wi.fromInitialDocuments(this.query,this.ra,this.mutatedKeys,this.ea===0,this.hasCachedResults)}}class bP{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class SP{constructor(e){this.key=e,this.Ia=!1}}class RP{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ta={},this.Ea=new _r(a=>Gy(a),Uo),this.da=new Map,this.Aa=new Set,this.Ra=new Ce(k.comparator),this.Va=new Map,this.ma=new md,this.fa={},this.ga=new Map,this.pa=ei.On(),this.onlineState="Unknown",this.ya=void 0}get isPrimaryClient(){return this.ya===!0}}async function PP(t,e){const n=Nd(t);let r,i;const s=n.Ea.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Pa();else{const o=await zi(n.localStore,Ot(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await Cd(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&Yc(n.remoteStore,o)}return i}async function Cd(t,e,n,r,i){t.wa=(h,d,f)=>async function(I,T,R,x){let O=T.view.sa(R);O.zi&&(O=await nc(I.localStore,T.query,!1).then(({documents:J})=>T.view.sa(J,O)));const V=x&&x.targetChanges.get(T.targetId),W=T.view.applyChanges(O,I.isPrimaryClient,V);return Bu(I,T.targetId,W.ca),W.snapshot}(t,h,d,f);const s=await nc(t.localStore,e,!0),o=new Yv(e,s.ss),a=o.sa(s.documents),c=jo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),l=o.applyChanges(a,t.isPrimaryClient,c);Bu(t,n,l.ca);const u=new bP(e,n,o);return t.Ea.set(e,u),t.da.has(n)?t.da.get(n).push(e):t.da.set(n,[e]),l.snapshot}async function CP(t,e){const n=L(t),r=n.Ea.get(e),i=n.da.get(r.targetId);if(i.length>1)return n.da.set(r.targetId,i.filter(s=>!Uo(s,e))),void n.Ea.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Hi(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),_o(n.remoteStore,r.targetId),Qi(n,r.targetId)}).catch(mr)):(Qi(n,r.targetId),await Hi(n.localStore,r.targetId,!0))}async function DP(t,e,n){const r=Od(t);try{const i=await function(o,a){const c=L(o),l=ke.now(),u=a.reduce((f,v)=>f.add(v.key),re());let h,d;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let v=Vt(),I=re();return c.Xi.getEntries(f,u).next(T=>{v=T,v.forEach((R,x)=>{x.isValidDocument()||(I=I.add(R))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,v)).next(T=>{h=T;const R=[];for(const x of a){const O=sR(x,h.get(x.key).overlayedDocument);O!=null&&R.push(new xn(x.key,O,Oy(O.value.mapValue),Oe.exists(!0)))}return c.mutationQueue.addMutationBatch(f,l,R,a)}).next(T=>{d=T;const R=T.applyToLocalDocumentSet(h,I);return c.documentOverlayCache.saveOverlays(f,T.batchId,R)})}).then(()=>({batchId:d.batchId,changes:Hy(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.fa[o.currentUser.toKey()];l||(l=new Ce(ne)),l=l.insert(a,c),o.fa[o.currentUser.toKey()]=l}(r,i.batchId,n),await Vn(r,i.changes),await hs(r.remoteStore)}catch(i){const s=fs(i,"Failed to persist write");n.reject(s)}}async function Xv(t,e){const n=L(t);try{const r=await XR(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Va.get(s);o&&(K(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ia=!0:i.modifiedDocuments.size>0?K(o.Ia):i.removedDocuments.size>0&&(K(o.Ia),o.Ia=!1))}),await Vn(n,r,e)}catch(r){await mr(r)}}function hm(t,e,n){const r=L(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Ea.forEach((s,o)=>{const a=o.view.N_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const c=L(o);c.onlineState=a;let l=!1;c.queries.forEach((u,h)=>{for(const d of h.listeners)d.N_(a)&&(l=!0)}),l&&Rd(c)}(r.eventManager,e),i.length&&r.Ta.r_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function xP(t,e,n){const r=L(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Va.get(e),s=i&&i.key;if(s){let o=new Ce(k.comparator);o=o.insert(s,Ve.newNoDocument(s,j.min()));const a=re().add(s),c=new Go(j.min(),new Map,new Ce(ne),o,a);await Xv(r,c),r.Ra=r.Ra.remove(s),r.Va.delete(e),Vd(r)}else await Hi(r.localStore,e,!1).then(()=>Qi(r,e,n)).catch(mr)}async function VP(t,e){const n=L(t),r=e.batch.batchId;try{const i=await YR(n.localStore,e);xd(n,r,null),Dd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Vn(n,i)}catch(i){await mr(i)}}async function NP(t,e,n){const r=L(t);try{const i=await function(o,a){const c=L(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(K(h!==null),u=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(r.localStore,e);xd(r,e,n),Dd(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Vn(r,i)}catch(i){await mr(i)}}async function OP(t,e){const n=L(t);yr(n.remoteStore)||P("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=L(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ga.get(r)||[];i.push(e),n.ga.set(r,i)}catch(r){const i=fs(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Dd(t,e){(t.ga.get(e)||[]).forEach(n=>{n.resolve()}),t.ga.delete(e)}function xd(t,e,n){const r=L(t);let i=r.fa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.fa[r.currentUser.toKey()]=i}}function Qi(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.da.get(e))t.Ea.delete(r),n&&t.Ta.Sa(r,n);t.da.delete(e),t.isPrimaryClient&&t.ma.Ar(e).forEach(r=>{t.ma.containsKey(r)||Jv(t,r)})}function Jv(t,e){t.Aa.delete(e.path.canonicalString());const n=t.Ra.get(e);n!==null&&(_o(t.remoteStore,n),t.Ra=t.Ra.remove(e),t.Va.delete(n),Vd(t))}function Bu(t,e,n){for(const r of n)r instanceof Wv?(t.ma.addReference(r.key,e),kP(t,r)):r instanceof Qv?(P("SyncEngine","Document no longer in limbo: "+r.key),t.ma.removeReference(r.key,e),t.ma.containsKey(r.key)||Jv(t,r.key)):$()}function kP(t,e){const n=e.key,r=n.path.canonicalString();t.Ra.get(n)||t.Aa.has(r)||(P("SyncEngine","New document in limbo: "+n),t.Aa.add(r),Vd(t))}function Vd(t){for(;t.Aa.size>0&&t.Ra.size<t.maxConcurrentLimboResolutions;){const e=t.Aa.values().next().value;t.Aa.delete(e);const n=new k(le.fromString(e)),r=t.pa.next();t.Va.set(r,new SP(n)),t.Ra=t.Ra.insert(n,r),Yc(t.remoteStore,new wn(Ot(as(n.path)),r,"TargetPurposeLimboResolution",Dt.ae))}}async function Vn(t,e,n){const r=L(t),i=[],s=[],o=[];r.Ea.isEmpty()||(r.Ea.forEach((a,c)=>{o.push(r.wa(c,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l!=null&&l.fromCache?"not-current":"current"),l){i.push(l);const u=yd.qi(c.targetId,l);s.push(u)}}))}),await Promise.all(o),r.Ta.r_(i),await async function(c,l){const u=L(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>y.forEach(l,d=>y.forEach(d.Li,f=>u.persistence.referenceDelegate.addReference(h,d.targetId,f)).next(()=>y.forEach(d.ki,f=>u.persistence.referenceDelegate.removeReference(h,d.targetId,f)))))}catch(h){if(!gr(h))throw h;P("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const d=h.targetId;if(!h.fromCache){const f=u.Ji.get(d),v=f.snapshotVersion,I=f.withLastLimboFreeSnapshotVersion(v);u.Ji=u.Ji.insert(d,I)}}}(r.localStore,s))}async function MP(t,e){const n=L(t);if(!n.currentUser.isEqual(e)){P("SyncEngine","User change. New user:",e.toKey());const r=await Nv(n.localStore,e);n.currentUser=e,function(s,o){s.ga.forEach(a=>{a.forEach(c=>{c.reject(new S(E.CANCELLED,o))})}),s.ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Vn(n,r.ts)}}function FP(t,e){const n=L(t),r=n.Va.get(e);if(r&&r.Ia)return re().add(r.key);{let i=re();const s=n.da.get(e);if(!s)return i;for(const o of s){const a=n.Ea.get(o);i=i.unionWith(a.view.ia)}return i}}async function LP(t,e){const n=L(t),r=await nc(n.localStore,e.query,!0),i=e.view.ha(r);return n.isPrimaryClient&&Bu(n,e.targetId,i.ca),i}async function BP(t,e){const n=L(t);return Fv(n.localStore,e).then(r=>Vn(n,r))}async function UP(t,e,n,r){const i=L(t),s=await function(a,c){const l=L(a),u=L(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>u.Dn(h,c).next(d=>d?l.localDocuments.getDocuments(h,d):y.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await hs(i.remoteStore):n==="acknowledged"||n==="rejected"?(xd(i,e,r||null),Dd(i,e),function(a,c){L(L(a).mutationQueue).Cn(c)}(i.localStore,e)):$(),await Vn(i,s)):P("SyncEngine","Cannot apply mutation batch with id: "+e)}async function $P(t,e){const n=L(t);if(Nd(n),Od(n),e===!0&&n.ya!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await dm(n,r.toArray());n.ya=!0,await Lu(n.remoteStore,!0);for(const s of i)Yc(n.remoteStore,s)}else if(e===!1&&n.ya!==!1){const r=[];let i=Promise.resolve();n.da.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Qi(n,o),Hi(n.localStore,o,!0))),_o(n.remoteStore,o)}),await i,await dm(n,r),function(o){const a=L(o);a.Va.forEach((c,l)=>{_o(a.remoteStore,l)}),a.ma.Rr(),a.Va=new Map,a.Ra=new Ce(k.comparator)}(n),n.ya=!1,await Lu(n.remoteStore,!1)}}async function dm(t,e,n){const r=L(t),i=[],s=[];for(const o of e){let a;const c=r.da.get(o);if(c&&c.length!==0){a=await zi(r.localStore,Ot(c[0]));for(const l of c){const u=r.Ea.get(l),h=await LP(r,u);h.snapshot&&s.push(h.snapshot)}}else{const l=await Mv(r.localStore,o);a=await zi(r.localStore,l),await Cd(r,Zv(l),o,!1,a.resumeToken)}i.push(a)}return r.Ta.r_(s),i}function Zv(t){return qy(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function qP(t){return function(n){return L(L(n).persistence).Ni()}(L(t).localStore)}async function GP(t,e,n,r){const i=L(t);if(i.ya)return void P("SyncEngine","Ignoring unexpected query state notification.");const s=i.da.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await Fv(i.localStore,jy(s[0])),a=Go.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Ze.EMPTY_BYTE_STRING);await Vn(i,o,a);break}case"rejected":await Hi(i.localStore,e,!0),Qi(i,e,r);break;default:$()}}async function jP(t,e,n){const r=Nd(t);if(r.ya){for(const i of e){if(r.da.has(i)){P("SyncEngine","Adding an already active target "+i);continue}const s=await Mv(r.localStore,i),o=await zi(r.localStore,s);await Cd(r,Zv(s),o.targetId,!1,o.resumeToken),Yc(r.remoteStore,o)}for(const i of n)r.da.has(i)&&await Hi(r.localStore,i,!1).then(()=>{_o(r.remoteStore,i),Qi(r,i)}).catch(mr)}}function Nd(t){const e=L(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=FP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xP.bind(null,e),e.Ta.r_=EP.bind(null,e.eventManager),e.Ta.Sa=TP.bind(null,e.eventManager),e}function Od(t){const e=L(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NP.bind(null,e),e}function KP(t,e,n){const r=L(t);(async function(s,o,a){try{const c=await o.getMetadata();if(await function(f,v){const I=L(f),T=Ge(v.createTime);return I.persistence.runTransaction("hasNewerBundle","readonly",R=>I.Qr.getBundleMetadata(R,v.id)).then(R=>!!R&&R.createTime.compareTo(T)>=0)}(s.localStore,c))return await o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(Hv(c));const l=new AP(c,s.localStore,o.serializer);let u=await o.ba();for(;u;){const d=await l.H_(u);d&&a._updateProgress(d),u=await o.ba()}const h=await l.complete();return await Vn(s,h.Z_,void 0),await function(f,v){const I=L(f);return I.persistence.runTransaction("Save bundle","readwrite",T=>I.Qr.saveBundleMetadata(T,v))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.Y_)}catch(c){return en("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Uu{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Ko(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Vv(this.persistence,new xv,e.initialUser,this.serializer)}createPersistence(e){return new Dv(Qc.zr,this.serializer)}createSharedClientState(e){return new Bv}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class eI extends Uu{constructor(e,n,r){super(),this.Da=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Da.initialize(this,e),await Od(this.Da.syncEngine),await hs(this.Da.remoteStore),await this.persistence.Vi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return Vv(this.persistence,new xv,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new OR(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new _S(n,this.persistence);return new gS(e.asyncQueue,r)}createPersistence(e){const n=_d(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ct.withCacheSize(this.cacheSizeBytes):Ct.DEFAULT;return new gd(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Uv(),Ra(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Bv}}class zP extends eI{constructor(e,n){super(e,n,!1),this.Da=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Da.syncEngine;this.sharedClientState instanceof Ml&&(this.sharedClientState.syncEngine={Gs:UP.bind(null,n),zs:GP.bind(null,n),js:jP.bind(null,n),Ni:qP.bind(null,n),Ws:BP.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Vi(async r=>{await $P(this.Da.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=Uv();if(!Ml.v(n))throw new S(E.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=_d(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ml(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class kd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>hm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=MP.bind(null,this.syncEngine),await Lu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new IP}()}createDatastore(e){const n=Ko(e.databaseInfo.databaseId),r=function(s){return new iP(s)}(e.databaseInfo);return function(s,o,a,c){return new aP(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new lP(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>hm(this.syncEngine,n,0),function(){return am.v()?new am:new tP}())}createSyncEngine(e,n){return function(i,s,o,a,c,l,u){const h=new RP(i,s,o,a,c,l);return u&&(h.ya=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(n){const r=L(n);P("RemoteStore","RemoteStore shutting down."),r.y_.add(5),await us(r),r.S_.shutdown(),r.b_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fm(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.va(this.observer.next,e)}error(e){this.observer.error?this.va(this.observer.error,e):$e("Uncaught Error in snapshot listener:",e.toString())}Ca(){this.muted=!0}va(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e,n){this.Fa=e,this.serializer=n,this.metadata=new rt,this.buffer=new Uint8Array,this.Ma=function(){return new TextDecoder("utf-8")}(),this.xa().then(r=>{r&&r.z_()?this.metadata.resolve(r.G_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.G_)}`))},r=>this.metadata.reject(r))}close(){return this.Fa.cancel()}async getMetadata(){return this.metadata.promise}async ba(){return await this.getMetadata(),this.xa()}async xa(){const e=await this.Oa();if(e===null)return null;const n=this.Ma.decode(e),r=Number(n);isNaN(r)&&this.Na(`length string (${n}) is not valid number`);const i=await this.Ba(r);return new wP(JSON.parse(i),e.length+r)}La(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async Oa(){for(;this.La()<0&&!await this.ka(););if(this.buffer.length===0)return null;const e=this.La();e<0&&this.Na("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async Ba(e){for(;this.buffer.length<e;)await this.ka()&&this.Na("Reached the end of bundle when more is expected.");const n=this.Ma.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Na(e){throw this.Fa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ka(){const e=await this.Fa.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new S(E.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(i,s){const o=L(i),a=mo(o.serializer)+"/documents",c={documents:s.map(d=>po(o.serializer,d))},l=await o.yo("BatchGetDocuments",a,c,s.length),u=new Map;l.forEach(d=>{const f=pR(o.serializer,d);u.set(f.key.toString(),f)});const h=[];return s.forEach(d=>{const f=u.get(d.toString());K(!!f),h.push(f)}),h}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ls(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=k.fromPath(r);this.mutations.push(new sd(i,this.precondition(i)))}),await async function(r,i){const s=L(r),o=mo(s.serializer)+"/documents",a={writes:i.map(c=>go(s.serializer,c))};await s.Vo("Commit",o,a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw $();n=j.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new S(E.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(j.min())?Oe.exists(!1):Oe.updateTime(n):Oe.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(j.min()))throw new S(E.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Oe.updateTime(n)}return Oe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.qa=r.maxAttempts,this.Ko=new Id(this.asyncQueue,"transaction_retry")}run(){this.qa-=1,this.Qa()}Qa(){this.Ko.xo(async()=>{const e=new WP(this.datastore),n=this.Ka(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.$a(i)}))}).catch(r=>{this.$a(r)})})}Ka(e){try{const n=this.updateFunction(e);return!Lo(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}$a(e){this.qa>0&&this.Ua(e)?(this.qa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Qa(),Promise.resolve()))):this.deferred.reject(e)}Ua(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!iv(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=tt.UNAUTHENTICATED,this.clientId=vy.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{P("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(P("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new S(E.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=fs(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Pa(t,e){t.asyncQueue.verifyOperationInProgress(),P("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Nv(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $u(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Md(t);P("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>cm(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>cm(e.remoteStore,s)),t._onlineComponents=e}function tI(t){return t.name==="FirebaseError"?t.code===E.FAILED_PRECONDITION||t.code===E.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function Md(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){P("FirestoreClient","Using user provided OfflineComponentProvider");try{await Pa(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!tI(n))throw n;en("Error using user provided cache. Falling back to memory cache: "+n),await Pa(t,new Uu)}}else P("FirestoreClient","Using default OfflineComponentProvider"),await Pa(t,new Uu);return t._offlineComponents}async function Jc(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(P("FirestoreClient","Using user provided OnlineComponentProvider"),await $u(t,t._uninitializedComponentsProvider._online)):(P("FirestoreClient","Using default OnlineComponentProvider"),await $u(t,new kd))),t._onlineComponents}function nI(t){return Md(t).then(e=>e.persistence)}function Fd(t){return Md(t).then(e=>e.localStore)}function rI(t){return Jc(t).then(e=>e.remoteStore)}function Ld(t){return Jc(t).then(e=>e.syncEngine)}function XP(t){return Jc(t).then(e=>e.datastore)}async function Yi(t){const e=await Jc(t),n=e.eventManager;return n.onListen=PP.bind(null,e.syncEngine),n.onUnlisten=CP.bind(null,e.syncEngine),n}function JP(t){return t.asyncQueue.enqueue(async()=>{const e=await nI(t),n=await rI(t);return e.setNetworkEnabled(!0),function(i){const s=L(i);return s.y_.delete(0),zo(s)}(n)})}function ZP(t){return t.asyncQueue.enqueue(async()=>{const e=await nI(t),n=await rI(t);return e.setNetworkEnabled(!1),async function(i){const s=L(i);s.y_.add(0),await us(s),s.b_.set("Offline")}(n)})}function eC(t,e){const n=new rt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await function(l,u){const h=L(l);return h.persistence.runTransaction("read document","readonly",d=>h.localDocuments.getDocument(d,u))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new S(E.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const c=fs(a,`Failed to get document '${s} from cache`);o.reject(c)}}(await Fd(t),e,n)),n.promise}function iI(t,e,n={}){const r=new rt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,l){const u=new Xc({next:d=>{o.enqueueAndForget(()=>Sd(s,h));const f=d.docs.has(a);!f&&d.fromCache?l.reject(new S(E.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&d.fromCache&&c&&c.source==="server"?l.reject(new S(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new Pd(as(a.path),u,{includeMetadataChanges:!0,W_:!0});return bd(s,h)}(await Yi(t),t.asyncQueue,e,n,r)),r.promise}function tC(t,e){const n=new rt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await nc(i,s,!0),c=new Yv(s,a.ss),l=c.sa(a.documents),u=c.applyChanges(l,!1);o.resolve(u.snapshot)}catch(a){const c=fs(a,`Failed to execute query '${s} against cache`);o.reject(c)}}(await Fd(t),e,n)),n.promise}function sI(t,e,n={}){const r=new rt;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,l){const u=new Xc({next:d=>{o.enqueueAndForget(()=>Sd(s,h)),d.fromCache&&c.source==="server"?l.reject(new S(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new Pd(a,u,{includeMetadataChanges:!0,W_:!0});return bd(s,h)}(await Yi(t),t.asyncQueue,e,n,r)),r.promise}function nC(t,e){const n=new Xc(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){L(i).O_.add(s),s.next()}(await Yi(t),n)),()=>{n.Ca(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){L(i).O_.delete(s)}(await Yi(t),n))}}function rC(t,e,n,r){const i=function(o,a){let c;return c=typeof o=="string"?ov().encode(o):o,function(u,h){return new HP(u,h)}(function(u,h){if(u instanceof Uint8Array)return fm(u,h);if(u instanceof ArrayBuffer)return fm(new Uint8Array(u),h);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,Ko(e));t.asyncQueue.enqueueAndForget(async()=>{KP(await Ld(t),i,r)})}function iC(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=L(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Qr.getNamedQuery(o,i))}(await Fd(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bd(t,e,n){if(!n)throw new S(E.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function aI(t,e,n,r){if(e===!0&&r===!0)throw new S(E.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function mm(t){if(!k.isDocumentKey(t))throw new S(E.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function gm(t){if(k.isDocumentKey(t))throw new S(E.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Zc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":$()}function he(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new S(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Zc(t);throw new S(E.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function cI(t,e){if(e<=0)throw new S(E.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new S(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new S(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}aI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new S(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new S(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new S(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ho{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _m({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new S(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new S(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _m(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new iS;switch(r.type){case"firstParty":return new cS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new S(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=pm.get(n);r&&(P("ComponentProvider","Removing Datastore"),pm.delete(n),r.terminate())}(this),Promise.resolve()}}function sC(t,e,n,r={}){var i;const s=(t=he(t,Ho))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&en("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=tt.MOCK_USER;else{a=vA(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new S(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new tt(l)}t._authCredentials=new sS(new yy(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let St=class lI{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new lI(this.firestore,e,this._query)}},Me=class uI{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new uI(this.firestore,e,this._key)}},Jn=class hI extends St{constructor(e,n,r){super(e,n,as(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new k(e))}withConverter(e){return new hI(this.firestore,e,this._path)}};function dI(t,e,...n){if(t=Qe(t),Bd("collection","path",e),t instanceof Ho){const r=le.fromString(e,...n);return gm(r),new Jn(t,null,r)}{if(!(t instanceof Me||t instanceof Jn))throw new S(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(le.fromString(e,...n));return gm(r),new Jn(t.firestore,null,r)}}function oC(t,e){if(t=he(t,Ho),Bd("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new S(E.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new St(t,null,function(r){return new Dn(le.emptyPath(),r)}(e))}function oc(t,e,...n){if(t=Qe(t),arguments.length===1&&(e=vy.V()),Bd("doc","path",e),t instanceof Ho){const r=le.fromString(e,...n);return mm(r),new Me(t,null,new k(r))}{if(!(t instanceof Me||t instanceof Jn))throw new S(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(le.fromString(e,...n));return mm(r),new Me(t.firestore,t instanceof Jn?t.converter:null,new k(r))}}function fI(t,e){return t=Qe(t),e=Qe(e),(t instanceof Me||t instanceof Jn)&&(e instanceof Me||e instanceof Jn)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function pI(t,e){return t=Qe(t),e=Qe(e),t instanceof St&&e instanceof St&&t.firestore===e.firestore&&Uo(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(){this.Wa=Promise.resolve(),this.Ga=[],this.za=!1,this.ja=[],this.Ha=null,this.Ja=!1,this.Ya=!1,this.Za=[],this.Ko=new Id(this,"async_queue_retry"),this.Xa=()=>{const n=Ra();n&&P("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Ko.No()};const e=Ra();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xa)}get isShuttingDown(){return this.za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.eu(),this.tu(e)}enterRestrictedMode(e){if(!this.za){this.za=!0,this.Ya=e||!1;const n=Ra();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Xa)}}enqueue(e){if(this.eu(),this.za)return new Promise(()=>{});const n=new rt;return this.tu(()=>this.za&&this.Ya?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ga.push(e),this.nu()))}async nu(){if(this.Ga.length!==0){try{await this.Ga[0](),this.Ga.shift(),this.Ko.reset()}catch(e){if(!gr(e))throw e;P("AsyncQueue","Operation failed with retryable error: "+e)}this.Ga.length>0&&this.Ko.xo(()=>this.nu())}}tu(e){const n=this.Wa.then(()=>(this.Ja=!0,e().catch(r=>{this.Ha=r,this.Ja=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw $e("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ja=!1,r))));return this.Wa=n,n}enqueueAfterDelay(e,n,r){this.eu(),this.Za.indexOf(e)>-1&&(n=0);const i=Ad.createAndSchedule(this,e,n,r,s=>this.ru(s));return this.ja.push(i),i}eu(){this.Ha&&$()}verifyOperationInProgress(){}async iu(){let e;do e=this.Wa,await e;while(e!==this.Wa)}su(e){for(const n of this.ja)if(n.timerId===e)return!0;return!1}ou(e){return this.iu().then(()=>{this.ja.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ja)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.iu()})}_u(e){this.Za.push(e)}ru(e){const n=this.ja.indexOf(e);this.ja.splice(n,1)}}function qu(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class cC{constructor(){this._progressObserver={},this._taskCompletionResolver=new rt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC=-1;let Be=class extends Ho{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new aC}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||mI(this),this._firestoreClient.terminate()}};function at(t){return t._firestoreClient||mI(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function mI(t){var e,n,r;const i=t._freezeSettings(),s=function(a,c,l,u){return new LS(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,oI(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new YP(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function uC(t,e){_I(t=he(t,Be));const n=at(t);if(n._uninitializedComponentsProvider)throw new S(E.FAILED_PRECONDITION,"SDK cache is already specified.");en("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new kd;return gI(n,i,new eI(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function hC(t){_I(t=he(t,Be));const e=at(t);if(e._uninitializedComponentsProvider)throw new S(E.FAILED_PRECONDITION,"SDK cache is already specified.");en("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new kd;return gI(e,r,new zP(r,n.cacheSizeBytes))}function gI(t,e,n){const r=new rt;return t.asyncQueue.enqueue(async()=>{try{await Pa(t,n),await $u(t,e),r.resolve()}catch(i){const s=i;if(!tI(s))throw s;en("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function dC(t){if(t._initialized&&!t._terminated)throw new S(E.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new rt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Yt.v())return Promise.resolve();const i=r+"main";await Yt.delete(i)}(_d(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function fC(t){return function(n){const r=new rt;return n.asyncQueue.enqueueAndForget(async()=>OP(await Ld(n),r)),r.promise}(at(t=he(t,Be)))}function pC(t){return JP(at(t=he(t,Be)))}function mC(t){return ZP(at(t=he(t,Be)))}function gC(t,e){const n=at(t=he(t,Be)),r=new cC;return rC(n,t._databaseId,e,r),r}function _C(t,e){return iC(at(t=he(t,Be)),e).then(n=>n?new St(t,null,n.query):null)}function _I(t){if(t._initialized||t._terminated)throw new S(E.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _n(Ze.fromBase64String(e))}catch(n){throw new S(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new _n(Ze.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ur=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new S(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oi=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new S(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new S(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=/^__.*__$/;class vC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new xn(e,this.data,this.fieldMask,n,this.fieldTransforms):new cs(e,this.data,n,this.fieldTransforms)}}class yI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new xn(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function vI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}class tl{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.au(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get uu(){return this.settings.uu}cu(e){return new tl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}lu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.cu({path:r,hu:!1});return i.Pu(e),i}Iu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.cu({path:r,hu:!1});return i.au(),i}Tu(e){return this.cu({path:void 0,hu:!0})}Eu(e){return ac(e,this.settings.methodName,this.settings.du||!1,this.path,this.settings.Au)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}au(){if(this.path)for(let e=0;e<this.path.length;e++)this.Pu(this.path.get(e))}Pu(e){if(e.length===0)throw this.Eu("Document fields must not be empty");if(vI(this.uu)&&yC.test(e))throw this.Eu('Document fields cannot begin and end with "__"')}}class IC{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ko(e)}Ru(e,n,r,i=!1){return new tl({uu:e,methodName:n,Au:r,path:qe.emptyPath(),hu:!1,du:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ai(t){const e=t._freezeSettings(),n=Ko(t._databaseId);return new IC(t._databaseId,!!e.ignoreUndefinedProperties,n)}function nl(t,e,n,r,i,s={}){const o=t.Ru(s.merge||s.mergeFields?2:0,e,n,i);Gd("Data must be an object, but it was:",o,r);const a=TI(r,o);let c,l;if(s.merge)c=new xt(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=Gu(e,h,n);if(!o.contains(d))throw new S(E.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);AI(u,d)||u.push(d)}c=new xt(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new vC(new ut(a),c,l)}class Wo extends oi{_toFieldTransform(e){if(e.uu!==2)throw e.uu===1?e.Eu(`${this._methodName}() can only appear at the top level of your update data`):e.Eu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Wo}}function II(t,e,n){return new tl({uu:3,Au:e.settings.Au,methodName:t._methodName,hu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Ud extends oi{_toFieldTransform(e){return new qo(e.path,new Gi)}isEqual(e){return e instanceof Ud}}class EC extends oi{constructor(e,n){super(e),this.Vu=n}_toFieldTransform(e){const n=II(this,e,!0),r=this.Vu.map(s=>ci(s,n)),i=new Yr(r);return new qo(e.path,i)}isEqual(e){return this===e}}class TC extends oi{constructor(e,n){super(e),this.Vu=n}_toFieldTransform(e){const n=II(this,e,!0),r=this.Vu.map(s=>ci(s,n)),i=new Xr(r);return new qo(e.path,i)}isEqual(e){return this===e}}class wC extends oi{constructor(e,n){super(e),this.mu=n}_toFieldTransform(e){const n=new ji(e.serializer,Xy(e.serializer,this.mu));return new qo(e.path,n)}isEqual(e){return this===e}}function $d(t,e,n,r){const i=t.Ru(1,e,n);Gd("Data must be an object, but it was:",i,r);const s=[],o=ut.empty();si(r,(c,l)=>{const u=jd(e,c,n);l=Qe(l);const h=i.Iu(u);if(l instanceof Wo)s.push(u);else{const d=ci(l,h);d!=null&&(s.push(u),o.set(u,d))}});const a=new xt(s);return new yI(o,a,i.fieldTransforms)}function qd(t,e,n,r,i,s){const o=t.Ru(1,e,n),a=[Gu(e,r,n)],c=[i];if(s.length%2!=0)throw new S(E.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Gu(e,s[d])),c.push(s[d+1]);const l=[],u=ut.empty();for(let d=a.length-1;d>=0;--d)if(!AI(l,a[d])){const f=a[d];let v=c[d];v=Qe(v);const I=o.Iu(f);if(v instanceof Wo)l.push(f);else{const T=ci(v,I);T!=null&&(l.push(f),u.set(f,T))}}const h=new xt(l);return new yI(u,h,o.fieldTransforms)}function EI(t,e,n,r=!1){return ci(n,t.Ru(r?4:3,e))}function ci(t,e){if(wI(t=Qe(t)))return Gd("Unsupported field value:",e,t),TI(t,e);if(t instanceof oi)return function(r,i){if(!vI(i.uu))throw i.Eu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Eu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.hu&&e.uu!==4)throw e.Eu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let c=ci(a,i.Tu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Xy(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ke.fromDate(r);return{timestampValue:Ki(i.serializer,s)}}if(r instanceof ke){const s=new ke(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ki(i.serializer,s)}}if(r instanceof el)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof _n)return{bytesValue:lv(i.serializer,r._byteString)};if(r instanceof Me){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Eu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:hd(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Eu(`Unsupported field value: ${Zc(r)}`)}(t,e)}function TI(t,e){const n={};return xy(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):si(t,(r,i)=>{const s=ci(i,e.lu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function wI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ke||t instanceof el||t instanceof _n||t instanceof Me||t instanceof oi)}function Gd(t,e,n){if(!wI(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Zc(n);throw r==="an object"?e.Eu(t+" a custom object"):e.Eu(t+" "+r)}}function Gu(t,e,n){if((e=Qe(e))instanceof ur)return e._internalPath;if(typeof e=="string")return jd(t,e);throw ac("Field path arguments must be of type string or ",t,!1,void 0,n)}const AC=new RegExp("[~\\*/\\[\\]]");function jd(t,e,n){if(e.search(AC)>=0)throw ac(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ur(...e.split("."))._internalPath}catch{throw ac(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function ac(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new S(E.INVALID_ARGUMENT,a+t+c)}function AI(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new bC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(rl("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class bC extends yo{data(){return super.data()}}function rl(t,e){return typeof e=="string"?jd(t,e):e instanceof ur?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new S(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Kd{}class Qo extends Kd{}function Un(t,e,...n){let r=[];e instanceof Kd&&r.push(e),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof zd).length,a=s.filter(c=>c instanceof il).length;if(o>1||o>0&&a>0)throw new S(E.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class il extends Qo{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new il(e,n,r)}_apply(e){const n=this._parse(e);return RI(e._query,n),new St(e.firestore,e.converter,Cu(e._query,n))}_parse(e){const n=ai(e.firestore);return function(s,o,a,c,l,u,h){let d;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new S(E.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){vm(h,u);const f=[];for(const v of h)f.push(ym(c,s,v));d={arrayValue:{values:f}}}else d=ym(c,s,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||vm(h,u),d=EI(a,o,h,u==="in"||u==="not-in");return oe.create(l,u,d)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function SC(t,e,n){const r=e,i=rl("where",t);return il._create(i,r,n)}class zd extends Kd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new zd(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ee.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const c of a)RI(o,c),o=Cu(o,c)}(e._query,n),new St(e.firestore,e.converter,Cu(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Hd extends Qo{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Hd(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new S(E.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new S(E.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const a=new Oi(s,o);return function(l,u){if(nd(l)===null){const h=jc(l);h!==null&&PI(l,h,u.field)}}(i,a),a}(e._query,this._field,this._direction);return new St(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Dn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function RC(t,e="asc"){const n=e,r=rl("orderBy",t);return Hd._create(r,n)}class sl extends Qo{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new sl(e,n,r)}_apply(e){return new St(e.firestore,e.converter,Ja(e._query,this._limit,this._limitType))}}function PC(t){return cI("limit",t),sl._create("limit",t,"F")}function CC(t){return cI("limitToLast",t),sl._create("limitToLast",t,"L")}class ol extends Qo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new ol(e,n,r)}_apply(e){const n=SI(e,this.type,this._docOrFields,this._inclusive);return new St(e.firestore,e.converter,function(i,s){return new Dn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function DC(...t){return ol._create("startAt",t,!0)}function xC(...t){return ol._create("startAfter",t,!1)}class al extends Qo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new al(e,n,r)}_apply(e){const n=SI(e,this.type,this._docOrFields,this._inclusive);return new St(e.firestore,e.converter,function(i,s){return new Dn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function VC(...t){return al._create("endBefore",t,!1)}function NC(...t){return al._create("endAt",t,!0)}function SI(t,e,n,r){if(n[0]=Qe(n[0]),n[0]instanceof yo)return function(s,o,a,c,l){if(!c)throw new S(E.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const u=[];for(const h of jr(s))if(h.field.isKeyField())u.push(Wr(o,c.key));else{const d=c.data.field(h.field);if(Gc(d))throw new S(E.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){const f=h.field.canonicalString();throw new S(E.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}u.push(d)}return new cr(u,l)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=ai(t.firestore);return function(o,a,c,l,u,h){const d=o.explicitOrderBy;if(u.length>d.length)throw new S(E.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let v=0;v<u.length;v++){const I=u[v];if(d[v].field.isKeyField()){if(typeof I!="string")throw new S(E.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof I}`);if(!rd(o)&&I.indexOf("/")!==-1)throw new S(E.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${I}' contains a slash.`);const T=o.path.child(le.fromString(I));if(!k.isDocumentKey(T))throw new S(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const R=new k(T);f.push(Wr(a,R))}else{const T=EI(c,l,I);f.push(T)}}return new cr(f,h)}(t._query,t.firestore._databaseId,i,e,n,r)}}function ym(t,e,n){if(typeof(n=Qe(n))=="string"){if(n==="")throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rd(e)&&n.indexOf("/")!==-1)throw new S(E.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(le.fromString(n));if(!k.isDocumentKey(r))throw new S(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wr(t,new k(r))}if(n instanceof Me)return Wr(t,n._key);throw new S(E.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zc(n)}.`)}function vm(t,e){if(!Array.isArray(t)||t.length===0)throw new S(E.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function RI(t,e){if(e.isInequality()){const r=jc(t),i=e.field;if(r!==null&&!r.isEqual(i))throw new S(E.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const s=nd(t);s!==null&&PI(t,i,s)}const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new S(E.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new S(E.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function PI(t,e,n){if(!n.isEqual(e))throw new S(E.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class Wd{convertValue(e,n="none"){switch(Hr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(sr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw $()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return si(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new el(Fe(e.latitude),Fe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ed(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(uo(e));default:return null}}convertTimestamp(e){const n=ir(e);return new ke(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=le.fromString(e);K(vv(r));const i=new or(r.get(1),r.get(3)),s=new k(r.popFirst(5));return i.isEqual(n)||$e(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cl(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class OC extends Wd{constructor(e){super(),this.firestore=e}convertBytes(e){return new _n(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Pn=class extends yo{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new $s(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(rl("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},$s=class extends Pn{data(e={}){return super.data(e)}},hr=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Lr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new $s(this._firestore,this._userDataWriter,r.key,r,new Lr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new S(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const c=new $s(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Lr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const c=new $s(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Lr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:kC(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function kC(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}function CI(t,e){return t instanceof Pn&&e instanceof Pn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof hr&&e instanceof hr&&t._firestore===e._firestore&&pI(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(t){t=he(t,Me);const e=he(t.firestore,Be);return iI(at(e),t._key).then(n=>Qd(e,t,n))}class li extends Wd{constructor(e){super(),this.firestore=e}convertBytes(e){return new _n(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,n)}}function FC(t){t=he(t,Me);const e=he(t.firestore,Be),n=at(e),r=new li(e);return eC(n,t._key).then(i=>new Pn(e,r,t._key,i,new Lr(i!==null&&i.hasLocalMutations,!0),t.converter))}function LC(t){t=he(t,Me);const e=he(t.firestore,Be);return iI(at(e),t._key,{source:"server"}).then(n=>Qd(e,t,n))}function BC(t){t=he(t,St);const e=he(t.firestore,Be),n=at(e),r=new li(e);return bI(t._query),sI(n,t._query).then(i=>new hr(e,r,t,i))}function UC(t){t=he(t,St);const e=he(t.firestore,Be),n=at(e),r=new li(e);return tC(n,t._query).then(i=>new hr(e,r,t,i))}function $C(t){t=he(t,St);const e=he(t.firestore,Be),n=at(e),r=new li(e);return sI(n,t._query,{source:"server"}).then(i=>new hr(e,r,t,i))}function Im(t,e,n){t=he(t,Me);const r=he(t.firestore,Be),i=cl(t.converter,e,n);return Yo(r,[nl(ai(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Oe.none())])}function Em(t,e,n,...r){t=he(t,Me);const i=he(t.firestore,Be),s=ai(i);let o;return o=typeof(e=Qe(e))=="string"||e instanceof ur?qd(s,"updateDoc",t._key,e,n,r):$d(s,"updateDoc",t._key,e),Yo(i,[o.toMutation(t._key,Oe.exists(!0))])}function qC(t){return Yo(he(t.firestore,Be),[new ls(t._key,Oe.none())])}function GC(t,e){const n=he(t.firestore,Be),r=oc(t),i=cl(t.converter,e);return Yo(n,[nl(ai(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Oe.exists(!1))]).then(()=>r)}function DI(t,...e){var n,r,i;t=Qe(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||qu(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(qu(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,u;if(t instanceof Me)l=he(t.firestore,Be),u=as(t._key.path),c={next:h=>{e[o]&&e[o](Qd(l,t,h))},error:e[o+1],complete:e[o+2]};else{const h=he(t,St);l=he(h.firestore,Be),u=h._query;const d=new li(l);c={next:f=>{e[o]&&e[o](new hr(l,d,h,f))},error:e[o+1],complete:e[o+2]},bI(t._query)}return function(d,f,v,I){const T=new Xc(I),R=new Pd(f,T,v);return d.asyncQueue.enqueueAndForget(async()=>bd(await Yi(d),R)),()=>{T.Ca(),d.asyncQueue.enqueueAndForget(async()=>Sd(await Yi(d),R))}}(at(l),u,a,c)}function jC(t,e){return nC(at(t=he(t,Be)),qu(e)?e:{next:e})}function Yo(t,e){return function(r,i){const s=new rt;return r.asyncQueue.enqueueAndForget(async()=>DP(await Ld(r),i,s)),s.promise}(at(t),e)}function Qd(t,e,n){const r=n.docs.get(e._key),i=new li(t);return new Pn(t,i,e._key,r,new Lr(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zC=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ai(e)}set(e,n,r){this._verifyNotCommitted();const i=Kn(e,this._firestore),s=cl(i.converter,n,r),o=nl(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Oe.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=Kn(e,this._firestore);let o;return o=typeof(n=Qe(n))=="string"||n instanceof ur?qd(this._dataReader,"WriteBatch.update",s._key,n,r,i):$d(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Oe.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Kn(e,this._firestore);return this._mutations=this._mutations.concat(new ls(n._key,Oe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new S(E.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Kn(t,e){if((t=Qe(t)).firestore!==e)throw new S(E.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let HC=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=ai(n)}get(n){const r=Kn(n,this._firestore),i=new OC(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return $();const o=s[0];if(o.isFoundDocument())return new yo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new yo(this._firestore,i,r._key,null,r.converter);throw $()})}set(n,r,i){const s=Kn(n,this._firestore),o=cl(s.converter,r,i),a=nl(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=Kn(n,this._firestore);let a;return a=typeof(r=Qe(r))=="string"||r instanceof ur?qd(this._dataReader,"Transaction.update",o._key,r,i,s):$d(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=Kn(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Kn(e,this._firestore),r=new li(this._firestore);return super.get(e).then(i=>new Pn(this._firestore,r,n._key,i._document,new Lr(!1,!1),n.converter))}};function WC(t,e,n){t=he(t,Be);const r=Object.assign(Object.assign({},KC),n);return function(s){if(s.maxAttempts<1)throw new S(E.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const c=new rt;return s.asyncQueue.enqueueAndForget(async()=>{const l=await XP(s);new QP(s.asyncQueue,l,a,o,c).run()}),c.promise}(at(t),i=>e(new HC(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(){return new Wo("deleteField")}function YC(){return new Ud("serverTimestamp")}function XC(...t){return new EC("arrayUnion",t)}function JC(...t){return new TC("arrayRemove",t)}function ZC(t){return new wC("increment",t)}(function(e,n=!0){(function(i){os=i})(Sh),Li(new Kr("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Be(new oS(r.getProvider("auth-internal")),new uS(r.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new S(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new or(l.options.projectId,u)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Xn(gp,"4.1.0",e),Xn(gp,"4.1.0","esm2017")})();const e1="@firebase/firestore-compat",t1="0.3.14";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new S("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(){if(typeof Uint8Array>"u")throw new S("unimplemented","Uint8Arrays are not available in this environment.")}function wm(){if(!MS())throw new S("unimplemented","Blobs are unavailable in Firestore in this environment.")}class vo{constructor(e){this._delegate=e}static fromBase64String(e){return wm(),new vo(_n.fromBase64String(e))}static fromUint8Array(e){return Tm(),new vo(_n.fromUint8Array(e))}toBase64(){return wm(),this._delegate.toBase64()}toUint8Array(){return Tm(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(t){return n1(t,["next","error","complete"])}function n1(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{enableIndexedDbPersistence(e,n){return uC(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return hC(e._delegate)}clearIndexedDbPersistence(e){return dC(e._delegate)}}class xI{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof or||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&en("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){sC(this._delegate,e,n,r)}enableNetwork(){return pC(this._delegate)}disableNetwork(){return mC(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,aI("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return fC(this._delegate)}onSnapshotsInSync(e){return jC(this._delegate,e)}get app(){if(!this._appCompat)throw new S("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Xi(this,dI(this._delegate,e))}catch(n){throw wt(n,"collection()","Firestore.collection()")}}doc(e){try{return new jt(this,oc(this._delegate,e))}catch(n){throw wt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Tt(this,oC(this._delegate,e))}catch(n){throw wt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return WC(this._delegate,n=>e(new VI(this,n)))}batch(){return at(this._delegate),new NI(new zC(this._delegate,e=>Yo(this._delegate,e)))}loadBundle(e){return gC(this._delegate,e)}namedQuery(e){return _C(this._delegate,e).then(n=>n?new Tt(this,n):null)}}class ll extends Wd{constructor(e){super(),this.firestore=e}convertBytes(e){return new vo(new _n(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return jt.forKey(n,this.firestore,null)}}function i1(t){nS(t)}class VI{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new ll(e)}get(e){const n=Br(e);return this._delegate.get(n).then(r=>new Io(this._firestore,new Pn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=Br(e);return r?(Yd("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Br(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Br(e);return this._delegate.delete(n),this}}class NI{constructor(e){this._delegate=e}set(e,n,r){const i=Br(e);return r?(Yd("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Br(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Br(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class ti{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new $s(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Eo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=ti.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new ti(e,new ll(e),n),i.set(n,s)),s}}ti.INSTANCES=new WeakMap;class jt{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new ll(e)}static forPath(e,n,r){if(e.length%2!==0)throw new S("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new jt(n,new Me(n._delegate,r,new k(e)))}static forKey(e,n,r){return new jt(n,new Me(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Xi(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Xi(this.firestore,dI(this._delegate,e))}catch(n){throw wt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Qe(e),e instanceof Me?fI(this._delegate,e):!1}set(e,n){n=Yd("DocumentReference.set",n);try{return n?Im(this._delegate,e,n):Im(this._delegate,e)}catch(r){throw wt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?Em(this._delegate,e):Em(this._delegate,e,n,...r)}catch(i){throw wt(i,"updateDoc()","DocumentReference.update()")}}delete(){return qC(this._delegate)}onSnapshot(...e){const n=OI(e),r=kI(e,i=>new Io(this.firestore,new Pn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return DI(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=FC(this._delegate):(e==null?void 0:e.source)==="server"?n=LC(this._delegate):n=MC(this._delegate),n.then(r=>new Io(this.firestore,new Pn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new jt(this.firestore,e?this._delegate.withConverter(ti.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function wt(t,e,n){return t.message=t.message.replace(e,n),t}function OI(t){for(const e of t)if(typeof e=="object"&&!ju(e))return e;return{}}function kI(t,e){var n,r;let i;return ju(t[0])?i=t[0]:ju(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Io{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new jt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return CI(this._delegate,e._delegate)}}class Eo extends Io{data(e){const n=this._delegate.data(e);return rS(n!==void 0),n}}class Tt{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new ll(e)}where(e,n,r){try{return new Tt(this.firestore,Un(this._delegate,SC(e,n,r)))}catch(i){throw wt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new Tt(this.firestore,Un(this._delegate,RC(e,n)))}catch(r){throw wt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Tt(this.firestore,Un(this._delegate,PC(e)))}catch(n){throw wt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new Tt(this.firestore,Un(this._delegate,CC(e)))}catch(n){throw wt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Tt(this.firestore,Un(this._delegate,DC(...e)))}catch(n){throw wt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Tt(this.firestore,Un(this._delegate,xC(...e)))}catch(n){throw wt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Tt(this.firestore,Un(this._delegate,VC(...e)))}catch(n){throw wt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Tt(this.firestore,Un(this._delegate,NC(...e)))}catch(n){throw wt(n,"endAt()","Query.endAt()")}}isEqual(e){return pI(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=UC(this._delegate):(e==null?void 0:e.source)==="server"?n=$C(this._delegate):n=BC(this._delegate),n.then(r=>new Ku(this.firestore,new hr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=OI(e),r=kI(e,i=>new Ku(this.firestore,new hr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return DI(this._delegate,n,r)}withConverter(e){return new Tt(this.firestore,e?this._delegate.withConverter(ti.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class s1{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Eo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Ku{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Tt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Eo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new s1(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Eo(this._firestore,r))})}isEqual(e){return CI(this._delegate,e._delegate)}}class Xi extends Tt{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new jt(this.firestore,e):null}doc(e){try{return e===void 0?new jt(this.firestore,oc(this._delegate)):new jt(this.firestore,oc(this._delegate,e))}catch(n){throw wt(n,"doc()","CollectionReference.doc()")}}add(e){return GC(this._delegate,e).then(n=>new jt(this.firestore,n))}isEqual(e){return fI(this._delegate,e._delegate)}withConverter(e){return new Xi(this.firestore,e?this._delegate.withConverter(ti.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Br(t){return he(t,Me)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(...e){this._delegate=new ur(...e)}static documentId(){return new Xd(qe.keyField().canonicalString())}isEqual(e){return e=Qe(e),e instanceof ur?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this._delegate=e}static serverTimestamp(){const e=YC();return e._methodName="FieldValue.serverTimestamp",new Or(e)}static delete(){const e=QC();return e._methodName="FieldValue.delete",new Or(e)}static arrayUnion(...e){const n=XC(...e);return n._methodName="FieldValue.arrayUnion",new Or(n)}static arrayRemove(...e){const n=JC(...e);return n._methodName="FieldValue.arrayRemove",new Or(n)}static increment(e){const n=ZC(e);return n._methodName="FieldValue.increment",new Or(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1={Firestore:xI,GeoPoint:el,Timestamp:ke,Blob:vo,Transaction:VI,WriteBatch:NI,DocumentReference:jt,DocumentSnapshot:Io,Query:Tt,QueryDocumentSnapshot:Eo,QuerySnapshot:Ku,CollectionReference:Xi,FieldPath:Xd,FieldValue:Or,setLogLevel:i1,CACHE_SIZE_UNLIMITED:lC};function a1(t,e){t.INTERNAL.registerComponent(new Kr("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},o1)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c1(t){a1(t,(e,n)=>new xI(e,n,new r1)),t.registerVersion(e1,t1)}c1(Ph);const l1={apiKey:"AIzaSyAbGBvnB-4pjL_G96aWQ63t4714hhPAxDI",authDomain:"invoice-app-yt-e0f81.firebaseapp.com",databaseURL:"https://invoice-app-yt-e0f81-default-rtdb.firebaseio.com",projectId:"invoice-app-yt-e0f81",storageBucket:"invoice-app-yt-e0f81.appspot.com",messagingSenderId:"484976767123",appId:"1:484976767123:web:3de6ab2f4eaa0beb165d66"},u1=Ph.initializeApp(l1),bi=u1.firestore();var Ur=256,MI=[],Am=256,ga;for(;Ur--;)MI[Ur]=(Ur+256).toString(16).substring(1);function bm(t){var e=0,n=t||11;if(!ga||Ur+n>Am*2)for(ga="",Ur=0;e<Am;e++)ga+=MI[Math.random()*256|0];return ga.substring(Ur,Ur+++n)}const h1={name:"app-loading"},d1={class:"loading"},f1=g("span",null,null,-1),p1=[f1];function m1(t,e,n,r,i,s){return ae(),ge("div",d1,p1)}const g1=dr(h1,[["render",m1]]),_1="/assets/icon-delete-44ba3da5.svg",FI="/assets/icon-plus-9992cbd5.svg";const y1={name:"InvoiceModal",data(){return{dateOptions:{year:"numeric",month:"short",day:"numeric"},docId:null,billerStreetAddress:null,billerCity:null,billerZipCode:null,billerCountry:null,clientName:null,clientEmail:null,clientStreetAddress:null,clientCity:null,clientZipCode:null,clientCountry:null,invoiceDateUnix:null,invoiceDate:null,paymentTerms:null,paymentDueDateUnix:null,paymentDueDate:null,productDescription:null,invoicePending:null,invoiceDraft:null,invoiceItemList:[],invoiceTotal:0,loading:null}},components:{loading:g1},created(){if(this.editInvoice||(this.invoiceDateUnix=Date.now(),this.invoiceDate=new Date(this.invoiceDateUnix).toLocaleDateString("en-us",this.dateOptions)),this.editInvoice){const t=this.currentInvoiceArray[0];this.docId=t.docId,this.billerStreetAddress=t.billerStreetAddress,this.billerCity=t.billerCity,this.billerZipCode=t.billerZipCode,this.billerCountry=t.billerCountry,this.clientName=t.clientName,this.clientEmail=t.clientEmail,this.clientStreetAddress=t.clientStreetAddress,this.clientCity=t.clientCity,this.clientZipCode=t.clientZipCode,this.clientCountry=t.clientCountry,this.invoiceDateUnix=t.invoiceDateUnix,this.invoiceDate=t.invoiceDate,this.paymentTerms=t.paymentTerms,this.paymentDueDateUnix=t.paymentDueDateUnix,this.paymentDueDate=t.paymentDueDate,this.productDescription=t.productDescription,this.invoicePending=t.invoicePending,this.invoiceDraft=t.invoiceDraft,this.invoiceItemList=t.invoiceItemList,this.invoiceTotal=t.invoiceTotal}},methods:{...bc(["TOGGLE_INVOICE","TOGGLE_MODAL","TOGGLE_EDIT_INVOICE"]),...vh(["UPDATE_INVOICE","GET_INVOICES"]),checkClick(t){t.target===this.$refs.InvoiceWrap&&(console.log(t.target),console.log(this.$refs.InvoiceWrap),this.TOGGLE_MODAL())},closeInvoice(){this.TOGGLE_INVOICE(),this.editInvoice&&this.TOGGLE_EDIT_INVOICE()},addNewInvoiceItem(){console.log("c"),this.invoiceItemList.push({id:bm(),itemName:"",qty:"",price:0,total:0})},deletInvoiceItem(t){this.invoiceItemList=this.invoiceItemList.filter(e=>e.id!==t)},calInvoiceTotal(){this.invoiceTotal=0,this.invoiceItemList.forEach(t=>{this.invoiceTotal+=t.total})},PublishInvoice(){this.invoicePending=!0},saveDraft(){this.invoiceDraft=!0},async uploadInvoice(){if(this.invoiceItemList.length<=0){alert("Please ensure you filled out work items! ");return}const t=bi.collection("invoices").doc();this.loading=!0,this.calInvoiceTotal(),await t.set({invoiceId:bm(6),billerStreetAddress:this.billerStreetAddress,billerCity:this.billerCity,billerZipCode:this.billerZipCode,billerCountry:this.billerCountry,clientName:this.clientName,clientEmail:this.clientEmail,clientStreetAddress:this.clientStreetAddress,clientCity:this.clientCity,clientZipCode:this.clientZipCode,clientCountry:this.clientCountry,invoiceDateUnix:this.invoiceDateUnix,invoiceDate:this.invoiceDate,paymentTerms:this.paymentTerms,paymentDueDateUnix:this.paymentDueDateUnix,paymentDueDate:this.paymentDueDate,productDescription:this.productDescription,invoiceItemList:this.invoiceItemList,invoiceTotal:this.invoiceTotal,invoicePending:this.invoicePending,invoiceDraft:this.invoiceDraft,invoicedPaid:null}),this.loading=!1,this.TOGGLE_INVOICE(),this.GET_INVOICES()},async updateInvoice(){if(this.invoiceItemList.length<=0){alert("Please ensure you filled out work items! ");return}const t=bi.collection("invoices").doc(this.docId);this.loading=!0,this.calInvoiceTotal(),await t.update({billerStreetAddress:this.billerStreetAddress,billerCity:this.billerCity,billerZipCode:this.billerZipCode,billerCountry:this.billerCountry,clientName:this.clientName,clientEmail:this.clientEmail,clientStreetAddress:this.clientStreetAddress,clientCity:this.clientCity,clientZipCode:this.clientZipCode,clientCountry:this.clientCountry,paymentTerms:this.paymentTerms,paymentDueDate:this.paymentDueDate,paymentDueDateUnix:this.paymentDueDateUnix,productDescription:this.productDescription,invoiceItemList:this.invoiceItemList,invoiceTotal:this.invoiceTotal}),this.loading=!1;const e={docId:this.docId,routeId:this.$route.params.invoiceId};this.UPDATE_INVOICE(e)},submitForm(){if(this.editInvoice){this.updateInvoice();return}this.uploadInvoice()}},computed:{...Po(["editInvoice","currentInvoiceArray"])},watch:{paymentTerms(){const t=new Date;this.paymentDueDateUnix=t.setDate(t.getDate()+parseInt(this.paymentTerms)),this.paymentDueDate=new Date(this.paymentDueDateUnix).toLocaleDateString("en-us",this.dateOptions)}}},je=t=>(So("data-v-722e2d1d"),t=t(),Ro(),t),v1={key:0},I1={key:1},E1={class:"bill-from flex flex-column"},T1=je(()=>g("h4",null,"Bill From",-1)),w1={class:"input flex flex-column"},A1=je(()=>g("label",{for:"billerStreetAddress"},"Street Address",-1)),b1={class:"location-detalis flex"},S1={class:"input flex flex-column"},R1=je(()=>g("label",{for:"billerCity"},"City",-1)),P1={class:"input flex flex-column"},C1=je(()=>g("label",{for:"billerZipCode"},"Zip Code",-1)),D1={class:"input flex flex-column"},x1=je(()=>g("label",{for:"billerCountry"},"Country",-1)),V1={class:"bill-to flex flex-column"},N1=je(()=>g("h4",null,"Bill To",-1)),O1={class:"input flex flex-column"},k1=je(()=>g("label",{for:"clientName"},"client's Name",-1)),M1={class:"input flex flex-column"},F1=je(()=>g("label",{for:"clientEmail"},"client's Email",-1)),L1={class:"input flex flex-column"},B1=je(()=>g("label",{for:"clientStreetAddress"},"Street Address",-1)),U1={class:"location-detalis flex"},$1={class:"input flex flex-column"},q1=je(()=>g("label",{for:"clientCity"},"City",-1)),G1={class:"input flex flex-column"},j1=je(()=>g("label",{for:"clientZipCode"},"Zip Code",-1)),K1={class:"input flex flex-column"},z1=je(()=>g("label",{for:"clientCountry"},"Country",-1)),H1={class:"invoice-work flex flex-column"},W1={class:"payment flex"},Q1={class:"input flex flex-column"},Y1=je(()=>g("label",{for:"invoiceDate"},"invoice Date",-1)),X1={class:"input flex flex-column"},J1=je(()=>g("label",{for:"paymentDueDate"},"payment Due",-1)),Z1={class:"input flex flex-column"},eD=je(()=>g("label",{for:"paymentTerms"},"Payment Terms",-1)),tD=je(()=>g("option",{value:"30"},"Net 30 Days",-1)),nD=je(()=>g("option",{value:"60"},"Net 60 Days",-1)),rD=[tD,nD],iD={class:"input flex flex-column"},sD=je(()=>g("label",{for:"productDescription"},"Product Description",-1)),oD={class:"work-items"},aD=je(()=>g("h3",null,"Item List",-1)),cD={class:"item-list"},lD=je(()=>g("tr",{class:"table-heading flex"},[g("th",{class:"item-name"},"Item Name"),g("th",{class:"qty"},"Qty"),g("th",{class:"Price"},"Price"),g("th",{class:"total"},"total")],-1)),uD={class:"item-name"},hD=["onUpdate:modelValue"],dD={class:"qty"},fD=["onUpdate:modelValue"],pD={class:"Price"},mD=["onUpdate:modelValue"],gD={class:"total flex"},_D=["onClick"],yD=je(()=>g("img",{src:FI,alt:""},null,-1)),vD={class:"save flex"},ID={class:"left"},ED={class:"right flex"},TD={key:2,type:"submit",class:"purple"};function wD(t,e,n,r,i,s){const o=zn("loading");return ae(),ge("div",{onClick:e[19]||(e[19]=(...a)=>s.checkClick&&s.checkClick(...a)),ref:"InvoiceWrap",class:"invoice-wrap flex flex-column"},[g("form",{onSubmit:e[18]||(e[18]=Aw((...a)=>s.submitForm&&s.submitForm(...a),["prevent"])),class:"invoice-content"},[t.editInvoice?(ae(),ge("h1",I1,"Edit Invoice")):(ae(),ge("h1",v1,"New Invoice")),Xe(Je(o,null,null,512),[[qg,i.loading]]),g("div",E1,[T1,g("div",w1,[A1,Xe(g("input",{required:"",type:"text",id:"billerStreetAddress","onUpdate:modelValue":e[0]||(e[0]=a=>i.billerStreetAddress=a)},null,512),[[ft,i.billerStreetAddress]])]),g("div",b1,[g("div",S1,[R1,Xe(g("input",{required:"",type:"text",id:"billerCity","onUpdate:modelValue":e[1]||(e[1]=a=>i.billerCity=a)},null,512),[[ft,i.billerCity]])]),g("div",P1,[C1,Xe(g("input",{required:"",type:"text",id:"billerZipCode","onUpdate:modelValue":e[2]||(e[2]=a=>i.billerZipCode=a)},null,512),[[ft,i.billerZipCode]])]),g("div",D1,[x1,Xe(g("input",{required:"",type:"text",id:"billerCountry","onUpdate:modelValue":e[3]||(e[3]=a=>i.billerCountry=a)},null,512),[[ft,i.billerCountry]])])])]),g("div",V1,[N1,g("div",O1,[k1,Xe(g("input",{required:"",type:"text",id:"clientName","onUpdate:modelValue":e[4]||(e[4]=a=>i.clientName=a)},null,512),[[ft,i.clientName]])]),g("div",M1,[F1,Xe(g("input",{required:"",type:"text",id:"clientEmail","onUpdate:modelValue":e[5]||(e[5]=a=>i.clientEmail=a)},null,512),[[ft,i.clientEmail]])]),g("div",L1,[B1,Xe(g("input",{required:"",type:"text",id:"clientStreetAddress","onUpdate:modelValue":e[6]||(e[6]=a=>i.clientStreetAddress=a)},null,512),[[ft,i.clientStreetAddress]])]),g("div",U1,[g("div",$1,[q1,Xe(g("input",{required:"",type:"text",id:"clientCity","onUpdate:modelValue":e[7]||(e[7]=a=>i.clientCity=a)},null,512),[[ft,i.clientCity]])]),g("div",G1,[j1,Xe(g("input",{required:"",type:"text",id:"clientZipCode","onUpdate:modelValue":e[8]||(e[8]=a=>i.clientZipCode=a)},null,512),[[ft,i.clientZipCode]])]),g("div",K1,[z1,Xe(g("input",{required:"",type:"text",id:"clientCountry","onUpdate:modelValue":e[9]||(e[9]=a=>i.clientCountry=a)},null,512),[[ft,i.clientCountry]])])])]),g("div",H1,[g("div",W1,[g("div",Q1,[Y1,Xe(g("input",{disabled:"",type:"text",id:"invoiceDate","onUpdate:modelValue":e[10]||(e[10]=a=>i.invoiceDate=a)},null,512),[[ft,i.invoiceDate]])]),g("div",X1,[J1,Xe(g("input",{disabled:"",type:"text",id:"paymentDueDate","onUpdate:modelValue":e[11]||(e[11]=a=>i.paymentDueDate=a)},null,512),[[ft,i.paymentDueDate]])])]),g("div",Z1,[eD,Xe(g("select",{required:"",id:"paymentTerms","onUpdate:modelValue":e[12]||(e[12]=a=>i.paymentTerms=a)},rD,512),[[Ew,i.paymentTerms]])]),g("div",iD,[sD,Xe(g("input",{required:"",type:"text",id:"productDescription","onUpdate:modelValue":e[13]||(e[13]=a=>i.productDescription=a)},null,512),[[ft,i.productDescription]])]),g("div",oD,[aD,g("table",cD,[lD,(ae(!0),ge(Ft,null,lh(i.invoiceItemList,(a,c)=>(ae(),ge("tr",{key:c,class:"table-items flex"},[g("td",uD,[Xe(g("input",{type:"text","onUpdate:modelValue":l=>a.itemName=l},null,8,hD),[[ft,a.itemName]])]),g("td",dD,[Xe(g("input",{type:"text","onUpdate:modelValue":l=>a.qty=l},null,8,fD),[[ft,a.qty]])]),g("td",pD,[Xe(g("input",{type:"text","onUpdate:modelValue":l=>a.price=l},null,8,mD),[[ft,a.price]])]),g("td",gD,"$"+Pe(a.total=a.qty*a.price),1),g("img",{onClick:l=>s.deletInvoiceItem(a.id),src:_1,alt:""},null,8,_D)]))),128))]),g("div",{onClick:e[14]||(e[14]=(...a)=>s.addNewInvoiceItem&&s.addNewInvoiceItem(...a)),class:"flex button"},[yD,Ys(" Add New Item ")])])]),g("div",vD,[g("div",ID,[g("button",{type:"button",onClick:e[15]||(e[15]=(...a)=>s.closeInvoice&&s.closeInvoice(...a)),class:"red"},"Cancel")]),g("div",ED,[t.editInvoice?mt("",!0):(ae(),ge("button",{key:0,type:"submit",onClick:e[16]||(e[16]=(...a)=>s.saveDraft&&s.saveDraft(...a)),class:"dark-purple"}," Save Draft ")),t.editInvoice?mt("",!0):(ae(),ge("button",{key:1,type:"submit",onClick:e[17]||(e[17]=(...a)=>s.PublishInvoice&&s.PublishInvoice(...a)),class:"purple"}," Create Invoice ")),t.editInvoice?(ae(),ge("button",TD,"Update Invoice")):mt("",!0)])])],32)],512)}const AD=dr(y1,[["render",wD],["__scopeId","data-v-722e2d1d"]]);const bD={name:"app-Modal",methods:{...bc(["TOGGLE_INVOICE","TOGGLE_MODAL","TOGGLE_EDIT_INVOICE"]),closeModal(){this.TOGGLE_MODAL()},closeInvoice(){this.TOGGLE_MODAL(),this.TOGGLE_INVOICE(),this.editInvoice&&this.TOGGLE_EDIT_INVOICE()}},computed:{...Po(["editInvoice"])}},SD={class:"moadl flex"},RD={class:"modal-content"},PD=g("p",null,"Are you sure you want to exit? Your changes will noy be saved?",-1),CD={class:"actions flex"};function DD(t,e,n,r,i,s){return ae(),ge("div",SD,[g("div",RD,[PD,g("div",CD,[g("button",{onClick:e[0]||(e[0]=(...o)=>s.closeModal&&s.closeModal(...o)),class:"purple"},"Return"),g("button",{onClick:e[1]||(e[1]=(...o)=>s.closeInvoice&&s.closeInvoice(...o)),class:"red"},"close")])])])}const xD=dr(bD,[["render",DD]]);const VD={data(){return{mobile:null}},components:{Navigation:cA,InvoiceModal:AD,Modal:xD},created(){this.GET_INVOICES(),this.checkScreen(),window.addEventListener("resize",this.checkScreen)},methods:{...vh(["GET_INVOICES"]),checkScreen(){if(window.innerWidth<=750){this.mobile=!0;return}console.log("750px"),this.mobile=!1}},computed:{...Po(["invoiceModal","modalActive","invoicesLoaded"])}},ND={key:0},OD={key:0,class:"app flex flex-column"},kD={class:"app-content flex flex-column"},MD={key:1,class:"mobile-massage flex flex-column"},FD=g("h2",null,"Sorry, this app is not supported on Mobile Devices",-1),LD=g("p",null,"To use this app, please use a computer or Tablet",-1),BD=[FD,LD];function UD(t,e,n,r,i,s){const o=zn("Navigation"),a=zn("Modal"),c=zn("InvoiceModal"),l=zn("router-view");return t.invoicesLoaded?(ae(),ge("div",ND,[i.mobile?(ae(),ge("div",MD,BD)):(ae(),ge("div",OD,[Je(o),g("div",kD,[t.modalActive?(ae(),ka(a,{key:0})):mt("",!0),Je(mh,{name:"invoice"},{default:yc(()=>[t.invoiceModal?(ae(),ka(c,{key:0})):mt("",!0)]),_:1}),Je(l)])]))])):mt("",!0)}const $D=dr(VD,[["render",UD]]);/*!
  * vue-router v4.2.4
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const wi=typeof window<"u";function qD(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const Ie=Object.assign;function Ll(t,e){const n={};for(const r in e){const i=e[r];n[r]=tn(i)?i.map(t):t(i)}return n}const qs=()=>{},tn=Array.isArray,GD=/\/$/,jD=t=>t.replace(GD,"");function Bl(t,e,n="/"){let r,i={},s="",o="";const a=e.indexOf("#");let c=e.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(r=e.slice(0,c),s=e.slice(c+1,a>-1?a:e.length),i=t(s)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=WD(r??e,n),{fullPath:r+(s&&"?")+s+o,path:r,query:i,hash:o}}function KD(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Sm(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function zD(t,e,n){const r=e.matched.length-1,i=n.matched.length-1;return r>-1&&r===i&&Ji(e.matched[r],n.matched[i])&&LI(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Ji(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function LI(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!HD(t[n],e[n]))return!1;return!0}function HD(t,e){return tn(t)?Rm(t,e):tn(e)?Rm(e,t):t===e}function Rm(t,e){return tn(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function WD(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let s=n.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")s>1&&s--;else break;return n.slice(0,s).join("/")+"/"+r.slice(o-(o===r.length?1:0)).join("/")}var To;(function(t){t.pop="pop",t.push="push"})(To||(To={}));var Gs;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Gs||(Gs={}));function QD(t){if(!t)if(wi){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),jD(t)}const YD=/^[^#]+#/;function XD(t,e){return t.replace(YD,"#")+e}function JD(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const ul=()=>({left:window.pageXOffset,top:window.pageYOffset});function ZD(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),i=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;e=JD(i,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function Pm(t,e){return(history.state?history.state.position-e:-1)+t}const zu=new Map;function ex(t,e){zu.set(t,e)}function tx(t){const e=zu.get(t);return zu.delete(t),e}let nx=()=>location.protocol+"//"+location.host;function BI(t,e){const{pathname:n,search:r,hash:i}=e,s=t.indexOf("#");if(s>-1){let a=i.includes(t.slice(s))?t.slice(s).length:1,c=i.slice(a);return c[0]!=="/"&&(c="/"+c),Sm(c,"")}return Sm(n,t)+r+i}function rx(t,e,n,r){let i=[],s=[],o=null;const a=({state:d})=>{const f=BI(t,location),v=n.value,I=e.value;let T=0;if(d){if(n.value=f,e.value=d,o&&o===v){o=null;return}T=I?d.position-I.position:0}else r(f);i.forEach(R=>{R(n.value,v,{delta:T,type:To.pop,direction:T?T>0?Gs.forward:Gs.back:Gs.unknown})})};function c(){o=n.value}function l(d){i.push(d);const f=()=>{const v=i.indexOf(d);v>-1&&i.splice(v,1)};return s.push(f),f}function u(){const{history:d}=window;d.state&&d.replaceState(Ie({},d.state,{scroll:ul()}),"")}function h(){for(const d of s)d();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:c,listen:l,destroy:h}}function Cm(t,e,n,r=!1,i=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:i?ul():null}}function ix(t){const{history:e,location:n}=window,r={value:BI(t,n)},i={value:e.state};i.value||s(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(c,l,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:nx()+t+c;try{e[u?"replaceState":"pushState"](l,"",d),i.value=l}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(c,l){const u=Ie({},e.state,Cm(i.value.back,c,i.value.forward,!0),l,{position:i.value.position});s(c,u,!0),r.value=c}function a(c,l){const u=Ie({},i.value,e.state,{forward:c,scroll:ul()});s(u.current,u,!0);const h=Ie({},Cm(r.value,c,null),{position:u.position+1},l);s(c,h,!1),r.value=c}return{location:r,state:i,push:a,replace:o}}function sx(t){t=QD(t);const e=ix(t),n=rx(t,e.state,e.location,e.replace);function r(s,o=!0){o||n.pauseListeners(),history.go(s)}const i=Ie({location:"",base:t,go:r,createHref:XD.bind(null,t)},e,n);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function ox(t){return typeof t=="string"||t&&typeof t=="object"}function UI(t){return typeof t=="string"||typeof t=="symbol"}const $n={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},$I=Symbol("");var Dm;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Dm||(Dm={}));function Zi(t,e){return Ie(new Error,{type:t,[$I]:!0},e)}function In(t,e){return t instanceof Error&&$I in t&&(e==null||!!(t.type&e))}const xm="[^/]+?",ax={sensitive:!1,strict:!1,start:!0,end:!0},cx=/[.+*?^${}()[\]/\\]/g;function lx(t,e){const n=Ie({},ax,e),r=[];let i=n.start?"^":"";const s=[];for(const l of t){const u=l.length?[]:[90];n.strict&&!l.length&&(i+="/");for(let h=0;h<l.length;h++){const d=l[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(i+="/"),i+=d.value.replace(cx,"\\$&"),f+=40;else if(d.type===1){const{value:v,repeatable:I,optional:T,regexp:R}=d;s.push({name:v,repeatable:I,optional:T});const x=R||xm;if(x!==xm){f+=10;try{new RegExp(`(${x})`)}catch(V){throw new Error(`Invalid custom RegExp for param "${v}" (${x}): `+V.message)}}let O=I?`((?:${x})(?:/(?:${x}))*)`:`(${x})`;h||(O=T&&l.length<2?`(?:/${O})`:"/"+O),T&&(O+="?"),i+=O,f+=20,T&&(f+=-8),I&&(f+=-20),x===".*"&&(f+=-50)}u.push(f)}r.push(u)}if(n.strict&&n.end){const l=r.length-1;r[l][r[l].length-1]+=.7000000000000001}n.strict||(i+="/?"),n.end?i+="$":n.strict&&(i+="(?:/|$)");const o=new RegExp(i,n.sensitive?"":"i");function a(l){const u=l.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",v=s[d-1];h[v.name]=f&&v.repeatable?f.split("/"):f}return h}function c(l){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:v,repeatable:I,optional:T}=f,R=v in l?l[v]:"";if(tn(R)&&!I)throw new Error(`Provided param "${v}" is an array but it is not repeatable (* or + modifiers)`);const x=tn(R)?R.join("/"):R;if(!x)if(T)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${v}"`);u+=x}}return u||"/"}return{re:o,score:r,keys:s,parse:a,stringify:c}}function ux(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function hx(t,e){let n=0;const r=t.score,i=e.score;for(;n<r.length&&n<i.length;){const s=ux(r[n],i[n]);if(s)return s;n++}if(Math.abs(i.length-r.length)===1){if(Vm(r))return 1;if(Vm(i))return-1}return i.length-r.length}function Vm(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const dx={type:0,value:""},fx=/[a-zA-Z0-9_]/;function px(t){if(!t)return[[]];if(t==="/")return[[dx]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${l}": ${f}`)}let n=0,r=n;const i=[];let s;function o(){s&&i.push(s),s=[]}let a=0,c,l="",u="";function h(){l&&(n===0?s.push({type:0,value:l}):n===1||n===2||n===3?(s.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:l,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),l="")}function d(){l+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:c==="/"?(l&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=r;break;case 1:c==="("?n=2:fx.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:n=3:u+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${l}"`),h(),o(),i}function mx(t,e,n){const r=lx(px(t.path),n),i=Ie(r,{record:t,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function gx(t,e){const n=[],r=new Map;e=km({strict:!1,end:!0,sensitive:!1},e);function i(u){return r.get(u)}function s(u,h,d){const f=!d,v=_x(u);v.aliasOf=d&&d.record;const I=km(e,u),T=[v];if("alias"in u){const O=typeof u.alias=="string"?[u.alias]:u.alias;for(const V of O)T.push(Ie({},v,{components:d?d.record.components:v.components,path:V,aliasOf:d?d.record:v}))}let R,x;for(const O of T){const{path:V}=O;if(h&&V[0]!=="/"){const W=h.record.path,J=W[W.length-1]==="/"?"":"/";O.path=h.record.path+(V&&J+V)}if(R=mx(O,h,I),d?d.alias.push(R):(x=x||R,x!==R&&x.alias.push(R),f&&u.name&&!Om(R)&&o(u.name)),v.children){const W=v.children;for(let J=0;J<W.length;J++)s(W[J],R,d&&d.children[J])}d=d||R,(R.record.components&&Object.keys(R.record.components).length||R.record.name||R.record.redirect)&&c(R)}return x?()=>{o(x)}:qs}function o(u){if(UI(u)){const h=r.get(u);h&&(r.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&r.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function c(u){let h=0;for(;h<n.length&&hx(u,n[h])>=0&&(u.record.path!==n[h].record.path||!qI(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!Om(u)&&r.set(u.record.name,u)}function l(u,h){let d,f={},v,I;if("name"in u&&u.name){if(d=r.get(u.name),!d)throw Zi(1,{location:u});I=d.record.name,f=Ie(Nm(h.params,d.keys.filter(x=>!x.optional).map(x=>x.name)),u.params&&Nm(u.params,d.keys.map(x=>x.name))),v=d.stringify(f)}else if("path"in u)v=u.path,d=n.find(x=>x.re.test(v)),d&&(f=d.parse(v),I=d.record.name);else{if(d=h.name?r.get(h.name):n.find(x=>x.re.test(h.path)),!d)throw Zi(1,{location:u,currentLocation:h});I=d.record.name,f=Ie({},h.params,u.params),v=d.stringify(f)}const T=[];let R=d;for(;R;)T.unshift(R.record),R=R.parent;return{name:I,path:v,params:f,matched:T,meta:vx(T)}}return t.forEach(u=>s(u)),{addRoute:s,resolve:l,removeRoute:o,getRoutes:a,getRecordMatcher:i}}function Nm(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function _x(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:yx(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function yx(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="object"?n[r]:n;return e}function Om(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function vx(t){return t.reduce((e,n)=>Ie(e,n.meta),{})}function km(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function qI(t,e){return e.children.some(n=>n===t||qI(t,n))}const GI=/#/g,Ix=/&/g,Ex=/\//g,Tx=/=/g,wx=/\?/g,jI=/\+/g,Ax=/%5B/g,bx=/%5D/g,KI=/%5E/g,Sx=/%60/g,zI=/%7B/g,Rx=/%7C/g,HI=/%7D/g,Px=/%20/g;function Jd(t){return encodeURI(""+t).replace(Rx,"|").replace(Ax,"[").replace(bx,"]")}function Cx(t){return Jd(t).replace(zI,"{").replace(HI,"}").replace(KI,"^")}function Hu(t){return Jd(t).replace(jI,"%2B").replace(Px,"+").replace(GI,"%23").replace(Ix,"%26").replace(Sx,"`").replace(zI,"{").replace(HI,"}").replace(KI,"^")}function Dx(t){return Hu(t).replace(Tx,"%3D")}function xx(t){return Jd(t).replace(GI,"%23").replace(wx,"%3F")}function Vx(t){return t==null?"":xx(t).replace(Ex,"%2F")}function cc(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function Nx(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let i=0;i<r.length;++i){const s=r[i].replace(jI," "),o=s.indexOf("="),a=cc(o<0?s:s.slice(0,o)),c=o<0?null:cc(s.slice(o+1));if(a in e){let l=e[a];tn(l)||(l=e[a]=[l]),l.push(c)}else e[a]=c}return e}function Mm(t){let e="";for(let n in t){const r=t[n];if(n=Dx(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(tn(r)?r.map(s=>s&&Hu(s)):[r&&Hu(r)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+n,s!=null&&(e+="="+s))})}return e}function Ox(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=tn(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return e}const kx=Symbol(""),Fm=Symbol(""),Zd=Symbol(""),WI=Symbol(""),Wu=Symbol("");function bs(){let t=[];function e(r){return t.push(r),()=>{const i=t.indexOf(r);i>-1&&t.splice(i,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function Gn(t,e,n,r,i){const s=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(Zi(4,{from:n,to:e})):h instanceof Error?a(h):ox(h)?a(Zi(2,{from:e,to:h})):(s&&r.enterCallbacks[i]===s&&typeof h=="function"&&s.push(h),o())},l=t.call(r&&r.instances[i],e,n,c);let u=Promise.resolve(l);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function Ul(t,e,n,r){const i=[];for(const s of t)for(const o in s.components){let a=s.components[o];if(!(e!=="beforeRouteEnter"&&!s.instances[o]))if(Mx(a)){const l=(a.__vccOpts||a)[e];l&&i.push(Gn(l,n,r,s,o))}else{let c=a();i.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${s.path}"`));const u=qD(l)?l.default:l;s.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Gn(d,n,r,s,o)()}))}}return i}function Mx(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Lm(t){const e=An(Zd),n=An(WI),r=qt(()=>e.resolve(Ci(t.to))),i=qt(()=>{const{matched:c}=r.value,{length:l}=c,u=c[l-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(Ji.bind(null,u));if(d>-1)return d;const f=Bm(c[l-2]);return l>1&&Bm(u)===f&&h[h.length-1].path!==f?h.findIndex(Ji.bind(null,c[l-2])):d}),s=qt(()=>i.value>-1&&Ux(n.params,r.value.params)),o=qt(()=>i.value>-1&&i.value===n.matched.length-1&&LI(n.params,r.value.params));function a(c={}){return Bx(c)?e[Ci(t.replace)?"replace":"push"](Ci(t.to)).catch(qs):Promise.resolve()}return{route:r,href:qt(()=>r.value.href),isActive:s,isExactActive:o,navigate:a}}const Fx=wg({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Lm,setup(t,{slots:e}){const n=bo(Lm(t)),{options:r}=An(Zd),i=qt(()=>({[Um(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[Um(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const s=e.default&&e.default(n);return t.custom?s:ph("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:i.value},s)}}}),Lx=Fx;function Bx(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Ux(t,e){for(const n in e){const r=e[n],i=t[n];if(typeof r=="string"){if(r!==i)return!1}else if(!tn(i)||i.length!==r.length||r.some((s,o)=>s!==i[o]))return!1}return!0}function Bm(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Um=(t,e,n)=>t??e??n,$x=wg({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=An(Wu),i=qt(()=>t.route||r.value),s=An(Fm,0),o=qt(()=>{let l=Ci(s);const{matched:u}=i.value;let h;for(;(h=u[l])&&!h.components;)l++;return l}),a=qt(()=>i.value.matched[o.value]);Ia(Fm,qt(()=>o.value+1)),Ia(kx,a),Ia(Wu,i);const c=BE();return xi(()=>[c.value,a.value,t.name],([l,u,h],[d,f,v])=>{u&&(u.instances[h]=l,f&&f!==u&&l&&l===d&&(u.leaveGuards.size||(u.leaveGuards=f.leaveGuards),u.updateGuards.size||(u.updateGuards=f.updateGuards))),l&&u&&(!f||!Ji(u,f)||!d)&&(u.enterCallbacks[h]||[]).forEach(I=>I(l))},{flush:"post"}),()=>{const l=i.value,u=t.name,h=a.value,d=h&&h.components[u];if(!d)return $m(n.default,{Component:d,route:l});const f=h.props[u],v=f?f===!0?l.params:typeof f=="function"?f(l):f:null,T=ph(d,Ie({},v,e,{onVnodeUnmounted:R=>{R.component.isUnmounted&&(h.instances[u]=null)},ref:c}));return $m(n.default,{Component:T,route:l})||T}}});function $m(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const qx=$x;function Gx(t){const e=gx(t.routes,t),n=t.parseQuery||Nx,r=t.stringifyQuery||Mm,i=t.history,s=bs(),o=bs(),a=bs(),c=UE($n);let l=$n;wi&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Ll.bind(null,A=>""+A),h=Ll.bind(null,Vx),d=Ll.bind(null,cc);function f(A,q){let F,H;return UI(A)?(F=e.getRecordMatcher(A),H=q):H=A,e.addRoute(H,F)}function v(A){const q=e.getRecordMatcher(A);q&&e.removeRoute(q)}function I(){return e.getRoutes().map(A=>A.record)}function T(A){return!!e.getRecordMatcher(A)}function R(A,q){if(q=Ie({},q||c.value),typeof A=="string"){const _=Bl(n,A,q.path),w=e.resolve({path:_.path},q),b=i.createHref(_.fullPath);return Ie(_,w,{params:d(w.params),hash:cc(_.hash),redirectedFrom:void 0,href:b})}let F;if("path"in A)F=Ie({},A,{path:Bl(n,A.path,q.path).path});else{const _=Ie({},A.params);for(const w in _)_[w]==null&&delete _[w];F=Ie({},A,{params:h(_)}),q.params=h(q.params)}const H=e.resolve(F,q),ye=A.hash||"";H.params=u(d(H.params));const p=KD(r,Ie({},A,{hash:Cx(ye),path:H.path})),m=i.createHref(p);return Ie({fullPath:p,hash:ye,query:r===Mm?Ox(A.query):A.query||{}},H,{redirectedFrom:void 0,href:m})}function x(A){return typeof A=="string"?Bl(n,A,c.value.path):Ie({},A)}function O(A,q){if(l!==A)return Zi(8,{from:q,to:A})}function V(A){return pe(A)}function W(A){return V(Ie(x(A),{replace:!0}))}function J(A){const q=A.matched[A.matched.length-1];if(q&&q.redirect){const{redirect:F}=q;let H=typeof F=="function"?F(A):F;return typeof H=="string"&&(H=H.includes("?")||H.includes("#")?H=x(H):{path:H},H.params={}),Ie({query:A.query,hash:A.hash,params:"path"in H?{}:A.params},H)}}function pe(A,q){const F=l=R(A),H=c.value,ye=A.state,p=A.force,m=A.replace===!0,_=J(F);if(_)return pe(Ie(x(_),{state:typeof _=="object"?Ie({},ye,_.state):ye,force:p,replace:m}),q||F);const w=F;w.redirectedFrom=q;let b;return!p&&zD(r,H,F)&&(b=Zi(16,{to:w,from:H}),rn(H,H,!0,!1)),(b?Promise.resolve(b):me(w,H)).catch(C=>In(C)?In(C,2)?C:On(C):_e(C,w,H)).then(C=>{if(C){if(In(C,2))return pe(Ie({replace:m},x(C.to),{state:typeof C.to=="object"?Ie({},ye,C.to.state):ye,force:p}),q||w)}else C=z(w,H,!0,m,ye);return Ye(w,H,C),C})}function Z(A,q){const F=O(A,q);return F?Promise.reject(F):Promise.resolve()}function Ae(A){const q=di.values().next().value;return q&&typeof q.runWithContext=="function"?q.runWithContext(A):A()}function me(A,q){let F;const[H,ye,p]=jx(A,q);F=Ul(H.reverse(),"beforeRouteLeave",A,q);for(const _ of H)_.leaveGuards.forEach(w=>{F.push(Gn(w,A,q))});const m=Z.bind(null,A,q);return F.push(m),dt(F).then(()=>{F=[];for(const _ of s.list())F.push(Gn(_,A,q));return F.push(m),dt(F)}).then(()=>{F=Ul(ye,"beforeRouteUpdate",A,q);for(const _ of ye)_.updateGuards.forEach(w=>{F.push(Gn(w,A,q))});return F.push(m),dt(F)}).then(()=>{F=[];for(const _ of p)if(_.beforeEnter)if(tn(_.beforeEnter))for(const w of _.beforeEnter)F.push(Gn(w,A,q));else F.push(Gn(_.beforeEnter,A,q));return F.push(m),dt(F)}).then(()=>(A.matched.forEach(_=>_.enterCallbacks={}),F=Ul(p,"beforeRouteEnter",A,q),F.push(m),dt(F))).then(()=>{F=[];for(const _ of o.list())F.push(Gn(_,A,q));return F.push(m),dt(F)}).catch(_=>In(_,8)?_:Promise.reject(_))}function Ye(A,q,F){a.list().forEach(H=>Ae(()=>H(A,q,F)))}function z(A,q,F,H,ye){const p=O(A,q);if(p)return p;const m=q===$n,_=wi?history.state:{};F&&(H||m?i.replace(A.fullPath,Ie({scroll:m&&_&&_.scroll},ye)):i.push(A.fullPath,ye)),c.value=A,rn(A,q,F,m),On()}let ve;function It(){ve||(ve=i.listen((A,q,F)=>{if(!Xo.listening)return;const H=R(A),ye=J(H);if(ye){pe(Ie(ye,{replace:!0}),H).catch(qs);return}l=H;const p=c.value;wi&&ex(Pm(p.fullPath,F.delta),ul()),me(H,p).catch(m=>In(m,12)?m:In(m,2)?(pe(m.to,H).then(_=>{In(_,20)&&!F.delta&&F.type===To.pop&&i.go(-1,!1)}).catch(qs),Promise.reject()):(F.delta&&i.go(-F.delta,!1),_e(m,H,p))).then(m=>{m=m||z(H,p,!1),m&&(F.delta&&!In(m,8)?i.go(-F.delta,!1):F.type===To.pop&&In(m,20)&&i.go(-1,!1)),Ye(H,p,m)}).catch(qs)}))}let yn=bs(),Ue=bs(),be;function _e(A,q,F){On(A);const H=Ue.list();return H.length?H.forEach(ye=>ye(A,q,F)):console.error(A),Promise.reject(A)}function vn(){return be&&c.value!==$n?Promise.resolve():new Promise((A,q)=>{yn.add([A,q])})}function On(A){return be||(be=!A,It(),yn.list().forEach(([q,F])=>A?F(A):q()),yn.reset()),A}function rn(A,q,F,H){const{scrollBehavior:ye}=t;if(!wi||!ye)return Promise.resolve();const p=!F&&tx(Pm(A.fullPath,0))||(H||!F)&&history.state&&history.state.scroll||null;return fg().then(()=>ye(A,q,p)).then(m=>m&&ZD(m)).catch(m=>_e(m,A,q))}const Rt=A=>i.go(A);let hi;const di=new Set,Xo={currentRoute:c,listening:!0,addRoute:f,removeRoute:v,hasRoute:T,getRoutes:I,resolve:R,options:t,push:V,replace:W,go:Rt,back:()=>Rt(-1),forward:()=>Rt(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:Ue.add,isReady:vn,install(A){const q=this;A.component("RouterLink",Lx),A.component("RouterView",qx),A.config.globalProperties.$router=q,Object.defineProperty(A.config.globalProperties,"$route",{enumerable:!0,get:()=>Ci(c)}),wi&&!hi&&c.value===$n&&(hi=!0,V(i.location).catch(ye=>{}));const F={};for(const ye in $n)Object.defineProperty(F,ye,{get:()=>c.value[ye],enumerable:!0});A.provide(Zd,q),A.provide(WI,ig(F)),A.provide(Wu,c);const H=A.unmount;di.add(A),A.unmount=function(){di.delete(A),di.size<1&&(l=$n,ve&&ve(),ve=null,c.value=$n,hi=!1,be=!1),H()}}};function dt(A){return A.reduce((q,F)=>q.then(()=>Ae(F)),Promise.resolve())}return Xo}function jx(t,e){const n=[],r=[],i=[],s=Math.max(e.matched.length,t.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(t.matched.find(l=>Ji(l,a))?r.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(l=>Ji(l,c))||i.push(c))}return[n,r,i]}const Kx="/assets/icon-arrow-right-f36d1adf.svg";const zx={name:"app-invoice",props:["invoice"]},Hx=t=>(So("data-v-d79f832c"),t=t(),Ro(),t),Wx={class:"left flex"},Qx={class:"tracking-number"},Yx={class:"due-date"},Xx={class:"person"},Jx={class:"right flex"},Zx={class:"price"},eV={key:0},tV={key:1},nV={key:2},rV=Hx(()=>g("div",{class:"icon"},[g("img",{src:Kx,alt:""})],-1));function iV(t,e,n,r,i,s){const o=zn("router-link");return ae(),ge("div",null,[Je(o,{class:"invoice flex",to:{name:"invoice",params:{invoiceId:n.invoice.invoiceId}}},{default:yc(()=>[g("div",Wx,[g("span",Qx,"#"+Pe(n.invoice.invoiceId),1),g("span",Yx,"#"+Pe(n.invoice.paymentDueDate),1),g("span",Xx,"#"+Pe(n.invoice.clientName),1)]),g("div",Jx,[g("span",Zx,"$"+Pe(n.invoice.invoiceTotal),1),g("div",{class:Ao(["status-button flex",{paid:n.invoice.invoicePaid,draft:n.invoice.invoiceDraft,pending:n.invoice.invoicePending}])},[n.invoice.invoicePaid?(ae(),ge("span",eV,"Paid")):mt("",!0),n.invoice.invoiceDraft?(ae(),ge("span",tV,"Draft")):mt("",!0),n.invoice.invoicePending?(ae(),ge("span",nV,"Pending")):mt("",!0)],2),rV])]),_:1},8,["to"])])}const sV=dr(zx,[["render",iV],["__scopeId","data-v-d79f832c"]]),oV="/assets/icon-arrow-down-de87442e.svg",aV="/assets/illustration-empty-d4dc35f2.svg";const cV={name:"app-Home",data(){return{filterMenu:null,filterInvoice:null}},components:{invoice:sV},methods:{...bc(["TOGGLE_INVOICE"]),newInvoice(){this.TOGGLE_INVOICE()},toggleFilterMenu(){console.log(this.filterMenu),this.filterMenu=!this.filterMenu},filterredInvoices(t){if(t.target.innerText==="Clear Filter"){this.filterInvoice=null;return}this.filterInvoice=t.target.innerText}},computed:{...Po(["invoiceData"]),filteredData(){return this.invoiceData.filter(t=>this.filterInvoice==="Draft"?t.invoiceDraft===!0:this.filterInvoice==="Pending"?t.invoicePending===!0:this.filterInvoice==="Paid"?t.invoicePaid===!0:t)}}},ui=t=>(So("data-v-afb0566c"),t=t(),Ro(),t),lV={class:"home container"},uV={class:"header flex"},hV={class:"left flex flex-column"},dV=ui(()=>g("h1",null,"Invoices",-1)),fV={class:"right flex"},pV={key:0},mV=ui(()=>g("img",{src:oV,alt:""},null,-1)),gV={class:"filter-menu"},_V=ui(()=>g("div",{class:"inner-button flex"},[g("img",{src:FI,alt:""})],-1)),yV=ui(()=>g("span",null,"New Invoice",-1)),vV=[_V,yV],IV={key:0},EV={key:1,class:"empty flex flex-column"},TV=ui(()=>g("img",{src:aV,alt:""},null,-1)),wV=ui(()=>g("h3",null,"There is nothing here",-1)),AV=ui(()=>g("p",null,"Create a new invoice by clicking the New Invoice button and get started",-1)),bV=[TV,wV,AV];function SV(t,e,n,r,i,s){const o=zn("invoice");return ae(),ge("div",lV,[g("div",uV,[g("div",hV,[dV,g("span",null,"There are "+Pe(s.filteredData.length)+" total invoices ",1)]),g("div",fV,[g("div",{onClick:e[4]||(e[4]=(...a)=>s.toggleFilterMenu&&s.toggleFilterMenu(...a)),class:"filter flex"},[g("span",null,[Ys("Filter by Status "),i.filterInvoice?(ae(),ge("span",pV,": "+Pe(i.filterInvoice),1)):mt("",!0)]),mV,Xe(g("ul",gV,[g("li",{onClick:e[0]||(e[0]=(...a)=>s.filterredInvoices&&s.filterredInvoices(...a))},"Draft"),g("li",{onClick:e[1]||(e[1]=(...a)=>s.filterredInvoices&&s.filterredInvoices(...a))},"Pending"),g("li",{onClick:e[2]||(e[2]=(...a)=>s.filterredInvoices&&s.filterredInvoices(...a))},"Paid"),g("li",{onClick:e[3]||(e[3]=(...a)=>s.filterredInvoices&&s.filterredInvoices(...a))},"Clear Filter")],512),[[qg,i.filterMenu]])]),g("div",{onClick:e[5]||(e[5]=(...a)=>s.newInvoice&&s.newInvoice(...a)),class:"button flex"},vV)])]),t.invoiceData.length>0?(ae(),ge("div",IV,[(ae(!0),ge(Ft,null,lh(s.filteredData,(a,c)=>(ae(),ka(o,{invoice:a,key:c},null,8,["invoice"]))),128))])):(ae(),ge("div",EV,bV))])}const RV=dr(cV,[["render",SV],["__scopeId","data-v-afb0566c"]]),PV="/assets/icon-arrow-left-ce5a96e9.svg";const CV={name:"invoiceView",data(){return{currentInvoice:null}},created(){this.getCurrentInvoice()},methods:{...bc(["SET_CURRENT_INVOICE","TOGGLE_EDIT_INVOICE","TOGGLE_INVOICE"]),...vh(["DELETE_INVOICE","UPDATE_STATUS_TO_PENDING","UPDATE_STATUS_TO_PAID"]),getCurrentInvoice(){this.SET_CURRENT_INVOICE(this.$route.params.invoiceId),this.currentInvoice=this.currentInvoiceArray[0]},toggleEditInvoice(){this.TOGGLE_EDIT_INVOICE(),this.TOGGLE_INVOICE()},async deleteInvoice(t){await this.DELETE_INVOICE(t),this.$router.push({name:"Home"})},updateStatusToPaid(t){this.UPDATE_STATUS_TO_PAID(t)},updateStatusToPending(t){this.UPDATE_STATUS_TO_PENDING(t)}},computed:{...Po(["currentInvoiceArray","editInvoice"])},watch:{editInvoice(){this.editInvoice||(this.currentInvoice=this.currentInvoiceArray[0])}}},Nn=t=>(So("data-v-dc134c90"),t=t(),Ro(),t),DV={key:0,class:"invoice-view container"},xV=Nn(()=>g("img",{src:PV,alt:""},null,-1)),VV={class:"header flex"},NV={class:"left flex"},OV=Nn(()=>g("span",null,"Status",-1)),kV={key:0},MV={key:1},FV={key:2},LV={class:"right flex"},BV={class:"invoice-details flex flex-column"},UV={class:"top flex"},$V={class:"left flex flex-column"},qV=Nn(()=>g("span",null,"#",-1)),GV={class:"right flex flex-column"},jV={class:"middle flex"},KV={class:"payment flex flex-column"},zV=Nn(()=>g("h4",null,"Invoice Date",-1)),HV=Nn(()=>g("h4",null,"Payment Date",-1)),WV={class:"bill flex flex-column"},QV=Nn(()=>g("h4",null,"Bill To",-1)),YV={class:"send-to flex flex-column"},XV=Nn(()=>g("h4",null,"Sent To",-1)),JV={class:"bottom flex flex-column"},ZV={class:"billing-items"},eN=Nn(()=>g("div",{class:"heading flex"},[g("p",null,"Item Name"),g("p",null,"QTY"),g("p",null,"Price"),g("p",null,"Total")],-1)),tN={class:"total flex"},nN=Nn(()=>g("p",null,"Amount Due",-1));function rN(t,e,n,r,i,s){const o=zn("router-link");return i.currentInvoice?(ae(),ge("div",DV,[Je(o,{class:"nav-link flex",to:{name:"Home"}},{default:yc(()=>[xV,Ys(" Go Back ")]),_:1}),g("div",VV,[g("div",NV,[OV,g("div",{class:Ao(["status-button flex",{paid:i.currentInvoice.invoicePaid,draft:i.currentInvoice.invoiceDraft,pending:i.currentInvoice.invoicePending}])},[i.currentInvoice.invoicePaid?(ae(),ge("span",kV,"Paid")):mt("",!0),i.currentInvoice.invoiceDraft?(ae(),ge("span",MV,"Draft")):mt("",!0),i.currentInvoice.invoicePending?(ae(),ge("span",FV,"Pending")):mt("",!0)],2)]),g("div",LV,[g("button",{onClick:e[0]||(e[0]=(...a)=>s.toggleEditInvoice&&s.toggleEditInvoice(...a)),class:"dark-purple"},"Edit"),g("button",{onClick:e[1]||(e[1]=a=>s.deleteInvoice(i.currentInvoice.docId)),class:"red"},"Delete"),i.currentInvoice.invoicePending?(ae(),ge("button",{key:0,onClick:e[2]||(e[2]=a=>s.updateStatusToPaid(i.currentInvoice.docId)),class:"green"}," Mark as Paid ")):mt("",!0),i.currentInvoice.invoiceDraft||i.currentInvoice.invoicePaid?(ae(),ge("button",{key:1,onClick:e[3]||(e[3]=a=>s.updateStatusToPending(i.currentInvoice.docId)),class:"orange"}," Mark as Pending ")):mt("",!0)])]),g("div",BV,[g("div",UV,[g("div",$V,[g("p",null,[qV,Ys(Pe(i.currentInvoice.invoiceId),1)]),g("p",null,Pe(i.currentInvoice.productDescription),1)]),g("div",GV,[g("p",null,Pe(i.currentInvoice.billerStreetAddress),1),g("p",null,Pe(i.currentInvoice.billerCity),1),g("p",null,Pe(i.currentInvoice.billerZipCode),1),g("p",null,Pe(i.currentInvoice.billerCountry),1)])]),g("div",jV,[g("div",KV,[zV,g("p",null,Pe(i.currentInvoice.invoiceDate),1),HV,g("p",null,Pe(i.currentInvoice.paymentDueDate),1)]),g("div",WV,[QV,g("p",null,Pe(i.currentInvoice.clientName),1),g("p",null,Pe(i.currentInvoice.clientStreetAddress),1),g("p",null,Pe(i.currentInvoice.clientCity),1),g("p",null,Pe(i.currentInvoice.clientZipCode),1),g("p",null,Pe(i.currentInvoice.clientCountry),1)]),g("div",YV,[XV,g("p",null,Pe(i.currentInvoice.clientEmail),1)])]),g("div",JV,[g("div",ZV,[eN,(ae(!0),ge(Ft,null,lh(i.currentInvoice.invoiceItemList,(a,c)=>(ae(),ge("div",{key:c,class:"item flex"},[g("p",null,Pe(a.itemName),1),g("p",null,Pe(a.qty),1),g("p",null,Pe(a.price),1),g("p",null,Pe(a.total),1)]))),128))]),g("div",tN,[nN,g("p",null,Pe(i.currentInvoice.invoiceTotal),1)])])])])):mt("",!0)}const iN=dr(CV,[["render",rN],["__scopeId","data-v-dc134c90"]]),sN=[{path:"/",name:"Home",component:RV},{path:"/invoice/:invoiceId",name:"invoice",component:iN}],oN=Gx({history:sx(),routes:sN}),aN=Zw({state:{invoiceData:[],invoiceModal:!1,modalActive:null,invoicesLoaded:null,currentInvoiceArray:null,editInvoice:null},mutations:{TOGGLE_INVOICE(t){t.invoiceModal=!t.invoiceModal},TOGGLE_MODAL(t){t.modalActive=!t.modalActive},SET_INVOICE_DATA(t,e){t.invoiceData.push(e)},INVOICES_LOADED(t){t.invoicesLoaded=!0},SET_CURRENT_INVOICE(t,e){t.currentInvoiceArray=t.invoiceData.filter(n=>n.invoiceId===e)},TOGGLE_EDIT_INVOICE(t){t.editInvoice=!t.editInvoice},DELETE_INVOICE(t,e){t.invoiceData=t.invoiceData.filter(n=>n.docId!==e)},UPDATE_STATUS_TO_PAID(t,e){t.invoiceData.forEach(n=>{n.docId===e&&(n.invoicePaid=!0,n.invoicePending=!1)})},UPDATE_STATUS_TO_PENDING(t,e){t.invoiceData.forEach(n=>{n.docId===e&&(n.invoicePaid=!1,n.invoicePending=!0,n.invoiceDraft=!1)})}},actions:{async GET_INVOICES({commit:t,state:e}){(await bi.collection("invoices").get()).forEach(i=>{if(!e.invoiceData.some(s=>s.docID===i.id)){const s={docId:i.id,invoiceId:i.data().invoiceId,billerStreetAddress:i.data().billerStreetAddress,billerCity:i.data().billerCity,billerZipCode:i.data().billerZipCode,billerCountry:i.data().billerCountry,clientName:i.data().clientName,clientEmail:i.data().clientEmail,clientStreetAddress:i.data().clientStreetAddress,clientCity:i.data().clientCity,clientZipCode:i.data().clientZipCode,clientCountry:i.data().clientCountry,invoiceDateUnix:i.data().invoiceDateUnix,invoiceDate:i.data().invoiceDate,paymentTerms:i.data().paymentTerms,paymentDueDateUnix:i.data().paymentDueDateUnix,paymentDueDate:i.data().paymentDueDate,productDescription:i.data().productDescription,invoiceItemList:i.data().invoiceItemList,invoiceTotal:i.data().invoiceTotal,invoicePending:i.data().invoicePending,invoiceDraft:i.data().invoiceDraft,invoicePaid:i.data().invoicePaid};t("SET_INVOICE_DATA",s)}}),t("INVOICES_LOADED")},async UPDATE_INVOICE({commit:t,dispatch:e},{docId:n,routeId:r}){t("DELET_INVOICE",n),await e("GET_INVOICES"),t("TOGGLE_INVOICE"),t("TOGGLE_EDIT_INVOICE"),t("SET_CURRENT_INVOICE",r)},async DELETE_INVOICE({commit:t},e){await bi.collection("invoices").doc(e).delete(),t("DELETE_INVOICE",e)},async UPDATE_STATUS_TO_PAID({commit:t},e){await bi.collection("invoices").doc(e).update({invoicePaid:!0,invoicePending:!1}),t("UPDATE_STATUS_TO_PAID",e)},async UPDATE_STATUS_TO_PENDING({commit:t},e){await bi.collection("invoices").doc(e).update({invoicePaid:!1,invoicePending:!0,invoiceDraft:!1}),t("UPDATE_STATUS_TO_PENDING",e)}},modules:{}});Rw($D).use(aN).use(oN).mount("#app");
